[0m20:20:01.013669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2053CA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2053C050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2053DBD0>]}


============================== 20:20:01.023033 | 7b022635-0928-40c5-85bd-a4fcf28a33f4 ==============================
[0m20:20:01.023033 [info ] [MainThread]: Running with dbt=1.7.16
[0m20:20:01.025296 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:20:01.035047 [info ] [MainThread]: dbt version: 1.7.16
[0m20:20:01.037212 [info ] [MainThread]: python version: 3.11.2
[0m20:20:01.038228 [info ] [MainThread]: python path: C:\Drive\dbt_venv\Scripts\python.exe
[0m20:20:01.039215 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m20:20:01.485254 [info ] [MainThread]: Using profiles dir at C:\Users\GB617GQ\.dbt
[0m20:20:01.487676 [info ] [MainThread]: Using profiles.yml file at C:\Users\GB617GQ\.dbt\profiles.yml
[0m20:20:01.488361 [info ] [MainThread]: Using dbt_project.yml file at C:\Drive\AmazonSalesAnalytics\dbt_project.yml
[0m20:20:01.490373 [info ] [MainThread]: adapter type: sqlserver
[0m20:20:01.491373 [info ] [MainThread]: adapter version: 1.7.4
[0m20:20:01.553931 [info ] [MainThread]: Configuration:
[0m20:20:01.555843 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:20:01.556815 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:20:01.558904 [info ] [MainThread]: Required dependencies:
[0m20:20:01.561560 [debug] [MainThread]: Executing "git --help"
[0m20:20:02.370649 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:20:02.371654 [debug] [MainThread]: STDERR: "b''"
[0m20:20:02.372648 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:20:02.374826 [info ] [MainThread]: Connection:
[0m20:20:02.376853 [info ] [MainThread]:   server: analytics-warehouse.database.windows.net
[0m20:20:02.377854 [info ] [MainThread]:   database: analytics-raw
[0m20:20:02.380345 [info ] [MainThread]:   schema: dbo
[0m20:20:02.381843 [info ] [MainThread]:   UID: sqladmin
[0m20:20:02.382863 [info ] [MainThread]:   client_id: None
[0m20:20:02.384649 [info ] [MainThread]:   authentication: sql
[0m20:20:02.386652 [info ] [MainThread]:   encrypt: True
[0m20:20:02.388684 [info ] [MainThread]:   trust_cert: False
[0m20:20:02.390987 [info ] [MainThread]:   retries: 1
[0m20:20:02.392332 [info ] [MainThread]:   login_timeout: 0
[0m20:20:02.393853 [info ] [MainThread]:   query_timeout: 0
[0m20:20:02.395011 [info ] [MainThread]:   port: 1433
[0m20:20:02.396389 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m20:20:02.398207 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m20:20:02.399422 [debug] [MainThread]: Using sqlserver connection "debug"
[0m20:20:02.400790 [debug] [MainThread]: On debug: select 1 as id
[0m20:20:02.401788 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:20:02.402787 [debug] [MainThread]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=analytics-raw;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m20:20:04.618027 [debug] [MainThread]: SQLServer adapter: Connected to db: analytics-raw
[0m20:20:04.840505 [debug] [MainThread]: SQL status: OK in 2.0 seconds
[0m20:20:04.842712 [debug] [MainThread]: On debug: Close
[0m20:20:04.843815 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:20:04.845813 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:20:04.851839 [debug] [MainThread]: Command `dbt debug` succeeded at 20:20:04.851839 after 4.44 seconds
[0m20:20:04.852814 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:20:04.853829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C1FFB0810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C1FFB0750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C1EE69710>]}
[0m20:20:04.854825 [debug] [MainThread]: Flushing usage events
[0m20:20:05.037184 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m22:43:17.774633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F3C08F8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F3AC726D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F3AC72E50>]}


============================== 22:43:17.784717 | 35bf054b-9a6f-482d-9d95-3e71b6d719c3 ==============================
[0m22:43:17.784717 [info ] [MainThread]: Running with dbt=1.7.16
[0m22:43:17.786632 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models dim_product', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:43:18.388813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35bf054b-9a6f-482d-9d95-3e71b6d719c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F3C61A910>]}
[0m22:43:18.430377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35bf054b-9a6f-482d-9d95-3e71b6d719c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F3C62C110>]}
[0m22:43:18.432547 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m22:43:18.450241 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m22:43:18.454253 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:43:18.455255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '35bf054b-9a6f-482d-9d95-3e71b6d719c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F3C6BEA10>]}
[0m22:43:19.691959 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.AmazonSalesAnalytics.dim_product
[0m22:43:19.699868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35bf054b-9a6f-482d-9d95-3e71b6d719c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F3D901890>]}
[0m22:43:19.740039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35bf054b-9a6f-482d-9d95-3e71b6d719c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F3DAA4990>]}
[0m22:43:19.741049 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m22:43:19.742027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35bf054b-9a6f-482d-9d95-3e71b6d719c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F3D8804D0>]}
[0m22:43:19.744539 [info ] [MainThread]: 
[0m22:43:19.745556 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m22:43:19.748399 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_analytics-raw'
[0m22:43:19.759623 [debug] [ThreadPool]: Using sqlserver connection "list_analytics-raw"
[0m22:43:19.761609 [debug] [ThreadPool]: On list_analytics-raw: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "connection_name": "list_analytics-raw"} */
select  name as [schema]
    from sys.schemas 
  
[0m22:43:19.762632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:19.763610 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=analytics-raw;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m22:43:22.152971 [debug] [ThreadPool]: SQLServer adapter: Connected to db: analytics-raw
[0m22:43:22.385388 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m22:43:22.386515 [debug] [ThreadPool]: On list_analytics-raw: Close
[0m22:43:22.389515 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_analytics-raw_dbo'
[0m22:43:22.394516 [debug] [ThreadPool]: Using sqlserver connection "list_analytics-raw_dbo"
[0m22:43:22.396938 [debug] [ThreadPool]: On list_analytics-raw_dbo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "connection_name": "list_analytics-raw_dbo"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbo'
  
[0m22:43:22.398200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:22.399212 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=analytics-raw;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m22:43:22.401210 [debug] [ThreadPool]: SQLServer adapter: Connected to db: analytics-raw
[0m22:43:22.644251 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:43:22.646562 [debug] [ThreadPool]: On list_analytics-raw_dbo: ROLLBACK
[0m22:43:22.648570 [debug] [ThreadPool]: On list_analytics-raw_dbo: Close
[0m22:43:22.650570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35bf054b-9a6f-482d-9d95-3e71b6d719c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F3D8C5CD0>]}
[0m22:43:22.651581 [debug] [MainThread]: On master: COMMIT
[0m22:43:22.652569 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:43:22.654571 [info ] [MainThread]: 
[0m22:43:22.681218 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.dim_product
[0m22:43:22.683227 [info ] [Thread-1 (]: 1 of 1 START sql table model dbo.dim_product ................................... [RUN]
[0m22:43:22.684218 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.dim_product'
[0m22:43:22.685229 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.dim_product
[0m22:43:22.691887 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.dim_product"
[0m22:43:22.711112 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (compile): 22:43:22.687219 => 22:43:22.710113
[0m22:43:22.713320 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.dim_product
[0m22:43:22.735801 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m22:43:22.737844 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      
      
    USE [analytics-raw];
    EXEC('DROP table IF EXISTS "dbo"."dim_product__dbt_backup";');

[0m22:43:22.739833 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:43:22.740840 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=analytics-raw;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m22:43:22.741832 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: analytics-raw
[0m22:43:22.981937 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:43:22.985207 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m22:43:22.986243 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "node_id": "model.AmazonSalesAnalytics.dim_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbo'
    and table_name like 'dim_product'
  
[0m22:43:23.228837 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:43:23.245515 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m22:43:23.246527 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      USE [analytics-raw];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'analytics-raw'
      and refs.referenced_schema_name = 'dbo'
      and refs.referenced_entity_name = 'dim_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m22:43:23.546232 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:43:23.551252 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m22:43:23.552257 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

    
      
      
    
    USE [analytics-raw];
    EXEC('DROP view IF EXISTS "dbo"."dim_product_temp_view";');

  
[0m22:43:23.795818 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:43:23.801415 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m22:43:23.802373 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      USE [analytics-raw];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'analytics-raw'
      and refs.referenced_schema_name = 'dbo'
      and refs.referenced_entity_name = 'dim_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m22:43:24.034751 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:43:24.036755 [debug] [Thread-1 (]: Writing runtime sql for node "model.AmazonSalesAnalytics.dim_product"
[0m22:43:24.054013 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m22:43:24.055980 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

  
    

   

    USE [analytics-raw];
    
    

    EXEC('create view "dbo"."dim_product_temp_view" as with cte_product as (SELECT
    distinct 
    Category,
    SIZE,
    SKU,
    Style,
    ASIN
from dbo.raw_data)

select Category,
        SIZE,
        SKU,
        Style,
        ASIN
    from cte_product;');



    
      EXEC('SELECT * INTO [analytics-raw].[dbo].[dim_product] FROM [analytics-raw].[dbo].[dim_product_temp_view];');
    

    
      
      
    
    USE [analytics-raw];
    EXEC('DROP view IF EXISTS "dbo"."dim_product_temp_view";');



  
[0m22:43:46.038834 [debug] [Thread-1 (]: SQL status: OK in 22.0 seconds
[0m22:43:46.054891 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: COMMIT
[0m22:43:46.058924 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m22:43:46.059907 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      USE [analytics-raw];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbo' and tab2.name = 'dim_product__dbt_backup'
  
[0m22:43:47.428202 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m22:43:47.433170 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m22:43:47.434193 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      
      
    USE [analytics-raw];
    EXEC('DROP table IF EXISTS "dbo"."dim_product__dbt_backup";');

[0m22:43:47.666140 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:43:47.671130 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (execute): 22:43:22.715191 => 22:43:47.671130
[0m22:43:47.672129 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: ROLLBACK
[0m22:43:47.673129 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: Close
[0m22:43:47.675057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35bf054b-9a6f-482d-9d95-3e71b6d719c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F3D87F350>]}
[0m22:43:47.677028 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbo.dim_product .............................. [[32mOK[0m in 24.99s]
[0m22:43:47.678718 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.dim_product
[0m22:43:47.681109 [debug] [MainThread]: On master: COMMIT
[0m22:43:47.682109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:43:47.684108 [debug] [MainThread]: Connection 'list_analytics-raw' was properly closed.
[0m22:43:47.685535 [debug] [MainThread]: Connection 'list_analytics-raw_dbo' was properly closed.
[0m22:43:47.687128 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.dim_product' was properly closed.
[0m22:43:47.688696 [info ] [MainThread]: 
[0m22:43:47.690075 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 27.94 seconds (27.94s).
[0m22:43:47.691598 [debug] [MainThread]: Command end result
[0m22:43:47.716084 [info ] [MainThread]: 
[0m22:43:47.718175 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:43:47.720698 [info ] [MainThread]: 
[0m22:43:47.722389 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:43:47.747483 [debug] [MainThread]: Command `dbt run` succeeded at 22:43:47.747483 after 30.61 seconds
[0m22:43:47.749484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F3C08E190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F35518A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F3C645150>]}
[0m22:43:47.750483 [debug] [MainThread]: Flushing usage events
[0m22:43:48.678465 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m22:48:05.739629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183C1069A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183C10C1A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183C0CB14D0>]}


============================== 22:48:05.750628 | 313c9055-b08f-4b21-b0ca-6592b20448a2 ==============================
[0m22:48:05.750628 [info ] [MainThread]: Running with dbt=1.7.16
[0m22:48:05.752625 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m22:48:05.754051 [info ] [MainThread]: dbt version: 1.7.16
[0m22:48:05.756064 [info ] [MainThread]: python version: 3.11.2
[0m22:48:05.757952 [info ] [MainThread]: python path: C:\Drive\dbt_venv\Scripts\python.exe
[0m22:48:05.759923 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m22:48:06.213560 [info ] [MainThread]: Using profiles dir at C:\Users\GB617GQ\.dbt
[0m22:48:06.215505 [info ] [MainThread]: Using profiles.yml file at C:\Users\GB617GQ\.dbt\profiles.yml
[0m22:48:06.217471 [info ] [MainThread]: Using dbt_project.yml file at C:\Drive\AmazonSalesAnalytics\dbt_project.yml
[0m22:48:06.218470 [info ] [MainThread]: adapter type: sqlserver
[0m22:48:06.220471 [info ] [MainThread]: adapter version: 1.7.4
[0m22:48:06.286494 [info ] [MainThread]: Configuration:
[0m22:48:06.287414 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:48:06.289607 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:48:06.290710 [info ] [MainThread]: Required dependencies:
[0m22:48:06.292573 [debug] [MainThread]: Executing "git --help"
[0m22:48:07.106026 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:48:07.108071 [debug] [MainThread]: STDERR: "b''"
[0m22:48:07.109042 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:48:07.111429 [info ] [MainThread]: Connection:
[0m22:48:07.113426 [info ] [MainThread]:   server: analytics-warehouse.database.windows.net
[0m22:48:07.114440 [info ] [MainThread]:   database: analytics-raw
[0m22:48:07.116911 [info ] [MainThread]:   schema: dbo
[0m22:48:07.118523 [info ] [MainThread]:   UID: sqladmin
[0m22:48:07.119511 [info ] [MainThread]:   client_id: None
[0m22:48:07.121543 [info ] [MainThread]:   authentication: sql
[0m22:48:07.123514 [info ] [MainThread]:   encrypt: True
[0m22:48:07.125973 [info ] [MainThread]:   trust_cert: False
[0m22:48:07.128199 [info ] [MainThread]:   retries: 1
[0m22:48:07.131465 [info ] [MainThread]:   login_timeout: 0
[0m22:48:07.133133 [info ] [MainThread]:   query_timeout: 0
[0m22:48:07.136352 [info ] [MainThread]:   port: 1433
[0m22:48:07.138370 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m22:48:07.139585 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m22:48:07.141587 [debug] [MainThread]: Using sqlserver connection "debug"
[0m22:48:07.143288 [debug] [MainThread]: On debug: select 1 as id
[0m22:48:07.144037 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:48:07.146374 [debug] [MainThread]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=analytics-raw;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m22:48:09.474633 [debug] [MainThread]: SQLServer adapter: Connected to db: analytics-raw
[0m22:48:09.705265 [debug] [MainThread]: SQL status: OK in 3.0 seconds
[0m22:48:09.706489 [debug] [MainThread]: On debug: Close
[0m22:48:09.708292 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:48:09.710342 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:48:09.715159 [debug] [MainThread]: Command `dbt debug` succeeded at 22:48:09.715159 after 4.64 seconds
[0m22:48:09.716159 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:48:09.717152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183BA5BA7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183BE59EB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183BA429510>]}
[0m22:48:09.718158 [debug] [MainThread]: Flushing usage events
[0m22:48:10.623014 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m22:50:06.010221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9969ED50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9967E550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9967F010>]}


============================== 22:50:06.019796 | 6e5b3cf2-c16e-4b49-aed8-05c436478fcc ==============================
[0m22:50:06.019796 [info ] [MainThread]: Running with dbt=1.7.16
[0m22:50:06.022706 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --target target', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:50:06.598098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e5b3cf2-c16e-4b49-aed8-05c436478fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA99C2D5D0>]}
[0m22:50:06.641716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e5b3cf2-c16e-4b49-aed8-05c436478fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9969F190>]}
[0m22:50:06.643252 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m22:50:06.664193 [debug] [MainThread]: checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, vars: {}, profile: , target: target, version: 1.7.16
[0m22:50:06.673912 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m22:50:06.676384 [debug] [MainThread]: previous checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, current checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf
[0m22:50:06.678659 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:50:06.680392 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:50:06.681944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6e5b3cf2-c16e-4b49-aed8-05c436478fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA99BF5390>]}
[0m22:50:07.785368 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.AmazonSalesAnalytics.target
[0m22:50:07.792320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e5b3cf2-c16e-4b49-aed8-05c436478fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9AFFC610>]}
[0m22:50:07.821126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e5b3cf2-c16e-4b49-aed8-05c436478fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9B02B990>]}
[0m22:50:07.823314 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m22:50:07.825754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e5b3cf2-c16e-4b49-aed8-05c436478fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA99CDDE50>]}
[0m22:50:07.830790 [info ] [MainThread]: 
[0m22:50:07.832913 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m22:50:07.835913 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics'
[0m22:50:07.848518 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics"
[0m22:50:07.849977 [debug] [ThreadPool]: On list_amazonsalesanalytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics"} */
select  name as [schema]
    from sys.schemas 
  
[0m22:50:07.849977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:50:07.851282 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m22:50:10.139840 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m22:50:10.370916 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m22:50:10.373049 [debug] [ThreadPool]: On list_amazonsalesanalytics: Close
[0m22:50:10.375931 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics_dbo'
[0m22:50:10.380934 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics_dbo"
[0m22:50:10.382015 [debug] [ThreadPool]: On list_amazonsalesanalytics_dbo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics_dbo"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbo'
  
[0m22:50:10.382934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:50:10.383941 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m22:50:10.384938 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m22:50:10.620611 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:50:10.623494 [debug] [ThreadPool]: On list_amazonsalesanalytics_dbo: ROLLBACK
[0m22:50:10.625529 [debug] [ThreadPool]: On list_amazonsalesanalytics_dbo: Close
[0m22:50:10.627494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e5b3cf2-c16e-4b49-aed8-05c436478fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA99DD4190>]}
[0m22:50:10.627494 [debug] [MainThread]: On master: COMMIT
[0m22:50:10.629492 [info ] [MainThread]: Concurrency: 1 threads (target='target')
[0m22:50:10.630494 [info ] [MainThread]: 
[0m22:50:10.643011 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.dim_product
[0m22:50:10.645114 [info ] [Thread-1 (]: 1 of 3 START sql table model dbo.dim_product ................................... [RUN]
[0m22:50:10.647917 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.dim_product'
[0m22:50:10.648936 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.dim_product
[0m22:50:10.658394 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.dim_product"
[0m22:50:10.667345 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (compile): 22:50:10.649929 => 22:50:10.667345
[0m22:50:10.669345 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.dim_product
[0m22:50:10.692596 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m22:50:10.694603 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dbo"."dim_product__dbt_backup";');

[0m22:50:10.695604 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:50:10.696675 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m22:50:10.697604 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m22:50:10.917955 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:50:10.920911 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m22:50:10.923070 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbo'
    and table_name like 'dim_product'
  
[0m22:50:11.152155 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:50:11.167609 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m22:50:11.168607 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dbo'
      and refs.referenced_entity_name = 'dim_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m22:50:11.713069 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m22:50:11.716070 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m22:50:11.717069 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dbo"."dim_product_temp_view";');

  
[0m22:50:11.939074 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:50:11.944606 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m22:50:11.946601 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dbo'
      and refs.referenced_entity_name = 'dim_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m22:50:12.478364 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m22:50:12.480374 [debug] [Thread-1 (]: Writing runtime sql for node "model.AmazonSalesAnalytics.dim_product"
[0m22:50:12.487367 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m22:50:12.490422 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

  
    

   

    USE [amazonsalesanalytics];
    
    

    EXEC('create view "dbo"."dim_product_temp_view" as with cte_product as (SELECT
    distinct 
    Category,
    SIZE,
    SKU,
    Style,
    ASIN
from dbo.raw_data)

select Category,
        SIZE,
        SKU,
        Style,
        ASIN
    from cte_product;');



    
      EXEC('SELECT * INTO [amazonsalesanalytics].[dbo].[dim_product] FROM [amazonsalesanalytics].[dbo].[dim_product_temp_view];');
    

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dbo"."dim_product_temp_view";');



  
[0m22:50:12.711589 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:50:12.714164 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (execute): 22:50:10.670338 => 22:50:12.713662
[0m22:50:12.715197 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: ROLLBACK
[0m22:50:12.717183 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: Close
[0m22:50:12.718179 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\AmazonSalesAnalytics\models\example\dim_product.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'dbo.raw_data'. (208) (SQLMoreResults)")
[0m22:50:12.734723 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\base.py", line 380, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\base.py", line 326, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\base.py", line 427, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 83, in macro
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
          ^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'dbo.raw_data'. (208) (SQLMoreResults)")

[0m22:50:12.735723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e5b3cf2-c16e-4b49-aed8-05c436478fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9AFA5250>]}
[0m22:50:12.736711 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model dbo.dim_product .......................... [[31mERROR[0m in 2.09s]
[0m22:50:12.739377 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.dim_product
[0m22:50:12.741919 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.my_first_dbt_model
[0m22:50:12.743035 [info ] [Thread-1 (]: 2 of 3 START sql table model dbo.my_first_dbt_model ............................ [RUN]
[0m22:50:12.745028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AmazonSalesAnalytics.dim_product, now model.AmazonSalesAnalytics.my_first_dbt_model)
[0m22:50:12.746043 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.my_first_dbt_model
[0m22:50:12.749027 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.my_first_dbt_model"
[0m22:50:12.753760 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.my_first_dbt_model (compile): 22:50:12.747040 => 22:50:12.753026
[0m22:50:12.756156 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.my_first_dbt_model
[0m22:50:12.762676 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.my_first_dbt_model"
[0m22:50:12.764663 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.my_first_dbt_model"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dbo"."my_first_dbt_model__dbt_backup";');

[0m22:50:12.766663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:50:12.767686 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m22:50:12.769662 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m22:50:12.989174 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:50:12.991518 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.my_first_dbt_model"
[0m22:50:12.992445 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.my_first_dbt_model"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbo'
    and table_name like 'my_first_dbt_model'
  
[0m22:50:13.222836 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:50:13.229920 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.my_first_dbt_model"
[0m22:50:13.232837 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.my_first_dbt_model"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dbo'
      and refs.referenced_entity_name = 'my_first_dbt_model_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m22:50:13.468446 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:50:13.474519 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.my_first_dbt_model"
[0m22:50:13.477435 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.my_first_dbt_model"} */

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dbo"."my_first_dbt_model_temp_view";');

  
[0m22:50:13.697399 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:50:13.699413 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.my_first_dbt_model"
[0m22:50:13.701552 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.my_first_dbt_model"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dbo'
      and refs.referenced_entity_name = 'my_first_dbt_model_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m22:50:13.921968 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:50:13.925069 [debug] [Thread-1 (]: Writing runtime sql for node "model.AmazonSalesAnalytics.my_first_dbt_model"
[0m22:50:13.930332 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.my_first_dbt_model"
[0m22:50:13.932358 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.my_first_dbt_model"} */

  
    

   

    USE [amazonsalesanalytics];
    
    

    EXEC('create view "dbo"."my_first_dbt_model_temp_view" as /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null;');



    
      EXEC('SELECT * INTO [amazonsalesanalytics].[dbo].[my_first_dbt_model] FROM [amazonsalesanalytics].[dbo].[my_first_dbt_model_temp_view];');
    

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dbo"."my_first_dbt_model_temp_view";');



  
[0m22:50:14.214309 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:50:14.231064 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_first_dbt_model: COMMIT
[0m22:50:14.235094 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.my_first_dbt_model"
[0m22:50:14.236091 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.my_first_dbt_model"} */

      USE [amazonsalesanalytics];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbo' and tab2.name = 'my_first_dbt_model__dbt_backup'
  
[0m22:50:15.107461 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m22:50:15.116578 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.my_first_dbt_model"
[0m22:50:15.118043 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.my_first_dbt_model"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dbo"."my_first_dbt_model__dbt_backup";');

[0m22:50:15.337222 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:50:15.343999 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.my_first_dbt_model (execute): 22:50:12.757662 => 22:50:15.343999
[0m22:50:15.345980 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_first_dbt_model: ROLLBACK
[0m22:50:15.346979 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_first_dbt_model: Close
[0m22:50:15.347996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e5b3cf2-c16e-4b49-aed8-05c436478fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9AEB5E10>]}
[0m22:50:15.348980 [info ] [Thread-1 (]: 2 of 3 OK created sql table model dbo.my_first_dbt_model ....................... [[32mOK[0m in 2.60s]
[0m22:50:15.350992 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.my_first_dbt_model
[0m22:50:15.351981 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.my_second_dbt_model
[0m22:50:15.352983 [info ] [Thread-1 (]: 3 of 3 START sql table model dbo.my_second_dbt_model ........................... [RUN]
[0m22:50:15.354582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AmazonSalesAnalytics.my_first_dbt_model, now model.AmazonSalesAnalytics.my_second_dbt_model)
[0m22:50:15.355628 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.my_second_dbt_model
[0m22:50:15.358622 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.my_second_dbt_model"
[0m22:50:15.372248 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.my_second_dbt_model (compile): 22:50:15.356613 => 22:50:15.371747
[0m22:50:15.374279 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.my_second_dbt_model
[0m22:50:15.382814 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.my_second_dbt_model"
[0m22:50:15.384827 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.my_second_dbt_model"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dbo"."my_second_dbt_model__dbt_backup";');

[0m22:50:15.385835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:50:15.386827 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m22:50:15.388828 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m22:50:15.610324 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:50:15.615565 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.my_second_dbt_model"
[0m22:50:15.618015 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.my_second_dbt_model"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbo'
    and table_name like 'my_second_dbt_model'
  
[0m22:50:15.849564 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:50:15.856469 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.my_second_dbt_model"
[0m22:50:15.858473 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.my_second_dbt_model"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dbo'
      and refs.referenced_entity_name = 'my_second_dbt_model_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m22:50:16.095987 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:50:16.101069 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.my_second_dbt_model"
[0m22:50:16.103002 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.my_second_dbt_model"} */

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dbo"."my_second_dbt_model_temp_view";');

  
[0m22:50:16.324311 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:50:16.329477 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.my_second_dbt_model"
[0m22:50:16.330762 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.my_second_dbt_model"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dbo'
      and refs.referenced_entity_name = 'my_second_dbt_model_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m22:50:16.554678 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:50:16.560410 [debug] [Thread-1 (]: Writing runtime sql for node "model.AmazonSalesAnalytics.my_second_dbt_model"
[0m22:50:16.566373 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.my_second_dbt_model"
[0m22:50:16.568379 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.my_second_dbt_model"} */

  
    

   

    USE [amazonsalesanalytics];
    
    

    EXEC('create view "dbo"."my_second_dbt_model_temp_view" as -- Use the `ref` function to select from other models

select *
from "amazonsalesanalytics"."dbo"."my_first_dbt_model"
where id = 1;');



    
      EXEC('SELECT * INTO [amazonsalesanalytics].[dbo].[my_second_dbt_model] FROM [amazonsalesanalytics].[dbo].[my_second_dbt_model_temp_view];');
    

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dbo"."my_second_dbt_model_temp_view";');



  
[0m22:50:16.818693 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:50:16.821255 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_second_dbt_model: COMMIT
[0m22:50:16.822725 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.my_second_dbt_model"
[0m22:50:16.823721 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.my_second_dbt_model"} */

      USE [amazonsalesanalytics];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbo' and tab2.name = 'my_second_dbt_model__dbt_backup'
  
[0m22:50:18.215291 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m22:50:18.218671 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.my_second_dbt_model"
[0m22:50:18.220733 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.my_second_dbt_model"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dbo"."my_second_dbt_model__dbt_backup";');

[0m22:50:18.444573 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:50:18.447661 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.my_second_dbt_model (execute): 22:50:15.376266 => 22:50:18.446576
[0m22:50:18.448575 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_second_dbt_model: ROLLBACK
[0m22:50:18.450100 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_second_dbt_model: Close
[0m22:50:18.451777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e5b3cf2-c16e-4b49-aed8-05c436478fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA99C3EC50>]}
[0m22:50:18.453841 [info ] [Thread-1 (]: 3 of 3 OK created sql table model dbo.my_second_dbt_model ...................... [[32mOK[0m in 3.10s]
[0m22:50:18.455056 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.my_second_dbt_model
[0m22:50:18.458076 [debug] [MainThread]: On master: COMMIT
[0m22:50:18.460093 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:50:18.461078 [debug] [MainThread]: Connection 'list_amazonsalesanalytics' was properly closed.
[0m22:50:18.462079 [debug] [MainThread]: Connection 'list_amazonsalesanalytics_dbo' was properly closed.
[0m22:50:18.463082 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.my_second_dbt_model' was properly closed.
[0m22:50:18.464079 [info ] [MainThread]: 
[0m22:50:18.466248 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 10.63 seconds (10.63s).
[0m22:50:18.467763 [debug] [MainThread]: Command end result
[0m22:50:18.492411 [info ] [MainThread]: 
[0m22:50:18.494817 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:50:18.497226 [info ] [MainThread]: 
[0m22:50:18.498240 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'dbo.raw_data'. (208) (SQLMoreResults)")
[0m22:50:18.500240 [info ] [MainThread]: 
[0m22:50:18.502238 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m22:50:18.526861 [debug] [MainThread]: Command `dbt run` failed at 22:50:18.526861 after 13.15 seconds
[0m22:50:18.529562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA99663290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA983E56D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA92C0AC50>]}
[0m22:50:18.530595 [debug] [MainThread]: Flushing usage events
[0m22:50:19.383840 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m22:57:38.114901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F2FE6A110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F2F954750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F2F954AD0>]}


============================== 22:57:38.125002 | 2db7958b-ab26-4a4c-ab7b-d99a6c8a3eb8 ==============================
[0m22:57:38.125002 [info ] [MainThread]: Running with dbt=1.7.16
[0m22:57:38.127004 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --target target', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:57:38.706909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2db7958b-ab26-4a4c-ab7b-d99a6c8a3eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F3044D910>]}
[0m22:57:38.750392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2db7958b-ab26-4a4c-ab7b-d99a6c8a3eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F30415C10>]}
[0m22:57:38.751399 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m22:57:38.768731 [debug] [MainThread]: checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, vars: {}, profile: , target: target, version: 1.7.16
[0m22:57:38.779816 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:57:38.780808 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:57:38.783305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2db7958b-ab26-4a4c-ab7b-d99a6c8a3eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F30613190>]}
[0m22:57:39.884134 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.AmazonSalesAnalytics.target
[0m22:57:39.890696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2db7958b-ab26-4a4c-ab7b-d99a6c8a3eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F31724610>]}
[0m22:57:39.924920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2db7958b-ab26-4a4c-ab7b-d99a6c8a3eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F305D9590>]}
[0m22:57:39.927005 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m22:57:39.928915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2db7958b-ab26-4a4c-ab7b-d99a6c8a3eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F305E8CD0>]}
[0m22:57:39.930915 [info ] [MainThread]: 
[0m22:57:39.932991 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m22:57:39.935939 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics'
[0m22:57:39.945938 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics"
[0m22:57:39.948020 [debug] [ThreadPool]: On list_amazonsalesanalytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics"} */
select  name as [schema]
    from sys.schemas 
  
[0m22:57:39.949839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:57:39.950858 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m22:57:42.193176 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m22:57:42.417256 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m22:57:42.418317 [debug] [ThreadPool]: On list_amazonsalesanalytics: Close
[0m22:57:42.421549 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics_dwh'
[0m22:57:42.426534 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics_dwh"
[0m22:57:42.427540 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics_dwh"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
  
[0m22:57:42.428533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:57:42.429533 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m22:57:42.430607 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m22:57:42.664069 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:57:42.666105 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: ROLLBACK
[0m22:57:42.667174 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: Close
[0m22:57:42.670352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2db7958b-ab26-4a4c-ab7b-d99a6c8a3eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F30413F90>]}
[0m22:57:42.671270 [debug] [MainThread]: On master: COMMIT
[0m22:57:42.672268 [info ] [MainThread]: Concurrency: 1 threads (target='target')
[0m22:57:42.674355 [info ] [MainThread]: 
[0m22:57:42.685268 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.dim_product
[0m22:57:42.686294 [info ] [Thread-1 (]: 1 of 3 START sql view model dwh.dim_product .................................... [RUN]
[0m22:57:42.688267 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.dim_product'
[0m22:57:42.689271 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.dim_product
[0m22:57:42.696309 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.dim_product"
[0m22:57:42.705459 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (compile): 22:57:42.690268 => 22:57:42.705459
[0m22:57:42.706404 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.dim_product
[0m22:57:42.733106 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m22:57:42.734180 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."dim_product__dbt_backup";');

[0m22:57:42.735664 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:57:42.737845 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m22:57:42.738863 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m22:57:42.963252 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:57:42.966832 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m22:57:42.968748 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
    and table_name like 'dim_product'
  
[0m22:57:43.232838 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:57:43.239837 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m22:57:43.240921 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */
USE [amazonsalesanalytics];
      EXEC sp_rename 'dwh.dim_product', 'dim_product__dbt_backup'
[0m22:57:47.767096 [debug] [Thread-1 (]: SQL status: OK in 5.0 seconds
[0m22:57:47.781424 [debug] [Thread-1 (]: Writing runtime sql for node "model.AmazonSalesAnalytics.dim_product"
[0m22:57:47.788594 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m22:57:47.789596 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */
USE [amazonsalesanalytics];
    
    

    EXEC('create view "dwh"."dim_product" as with cte_product as (SELECT
    distinct 
    Category,
    SIZE,
    SKU,
    Style,
    ASIN
from dbo.raw_data)

select Category,
        SIZE,
        SKU,
        Style,
        ASIN
    from cte_product;');



[0m22:57:48.013039 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:57:48.014119 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (execute): 22:57:42.707461 => 22:57:48.014119
[0m22:57:48.016064 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: ROLLBACK
[0m22:57:48.017376 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: Close
[0m22:57:48.018467 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\AmazonSalesAnalytics\models\example\dim_product.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'dbo.raw_data'. (208) (SQLMoreResults)")
[0m22:57:48.034100 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\base.py", line 380, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\base.py", line 326, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\base.py", line 427, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 86, in macro
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
          ^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'dbo.raw_data'. (208) (SQLMoreResults)")

[0m22:57:48.036117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2db7958b-ab26-4a4c-ab7b-d99a6c8a3eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F318F6810>]}
[0m22:57:48.037591 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model dwh.dim_product ........................... [[31mERROR[0m in 5.35s]
[0m22:57:48.039589 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.dim_product
[0m22:57:48.040592 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.my_first_dbt_model
[0m22:57:48.042589 [info ] [Thread-1 (]: 2 of 3 START sql table model dwh.my_first_dbt_model ............................ [RUN]
[0m22:57:48.046224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AmazonSalesAnalytics.dim_product, now model.AmazonSalesAnalytics.my_first_dbt_model)
[0m22:57:48.048846 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.my_first_dbt_model
[0m22:57:48.053083 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.my_first_dbt_model"
[0m22:57:48.055993 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.my_first_dbt_model (compile): 22:57:48.049966 => 22:57:48.055993
[0m22:57:48.056994 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.my_first_dbt_model
[0m22:57:48.068576 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.my_first_dbt_model"
[0m22:57:48.069575 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.my_first_dbt_model"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."my_first_dbt_model__dbt_backup";');

[0m22:57:48.070498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:57:48.070498 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m22:57:48.071582 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m22:57:48.298667 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:57:48.304660 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.my_first_dbt_model"
[0m22:57:48.306658 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.my_first_dbt_model"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
    and table_name like 'my_first_dbt_model'
  
[0m22:57:48.540786 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:57:48.554773 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.my_first_dbt_model"
[0m22:57:48.556693 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.my_first_dbt_model"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'my_first_dbt_model_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m22:57:48.792298 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:57:48.796643 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.my_first_dbt_model"
[0m22:57:48.798680 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.my_first_dbt_model"} */

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."my_first_dbt_model_temp_view";');

  
[0m22:57:49.023836 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:57:49.025818 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.my_first_dbt_model"
[0m22:57:49.026820 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.my_first_dbt_model"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'my_first_dbt_model_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m22:57:49.250106 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:57:49.252116 [debug] [Thread-1 (]: Writing runtime sql for node "model.AmazonSalesAnalytics.my_first_dbt_model"
[0m22:57:49.255132 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.my_first_dbt_model"
[0m22:57:49.256124 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.my_first_dbt_model"} */

  
    

   

    USE [amazonsalesanalytics];
    
    

    EXEC('create view "dwh"."my_first_dbt_model_temp_view" as /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null;');



    
      EXEC('SELECT * INTO [amazonsalesanalytics].[dwh].[my_first_dbt_model] FROM [amazonsalesanalytics].[dwh].[my_first_dbt_model_temp_view];');
    

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."my_first_dbt_model_temp_view";');



  
[0m22:57:49.506193 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:57:49.524363 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_first_dbt_model: COMMIT
[0m22:57:49.528368 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.my_first_dbt_model"
[0m22:57:49.529329 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.my_first_dbt_model"} */

      USE [amazonsalesanalytics];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dwh' and tab2.name = 'my_first_dbt_model__dbt_backup'
  
[0m22:57:50.701198 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m22:57:50.705305 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.my_first_dbt_model"
[0m22:57:50.706373 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.my_first_dbt_model"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."my_first_dbt_model__dbt_backup";');

[0m22:57:50.928493 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:57:50.933494 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.my_first_dbt_model (execute): 22:57:48.058013 => 22:57:50.933494
[0m22:57:50.934492 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_first_dbt_model: ROLLBACK
[0m22:57:50.935492 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_first_dbt_model: Close
[0m22:57:50.936492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2db7958b-ab26-4a4c-ab7b-d99a6c8a3eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F31842550>]}
[0m22:57:50.937497 [info ] [Thread-1 (]: 2 of 3 OK created sql table model dwh.my_first_dbt_model ....................... [[32mOK[0m in 2.89s]
[0m22:57:50.939493 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.my_first_dbt_model
[0m22:57:50.940604 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.my_second_dbt_model
[0m22:57:50.941777 [info ] [Thread-1 (]: 3 of 3 START sql view model dwh.my_second_dbt_model ............................ [RUN]
[0m22:57:50.943295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AmazonSalesAnalytics.my_first_dbt_model, now model.AmazonSalesAnalytics.my_second_dbt_model)
[0m22:57:50.945351 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.my_second_dbt_model
[0m22:57:50.950366 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.my_second_dbt_model"
[0m22:57:50.954375 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.my_second_dbt_model (compile): 22:57:50.946351 => 22:57:50.953372
[0m22:57:50.955365 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.my_second_dbt_model
[0m22:57:50.963371 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.my_second_dbt_model"
[0m22:57:50.964676 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.my_second_dbt_model"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'my_second_dbt_model__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m22:57:50.964676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:57:50.965693 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m22:57:50.966690 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m22:57:51.203283 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:57:51.204612 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.my_second_dbt_model"
[0m22:57:51.206629 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.my_second_dbt_model"} */

      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."my_second_dbt_model__dbt_backup";');

[0m22:57:51.427538 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:57:51.429739 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.my_second_dbt_model"
[0m22:57:51.430739 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.my_second_dbt_model"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
    and table_name like 'my_second_dbt_model'
  
[0m22:57:51.662951 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:57:51.666011 [debug] [Thread-1 (]: Writing runtime sql for node "model.AmazonSalesAnalytics.my_second_dbt_model"
[0m22:57:51.668483 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.my_second_dbt_model"
[0m22:57:51.669482 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.my_second_dbt_model"} */
USE [amazonsalesanalytics];
    
    

    EXEC('create view "dwh"."my_second_dbt_model" as -- Use the `ref` function to select from other models

select *
from "amazonsalesanalytics"."dwh"."my_first_dbt_model"
where id = 1;');



[0m22:57:51.898110 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:57:51.902109 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_second_dbt_model: COMMIT
[0m22:57:51.905689 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.my_second_dbt_model"
[0m22:57:51.906775 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.my_second_dbt_model"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'my_second_dbt_model__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m22:57:52.178087 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:57:52.180110 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.my_second_dbt_model"
[0m22:57:52.181197 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.my_second_dbt_model"} */

      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."my_second_dbt_model__dbt_backup";');

[0m22:57:52.402487 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:57:52.404493 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.my_second_dbt_model (execute): 22:57:50.957307 => 22:57:52.404493
[0m22:57:52.405661 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_second_dbt_model: ROLLBACK
[0m22:57:52.406595 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.my_second_dbt_model: Close
[0m22:57:52.407662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2db7958b-ab26-4a4c-ab7b-d99a6c8a3eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F306B6B10>]}
[0m22:57:52.408597 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dwh.my_second_dbt_model ....................... [[32mOK[0m in 1.46s]
[0m22:57:52.409618 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.my_second_dbt_model
[0m22:57:52.412596 [debug] [MainThread]: On master: COMMIT
[0m22:57:52.414660 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:57:52.415583 [debug] [MainThread]: Connection 'list_amazonsalesanalytics' was properly closed.
[0m22:57:52.416600 [debug] [MainThread]: Connection 'list_amazonsalesanalytics_dwh' was properly closed.
[0m22:57:52.417584 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.my_second_dbt_model' was properly closed.
[0m22:57:52.418612 [info ] [MainThread]: 
[0m22:57:52.419942 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 12.49 seconds (12.49s).
[0m22:57:52.422033 [debug] [MainThread]: Command end result
[0m22:57:52.439397 [info ] [MainThread]: 
[0m22:57:52.440392 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:57:52.442405 [info ] [MainThread]: 
[0m22:57:52.443394 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'dbo.raw_data'. (208) (SQLMoreResults)")
[0m22:57:52.445994 [info ] [MainThread]: 
[0m22:57:52.446493 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m22:57:52.470778 [debug] [MainThread]: Command `dbt run` failed at 22:57:52.470778 after 14.93 seconds
[0m22:57:52.471780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F2FEC0150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F2FEC22D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F3044D910>]}
[0m22:57:52.473780 [debug] [MainThread]: Flushing usage events
[0m22:57:53.374417 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m22:59:18.723274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A457A110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A41BDC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A40781D0>]}


============================== 22:59:18.733512 | 378d5131-3ce6-4b90-8b7c-9b19700bd20d ==============================
[0m22:59:18.733512 [info ] [MainThread]: Running with dbt=1.7.16
[0m22:59:18.735423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models dim_product', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:59:19.324202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '378d5131-3ce6-4b90-8b7c-9b19700bd20d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A457B490>]}
[0m22:59:19.365117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '378d5131-3ce6-4b90-8b7c-9b19700bd20d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A4B7BBD0>]}
[0m22:59:19.366263 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m22:59:19.382217 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m22:59:19.391013 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m22:59:19.393172 [debug] [MainThread]: previous checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, current checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11
[0m22:59:19.393853 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:59:19.396219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '378d5131-3ce6-4b90-8b7c-9b19700bd20d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A4159CD0>]}
[0m22:59:20.467634 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.AmazonSalesAnalytics.target
[0m22:59:20.473926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '378d5131-3ce6-4b90-8b7c-9b19700bd20d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A4B58750>]}
[0m22:59:20.502745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '378d5131-3ce6-4b90-8b7c-9b19700bd20d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A5FF0F10>]}
[0m22:59:20.504610 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m22:59:20.507010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '378d5131-3ce6-4b90-8b7c-9b19700bd20d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A4AC1250>]}
[0m22:59:20.509783 [info ] [MainThread]: 
[0m22:59:20.512782 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m22:59:20.514785 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_analytics-raw'
[0m22:59:20.524456 [debug] [ThreadPool]: Using sqlserver connection "list_analytics-raw"
[0m22:59:20.525657 [debug] [ThreadPool]: On list_analytics-raw: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "connection_name": "list_analytics-raw"} */
select  name as [schema]
    from sys.schemas 
  
[0m22:59:20.526657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:59:20.527644 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=analytics-raw;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m22:59:22.766587 [debug] [ThreadPool]: SQLServer adapter: Connected to db: analytics-raw
[0m22:59:22.986177 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m22:59:22.989406 [debug] [ThreadPool]: On list_analytics-raw: Close
[0m22:59:22.992031 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_analytics-raw_dbo'
[0m22:59:22.998484 [debug] [ThreadPool]: Using sqlserver connection "list_analytics-raw_dbo"
[0m22:59:22.999483 [debug] [ThreadPool]: On list_analytics-raw_dbo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "connection_name": "list_analytics-raw_dbo"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbo'
  
[0m22:59:23.000494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:59:23.001483 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=analytics-raw;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m22:59:23.002486 [debug] [ThreadPool]: SQLServer adapter: Connected to db: analytics-raw
[0m22:59:23.224406 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:59:23.226406 [debug] [ThreadPool]: On list_analytics-raw_dbo: ROLLBACK
[0m22:59:23.227407 [debug] [ThreadPool]: On list_analytics-raw_dbo: Close
[0m22:59:23.229405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '378d5131-3ce6-4b90-8b7c-9b19700bd20d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A5DE2590>]}
[0m22:59:23.230412 [debug] [MainThread]: On master: COMMIT
[0m22:59:23.231406 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:59:23.232411 [info ] [MainThread]: 
[0m22:59:23.242733 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.dim_product
[0m22:59:23.244046 [info ] [Thread-1 (]: 1 of 1 START sql view model dbo.dim_product .................................... [RUN]
[0m22:59:23.247755 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.dim_product'
[0m22:59:23.249752 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.dim_product
[0m22:59:23.259325 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.dim_product"
[0m22:59:23.266325 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (compile): 22:59:23.251764 => 22:59:23.266325
[0m22:59:23.267326 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.dim_product
[0m22:59:23.300793 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m22:59:23.302794 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      
      
    USE [analytics-raw];
    EXEC('DROP table IF EXISTS "dbo"."dim_product__dbt_backup";');

[0m22:59:23.302794 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:59:23.304380 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=analytics-raw;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m22:59:23.305714 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: analytics-raw
[0m22:59:23.527358 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:59:23.530268 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m22:59:23.532269 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "node_id": "model.AmazonSalesAnalytics.dim_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbo'
    and table_name like 'dim_product'
  
[0m22:59:23.761024 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:59:23.766024 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m22:59:23.767029 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "node_id": "model.AmazonSalesAnalytics.dim_product"} */
USE [analytics-raw];
      EXEC sp_rename 'dbo.dim_product', 'dim_product__dbt_backup'
[0m22:59:28.014627 [debug] [Thread-1 (]: SQL status: OK in 4.0 seconds
[0m22:59:28.024642 [debug] [Thread-1 (]: Writing runtime sql for node "model.AmazonSalesAnalytics.dim_product"
[0m22:59:28.030578 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m22:59:28.031572 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "node_id": "model.AmazonSalesAnalytics.dim_product"} */
USE [analytics-raw];
    
    

    EXEC('create view "dbo"."dim_product" as with cte_product as (SELECT
    distinct 
    Category,
    SIZE,
    SKU,
    Style,
    ASIN
from dbo.raw_data)

select Category,
        SIZE,
        SKU,
        Style,
        ASIN
    from cte_product;');



[0m22:59:28.259691 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:59:28.274092 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: COMMIT
[0m22:59:28.277079 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m22:59:28.278056 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      
      
    USE [analytics-raw];
    EXEC('DROP table IF EXISTS "dbo"."dim_product__dbt_backup";');

[0m22:59:28.506137 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:59:28.510194 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (execute): 22:59:23.268319 => 22:59:28.510194
[0m22:59:28.512203 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: Close
[0m22:59:28.514196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '378d5131-3ce6-4b90-8b7c-9b19700bd20d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A6017010>]}
[0m22:59:28.515191 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbo.dim_product ............................... [[32mOK[0m in 5.27s]
[0m22:59:28.517197 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.dim_product
[0m22:59:28.520786 [debug] [MainThread]: On master: COMMIT
[0m22:59:28.521727 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:59:28.522894 [debug] [MainThread]: Connection 'list_analytics-raw' was properly closed.
[0m22:59:28.523847 [debug] [MainThread]: Connection 'list_analytics-raw_dbo' was properly closed.
[0m22:59:28.523847 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.dim_product' was properly closed.
[0m22:59:28.524905 [info ] [MainThread]: 
[0m22:59:28.525809 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.01 seconds (8.01s).
[0m22:59:28.527805 [debug] [MainThread]: Command end result
[0m22:59:28.545370 [info ] [MainThread]: 
[0m22:59:28.548675 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:59:28.549674 [info ] [MainThread]: 
[0m22:59:28.551673 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:59:28.570557 [debug] [MainThread]: Command `dbt run` succeeded at 22:59:28.570557 after 10.44 seconds
[0m22:59:28.571546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A4078710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001799DADB850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A39A1050>]}
[0m22:59:28.572547 [debug] [MainThread]: Flushing usage events
[0m22:59:29.437586 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m23:39:49.580914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135E41FE990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135E42329D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135E4230410>]}


============================== 23:39:49.590913 | d1d4ff02-5cb7-4850-b9ef-d4e04b0e5cde ==============================
[0m23:39:49.590913 [info ] [MainThread]: Running with dbt=1.7.16
[0m23:39:49.592914 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models source.dim_product', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:39:49.597000 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'AmazonSalesAnalytics' does not have a target named 'dev'. The valid target names for this profile are:
   - source
   - target
[0m23:39:49.603101 [debug] [MainThread]: Command `dbt run` failed at 23:39:49.603101 after 0.69 seconds
[0m23:39:49.604101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135E42507D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135E41FDA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135E42329D0>]}
[0m23:39:49.606101 [debug] [MainThread]: Flushing usage events
[0m23:39:50.565884 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m23:40:56.766416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D22783F8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D22660D190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D22743DF10>]}


============================== 23:40:56.776936 | 90bdf631-c630-4eff-afb3-8f89f633cf3e ==============================
[0m23:40:56.776936 [info ] [MainThread]: Running with dbt=1.7.16
[0m23:40:56.779562 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models source.dim_product', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:40:57.362491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90bdf631-c630-4eff-afb3-8f89f633cf3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D227D73B90>]}
[0m23:40:57.404011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90bdf631-c630-4eff-afb3-8f89f633cf3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D227D9B910>]}
[0m23:40:57.405033 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m23:40:57.422288 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m23:40:57.434112 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:40:57.436035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '90bdf631-c630-4eff-afb3-8f89f633cf3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D228F66E90>]}
[0m23:40:58.392568 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.AmazonSalesAnalytics.dim_product' (models\source\dim_product.sql) depends on a source named 'dbo.raw_data' which was not found
[0m23:40:58.417169 [debug] [MainThread]: Command `dbt run` failed at 23:40:58.417169 after 2.24 seconds
[0m23:40:58.419179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2278058D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D227250750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2272D4850>]}
[0m23:40:58.420166 [debug] [MainThread]: Flushing usage events
[0m23:40:59.352536 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m23:50:50.864997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017826EDF910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017826EBE090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017826EBC410>]}


============================== 23:50:50.874311 | 5dec3d84-e509-4945-a467-cd7500d99089 ==============================
[0m23:50:50.874311 [info ] [MainThread]: Running with dbt=1.7.16
[0m23:50:50.876700 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models source.dim_product', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:50:51.468742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dec3d84-e509-4945-a467-cd7500d99089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001782748BC50>]}
[0m23:50:51.510952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dec3d84-e509-4945-a467-cd7500d99089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001782745E790>]}
[0m23:50:51.511949 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m23:50:51.527581 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m23:50:51.538184 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:50:51.539679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5dec3d84-e509-4945-a467-cd7500d99089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017828607810>]}
[0m23:50:52.562744 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.AmazonSalesAnalytics.dim_product' (models\source\dim_product.sql) depends on a source named 'dbo.raw_data' which was not found
[0m23:50:52.588839 [debug] [MainThread]: Command `dbt run` failed at 23:50:52.588839 after 2.36 seconds
[0m23:50:52.590851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017826EA7850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017826E8DB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017826EA1FD0>]}
[0m23:50:52.590851 [debug] [MainThread]: Flushing usage events
[0m23:50:53.512498 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m23:52:27.963495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001784B06DB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001784B462A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001784B461110>]}


============================== 23:52:27.973578 | 56c21c4d-1e86-4dd1-83be-5c70ccf455e3 ==============================
[0m23:52:27.973578 [info ] [MainThread]: Running with dbt=1.7.16
[0m23:52:27.975631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models source.dim_product', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:52:28.620213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56c21c4d-1e86-4dd1-83be-5c70ccf455e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001784B9D8D10>]}
[0m23:52:28.664064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56c21c4d-1e86-4dd1-83be-5c70ccf455e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001784B846390>]}
[0m23:52:28.664981 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m23:52:28.682256 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m23:52:28.694160 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:52:28.694938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '56c21c4d-1e86-4dd1-83be-5c70ccf455e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001784CBA7510>]}
[0m23:52:29.744978 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.AmazonSalesAnalytics.dim_product_target' (models\target\dim_product_target.sql) depends on a node named 'source.dim_product' which was not found
[0m23:52:29.769754 [debug] [MainThread]: Command `dbt run` failed at 23:52:29.768759 after 2.41 seconds
[0m23:52:29.770877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001784B086590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001784B443610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001784B444790>]}
[0m23:52:29.771804 [debug] [MainThread]: Flushing usage events
[0m23:52:30.716291 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m23:59:27.691595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAECFDE610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAECAC4750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAECAC4AD0>]}


============================== 23:59:27.702664 | 478bf08b-4964-4e1e-a413-78f20d71c77c ==============================
[0m23:59:27.702664 [info ] [MainThread]: Running with dbt=1.7.16
[0m23:59:27.704623 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models source.dim_product', 'send_anonymous_usage_stats': 'True'}
[0m23:59:28.300866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '478bf08b-4964-4e1e-a413-78f20d71c77c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAECFDB490>]}
[0m23:59:28.344457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '478bf08b-4964-4e1e-a413-78f20d71c77c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAEC808310>]}
[0m23:59:28.345383 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m23:59:28.360608 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m23:59:28.373701 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:59:28.375591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '478bf08b-4964-4e1e-a413-78f20d71c77c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAEE752B50>]}
[0m23:59:29.412113 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.AmazonSalesAnalytics.dim_product_target' (models\target\dim_product_target.sql) depends on a node named 'source.dim_product' which was not found
[0m23:59:29.439038 [debug] [MainThread]: Command `dbt run` failed at 23:59:29.439038 after 2.32 seconds
[0m23:59:29.440068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAECAC4850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAECFF4710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAED570E50>]}
[0m23:59:29.441036 [debug] [MainThread]: Flushing usage events
[0m23:59:30.410721 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m00:03:01.836959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002616E64B090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002616E69F690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002616E64B710>]}


============================== 00:03:01.846520 | f8b413bb-8652-4003-a8d3-764c89f9df44 ==============================
[0m00:03:01.846520 [info ] [MainThread]: Running with dbt=1.7.16
[0m00:03:01.848452 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models source.dim_product', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:03:02.420790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8b413bb-8652-4003-a8d3-764c89f9df44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002616EB0E910>]}
[0m00:03:02.465890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8b413bb-8652-4003-a8d3-764c89f9df44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002616E67ED90>]}
[0m00:03:02.467894 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m00:03:02.481873 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m00:03:02.494844 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:03:02.497844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f8b413bb-8652-4003-a8d3-764c89f9df44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002616FDC3090>]}
[0m00:03:03.520697 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.AmazonSalesAnalytics.dim_product_target' (models\target\dim_product_target.sql) depends on a node named 'source.dim_product' which was not found
[0m00:03:03.548439 [debug] [MainThread]: Command `dbt run` failed at 00:03:03.547404 after 2.34 seconds
[0m00:03:03.549799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002616E6617D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002616DA9B150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002616E64DE90>]}
[0m00:03:03.550772 [debug] [MainThread]: Flushing usage events
[0m00:03:04.458935 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m00:04:43.580923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C34E0B110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C34E61710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C34E62F10>]}


============================== 00:04:43.590733 | 35bb0870-7f05-4a9e-86b9-7c773ef3fdca ==============================
[0m00:04:43.590733 [info ] [MainThread]: Running with dbt=1.7.16
[0m00:04:43.592296 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:04:43.593285 [info ] [MainThread]: dbt version: 1.7.16
[0m00:04:43.594312 [info ] [MainThread]: python version: 3.11.2
[0m00:04:43.596336 [info ] [MainThread]: python path: C:\Drive\dbt_venv\Scripts\python.exe
[0m00:04:43.598103 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m00:04:44.055418 [info ] [MainThread]: Using profiles dir at C:\Users\GB617GQ\.dbt
[0m00:04:44.056326 [info ] [MainThread]: Using profiles.yml file at C:\Users\GB617GQ\.dbt\profiles.yml
[0m00:04:44.057680 [info ] [MainThread]: Using dbt_project.yml file at C:\Drive\AmazonSalesAnalytics\dbt_project.yml
[0m00:04:44.058807 [info ] [MainThread]: adapter type: sqlserver
[0m00:04:44.060072 [info ] [MainThread]: adapter version: 1.7.4
[0m00:04:44.124286 [info ] [MainThread]: Configuration:
[0m00:04:44.126420 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:04:44.127622 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:04:44.129642 [info ] [MainThread]: Required dependencies:
[0m00:04:44.130997 [debug] [MainThread]: Executing "git --help"
[0m00:04:44.936142 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:04:44.937208 [debug] [MainThread]: STDERR: "b''"
[0m00:04:44.938248 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:04:44.940254 [info ] [MainThread]: Connection:
[0m00:04:44.941251 [info ] [MainThread]:   server: analytics-warehouse.database.windows.net
[0m00:04:44.943329 [info ] [MainThread]:   database: analytics-raw
[0m00:04:44.944728 [info ] [MainThread]:   schema: dbo
[0m00:04:44.946216 [info ] [MainThread]:   UID: sqladmin
[0m00:04:44.947455 [info ] [MainThread]:   client_id: None
[0m00:04:44.948571 [info ] [MainThread]:   authentication: sql
[0m00:04:44.949570 [info ] [MainThread]:   encrypt: True
[0m00:04:44.951573 [info ] [MainThread]:   trust_cert: False
[0m00:04:44.952639 [info ] [MainThread]:   retries: 1
[0m00:04:44.954047 [info ] [MainThread]:   login_timeout: 0
[0m00:04:44.955044 [info ] [MainThread]:   query_timeout: 0
[0m00:04:44.956044 [info ] [MainThread]:   port: 1433
[0m00:04:44.957271 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m00:04:44.959277 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m00:04:44.960282 [debug] [MainThread]: Using sqlserver connection "debug"
[0m00:04:44.961277 [debug] [MainThread]: On debug: select 1 as id
[0m00:04:44.961277 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:04:44.963045 [debug] [MainThread]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=analytics-raw;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:04:47.342053 [debug] [MainThread]: SQLServer adapter: Connected to db: analytics-raw
[0m00:04:47.589814 [debug] [MainThread]: SQL status: OK in 3.0 seconds
[0m00:04:47.591814 [debug] [MainThread]: On debug: Close
[0m00:04:47.592930 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:04:47.594924 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:04:47.600437 [debug] [MainThread]: Command `dbt debug` succeeded at 00:04:47.600437 after 4.63 seconds
[0m00:04:47.601442 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:04:47.602438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C33A2B410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C2E31B5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C3536ACD0>]}
[0m00:04:47.603441 [debug] [MainThread]: Flushing usage events
[0m00:04:48.530531 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m00:06:16.545882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024637710DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246371F4AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246371F4750>]}


============================== 00:06:16.555749 | a63379c5-f4c9-44c7-b532-c23c5e2cfa35 ==============================
[0m00:06:16.555749 [info ] [MainThread]: Running with dbt=1.7.16
[0m00:06:16.557754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models source.dim_product', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:06:17.147757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a63379c5-f4c9-44c7-b532-c23c5e2cfa35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024637C77ED0>]}
[0m00:06:17.190088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a63379c5-f4c9-44c7-b532-c23c5e2cfa35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024637CCA310>]}
[0m00:06:17.191609 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m00:06:17.206974 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m00:06:17.219172 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:06:17.221130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a63379c5-f4c9-44c7-b532-c23c5e2cfa35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024638E73390>]}
[0m00:06:19.690769 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.AmazonSalesAnalytics.dim_product_target' (models\target\dim_product_target.sql) depends on a node named 'source.dim_product' which was not found
[0m00:06:19.719292 [debug] [MainThread]: Command `dbt run` failed at 00:06:19.719292 after 3.81 seconds
[0m00:06:19.720290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246376FDE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024637750510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024637170E50>]}
[0m00:06:19.722290 [debug] [MainThread]: Flushing usage events
[0m00:06:20.666864 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m00:06:46.525444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C02C430210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C02BEF4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C02C05E610>]}


============================== 00:06:46.536709 | 33538cb4-754a-4451-982b-6561d8b7814e ==============================
[0m00:06:46.536709 [info ] [MainThread]: Running with dbt=1.7.16
[0m00:06:46.537708 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models target.dim_product_target', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:06:47.119238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33538cb4-754a-4451-982b-6561d8b7814e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C02C4677D0>]}
[0m00:06:47.161522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33538cb4-754a-4451-982b-6561d8b7814e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C02BC38D10>]}
[0m00:06:47.162522 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m00:06:47.179288 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m00:06:47.190940 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:06:47.192874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '33538cb4-754a-4451-982b-6561d8b7814e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C02DB72AD0>]}
[0m00:06:48.220154 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.AmazonSalesAnalytics.dim_product_target' (models\target\dim_product_target.sql) depends on a node named 'source.dim_product' which was not found
[0m00:06:48.245786 [debug] [MainThread]: Command `dbt run` failed at 00:06:48.245786 after 2.31 seconds
[0m00:06:48.246794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C02C3FDE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C02BEF4850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C02CB2C910>]}
[0m00:06:48.248602 [debug] [MainThread]: Flushing usage events
[0m00:06:49.143214 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m00:08:29.628550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B8DCF610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B8DCC390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B8DCCF50>]}


============================== 00:08:29.639127 | 16350355-a1c9-4017-a68a-b125ce68b47f ==============================
[0m00:08:29.639127 [info ] [MainThread]: Running with dbt=1.7.16
[0m00:08:29.641027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models source.dim_product', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:08:30.219974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16350355-a1c9-4017-a68a-b125ce68b47f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B93CAB10>]}
[0m00:08:30.262975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16350355-a1c9-4017-a68a-b125ce68b47f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B8DCAA10>]}
[0m00:08:30.263974 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m00:08:30.283254 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m00:08:30.294708 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:08:30.296752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '16350355-a1c9-4017-a68a-b125ce68b47f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B937A610>]}
[0m00:08:31.341715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16350355-a1c9-4017-a68a-b125ce68b47f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B94EE7D0>]}
[0m00:08:31.368416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16350355-a1c9-4017-a68a-b125ce68b47f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BA66E110>]}
[0m00:08:31.370378 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 448 macros, 0 groups, 0 semantic models
[0m00:08:31.371378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16350355-a1c9-4017-a68a-b125ce68b47f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BA74A650>]}
[0m00:08:31.373113 [info ] [MainThread]: 
[0m00:08:31.375319 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m00:08:31.377287 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_analytics-raw'
[0m00:08:31.388224 [debug] [ThreadPool]: Using sqlserver connection "list_analytics-raw"
[0m00:08:31.390233 [debug] [ThreadPool]: On list_analytics-raw: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "connection_name": "list_analytics-raw"} */
select  name as [schema]
    from sys.schemas 
  
[0m00:08:31.391224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:08:31.392215 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=analytics-raw;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:08:33.697767 [debug] [ThreadPool]: SQLServer adapter: Connected to db: analytics-raw
[0m00:08:33.927464 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m00:08:33.929409 [debug] [ThreadPool]: On list_analytics-raw: Close
[0m00:08:33.931371 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics_dbo'
[0m00:08:33.937423 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics_dbo"
[0m00:08:33.938395 [debug] [ThreadPool]: On list_amazonsalesanalytics_dbo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "connection_name": "list_amazonsalesanalytics_dbo"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbo'
  
[0m00:08:33.939309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:08:33.940302 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=analytics-raw;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:08:33.942010 [debug] [ThreadPool]: SQLServer adapter: Connected to db: analytics-raw
[0m00:08:34.297258 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m00:08:34.300259 [debug] [ThreadPool]: On list_amazonsalesanalytics_dbo: ROLLBACK
[0m00:08:34.301260 [debug] [ThreadPool]: On list_amazonsalesanalytics_dbo: Close
[0m00:08:34.302258 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_amazonsalesanalytics_dbo, now list_analytics-raw_dbo)
[0m00:08:34.306258 [debug] [ThreadPool]: Using sqlserver connection "list_analytics-raw_dbo"
[0m00:08:34.308258 [debug] [ThreadPool]: On list_analytics-raw_dbo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "connection_name": "list_analytics-raw_dbo"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbo'
  
[0m00:08:34.309259 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:08:34.310263 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=analytics-raw;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:08:34.311258 [debug] [ThreadPool]: SQLServer adapter: Connected to db: analytics-raw
[0m00:08:34.543057 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m00:08:34.545058 [debug] [ThreadPool]: On list_analytics-raw_dbo: ROLLBACK
[0m00:08:34.545058 [debug] [ThreadPool]: On list_analytics-raw_dbo: Close
[0m00:08:34.547131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16350355-a1c9-4017-a68a-b125ce68b47f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B9546B50>]}
[0m00:08:34.548182 [debug] [MainThread]: On master: COMMIT
[0m00:08:34.549688 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:08:34.550767 [info ] [MainThread]: 
[0m00:08:34.560820 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.dim_product
[0m00:08:34.561771 [info ] [Thread-1 (]: 1 of 1 START sql view model dbo.dim_product .................................... [RUN]
[0m00:08:34.564767 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.dim_product'
[0m00:08:34.565831 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.dim_product
[0m00:08:34.578109 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.dim_product"
[0m00:08:34.591930 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (compile): 00:08:34.567834 => 00:08:34.590930
[0m00:08:34.592925 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.dim_product
[0m00:08:34.619567 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:08:34.620567 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      USE [analytics-raw];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'analytics-raw'
      and refs.referenced_schema_name = 'dbo'
      and refs.referenced_entity_name = 'dim_product__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m00:08:34.621567 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:08:34.622568 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=analytics-raw;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:08:34.623567 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: analytics-raw
[0m00:08:34.937680 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:08:34.940257 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:08:34.940257 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      
      
    
    USE [analytics-raw];
    EXEC('DROP view IF EXISTS "dbo"."dim_product__dbt_backup";');

[0m00:08:35.173174 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:08:35.176285 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:08:35.178213 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "node_id": "model.AmazonSalesAnalytics.dim_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbo'
    and table_name like 'dim_product'
  
[0m00:08:35.406288 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:08:35.413287 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:08:35.414288 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "node_id": "model.AmazonSalesAnalytics.dim_product"} */
USE [analytics-raw];
      EXEC sp_rename 'dbo.dim_product', 'dim_product__dbt_backup'
[0m00:08:35.648859 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:08:35.658336 [debug] [Thread-1 (]: Writing runtime sql for node "model.AmazonSalesAnalytics.dim_product"
[0m00:08:35.670745 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:08:35.673191 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "node_id": "model.AmazonSalesAnalytics.dim_product"} */
USE [analytics-raw];
    
    

    EXEC('create view "dbo"."dim_product" as with cte_product as 
        (
        SELECT
            distinct 
            Category,
            SIZE,
            SKU,
            Style,
            ASIN
        from "analytics-raw"."dbo"."raw_data"
    )

select Category,
        SIZE,
        SKU,
        Style,
        ASIN
    from cte_product;');



[0m00:08:35.909583 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:08:35.926010 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: COMMIT
[0m00:08:35.929039 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:08:35.930083 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      USE [analytics-raw];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'analytics-raw'
      and refs.referenced_schema_name = 'dbo'
      and refs.referenced_entity_name = 'dim_product__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m00:08:36.162271 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:08:36.164326 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:08:36.165751 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      
      
    
    USE [analytics-raw];
    EXEC('DROP view IF EXISTS "dbo"."dim_product__dbt_backup";');

[0m00:08:36.402269 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:08:36.404268 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (execute): 00:08:34.593930 => 00:08:36.404268
[0m00:08:36.405272 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: ROLLBACK
[0m00:08:36.406267 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: Close
[0m00:08:36.407273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16350355-a1c9-4017-a68a-b125ce68b47f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BA65E750>]}
[0m00:08:36.408268 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbo.dim_product ............................... [[32mOK[0m in 1.84s]
[0m00:08:36.410264 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.dim_product
[0m00:08:36.413305 [debug] [MainThread]: On master: COMMIT
[0m00:08:36.414372 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:08:36.414372 [debug] [MainThread]: Connection 'list_analytics-raw' was properly closed.
[0m00:08:36.415844 [debug] [MainThread]: Connection 'list_analytics-raw_dbo' was properly closed.
[0m00:08:36.417100 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.dim_product' was properly closed.
[0m00:08:36.418146 [info ] [MainThread]: 
[0m00:08:36.420136 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.04 seconds (5.04s).
[0m00:08:36.422137 [debug] [MainThread]: Command end result
[0m00:08:36.439514 [info ] [MainThread]: 
[0m00:08:36.440516 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:08:36.441514 [info ] [MainThread]: 
[0m00:08:36.443552 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:08:36.465173 [debug] [MainThread]: Command `dbt run` succeeded at 00:08:36.464734 after 7.49 seconds
[0m00:08:36.466530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B7C75BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B8E1EFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B234A890>]}
[0m00:08:36.467925 [debug] [MainThread]: Flushing usage events
[0m00:08:37.311384 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m00:11:08.659718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248C1BFF710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248C1BE0510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248C1BE3010>]}


============================== 00:11:08.669821 | a551ec4b-a852-4674-8cae-1d93847eebc5 ==============================
[0m00:11:08.669821 [info ] [MainThread]: Running with dbt=1.7.16
[0m00:11:08.671748 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --models target.dim_product_target', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:11:09.261613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a551ec4b-a852-4674-8cae-1d93847eebc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248C210BFD0>]}
[0m00:11:09.305191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a551ec4b-a852-4674-8cae-1d93847eebc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248C2189410>]}
[0m00:11:09.306199 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m00:11:09.327643 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m00:11:09.652982 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:11:09.654055 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:11:09.659160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a551ec4b-a852-4674-8cae-1d93847eebc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248C331B210>]}
[0m00:11:09.685883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a551ec4b-a852-4674-8cae-1d93847eebc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248C3254790>]}
[0m00:11:09.688958 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 448 macros, 0 groups, 0 semantic models
[0m00:11:09.689881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a551ec4b-a852-4674-8cae-1d93847eebc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248C0FFAD50>]}
[0m00:11:09.691881 [info ] [MainThread]: 
[0m00:11:09.693889 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m00:11:09.694883 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics'
[0m00:11:09.706018 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics"
[0m00:11:09.708035 [debug] [ThreadPool]: On list_amazonsalesanalytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "connection_name": "list_amazonsalesanalytics"} */
select  name as [schema]
    from sys.schemas 
  
[0m00:11:09.709926 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:09.711010 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=analytics-raw;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:11:12.043736 [debug] [ThreadPool]: SQLServer adapter: Connected to db: analytics-raw
[0m00:11:12.275165 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m00:11:12.278165 [debug] [ThreadPool]: On list_amazonsalesanalytics: Close
[0m00:11:12.280164 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_analytics-raw_dbo'
[0m00:11:12.286237 [debug] [ThreadPool]: Using sqlserver connection "list_analytics-raw_dbo"
[0m00:11:12.287237 [debug] [ThreadPool]: On list_analytics-raw_dbo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "connection_name": "list_analytics-raw_dbo"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbo'
  
[0m00:11:12.288237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:12.289259 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=analytics-raw;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:11:12.290394 [debug] [ThreadPool]: SQLServer adapter: Connected to db: analytics-raw
[0m00:11:12.521906 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m00:11:12.523920 [debug] [ThreadPool]: On list_analytics-raw_dbo: ROLLBACK
[0m00:11:12.524906 [debug] [ThreadPool]: On list_analytics-raw_dbo: Close
[0m00:11:12.525926 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics-raw_dbo, now list_amazonsalesanalytics_dbo)
[0m00:11:12.528944 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics_dbo"
[0m00:11:12.529920 [debug] [ThreadPool]: On list_amazonsalesanalytics_dbo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "connection_name": "list_amazonsalesanalytics_dbo"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbo'
  
[0m00:11:12.529920 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:12.530948 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=analytics-raw;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:11:12.532894 [debug] [ThreadPool]: SQLServer adapter: Connected to db: analytics-raw
[0m00:11:12.767189 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m00:11:12.769200 [debug] [ThreadPool]: On list_amazonsalesanalytics_dbo: ROLLBACK
[0m00:11:12.770199 [debug] [ThreadPool]: On list_amazonsalesanalytics_dbo: Close
[0m00:11:12.772187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a551ec4b-a852-4674-8cae-1d93847eebc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248C2101A10>]}
[0m00:11:12.773199 [debug] [MainThread]: On master: COMMIT
[0m00:11:12.774202 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:11:12.775187 [info ] [MainThread]: 
[0m00:11:12.786005 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.dim_product_target
[0m00:11:12.787006 [info ] [Thread-1 (]: 1 of 1 START sql table model amazonsalesanalytics.dbo.dim_product_target ....... [RUN]
[0m00:11:12.789009 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.dim_product_target'
[0m00:11:12.791024 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.dim_product_target
[0m00:11:12.803721 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.dim_product_target"
[0m00:11:12.819745 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product_target (compile): 00:11:12.792008 => 00:11:12.818725
[0m00:11:12.820746 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.dim_product_target
[0m00:11:12.843954 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product_target"
[0m00:11:12.844955 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product_target: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "node_id": "model.AmazonSalesAnalytics.dim_product_target"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dbo"."dim_product_target__dbt_backup";');

[0m00:11:12.845955 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:11:12.846955 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=analytics-raw;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:11:14.068267 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: analytics-raw
[0m00:11:14.301099 [debug] [Thread-1 (]: fabric adapter: Database error: ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]USE statement is not supported to switch between databases. Use a new connection to connect to a different database. (40508) (SQLExecDirectW)')
[0m00:11:14.302177 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product_target: Close
[0m00:11:14.303223 [debug] [Thread-1 (]: fabric adapter: Error running SQL: macro drop_relation
[0m00:11:14.304378 [debug] [Thread-1 (]: fabric adapter: Rolling back transaction.
[0m00:11:14.305139 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product_target (execute): 00:11:12.821749 => 00:11:14.305139
[0m00:11:14.339377 [debug] [Thread-1 (]: Database Error in model dim_product_target (models\target\dim_product_target.sql)
  ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]USE statement is not supported to switch between databases. Use a new connection to connect to a different database. (40508) (SQLExecDirectW)')
[0m00:11:14.340333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a551ec4b-a852-4674-8cae-1d93847eebc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248C3411590>]}
[0m00:11:14.342336 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model amazonsalesanalytics.dbo.dim_product_target  [[31mERROR[0m in 1.55s]
[0m00:11:14.343393 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.dim_product_target
[0m00:11:14.346390 [debug] [MainThread]: On master: COMMIT
[0m00:11:14.348392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:11:14.349529 [debug] [MainThread]: Connection 'list_amazonsalesanalytics' was properly closed.
[0m00:11:14.351474 [debug] [MainThread]: Connection 'list_amazonsalesanalytics_dbo' was properly closed.
[0m00:11:14.352505 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.dim_product_target' was properly closed.
[0m00:11:14.353498 [info ] [MainThread]: 
[0m00:11:14.355539 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.66 seconds (4.66s).
[0m00:11:14.356508 [debug] [MainThread]: Command end result
[0m00:11:14.373690 [info ] [MainThread]: 
[0m00:11:14.375684 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:11:14.376679 [info ] [MainThread]: 
[0m00:11:14.378678 [error] [MainThread]:   Database Error in model dim_product_target (models\target\dim_product_target.sql)
  ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]USE statement is not supported to switch between databases. Use a new connection to connect to a different database. (40508) (SQLExecDirectW)')
[0m00:11:14.379680 [info ] [MainThread]: 
[0m00:11:14.382443 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:11:14.407436 [debug] [MainThread]: Command `dbt run` failed at 00:11:14.407436 after 6.30 seconds
[0m00:11:14.408435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248C1BC6490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248C1BC4F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248C219ED50>]}
[0m00:11:14.409433 [debug] [MainThread]: Flushing usage events
[0m00:11:15.370292 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m00:14:49.153385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E56CDF1F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E56CB0C8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E56CDF1E50>]}


============================== 00:14:49.165690 | 35667e88-a59b-4a36-9212-495c2cc70566 ==============================
[0m00:14:49.165690 [info ] [MainThread]: Running with dbt=1.7.16
[0m00:14:49.166688 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --target target --models target.dim_product_target', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:14:49.809012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35667e88-a59b-4a36-9212-495c2cc70566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E56D3BD7D0>]}
[0m00:14:49.853459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35667e88-a59b-4a36-9212-495c2cc70566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E56D387350>]}
[0m00:14:49.855373 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m00:14:49.871478 [debug] [MainThread]: checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, vars: {}, profile: , target: target, version: 1.7.16
[0m00:14:49.881465 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:14:49.883464 [debug] [MainThread]: previous checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, current checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf
[0m00:14:49.884463 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:14:49.885464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '35667e88-a59b-4a36-9212-495c2cc70566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E56C200E90>]}
[0m00:14:50.990412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35667e88-a59b-4a36-9212-495c2cc70566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E56E686650>]}
[0m00:14:51.018409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35667e88-a59b-4a36-9212-495c2cc70566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E56E6BCED0>]}
[0m00:14:51.019414 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 448 macros, 0 groups, 0 semantic models
[0m00:14:51.020485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35667e88-a59b-4a36-9212-495c2cc70566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E56E6A8450>]}
[0m00:14:51.022489 [info ] [MainThread]: 
[0m00:14:51.024512 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m00:14:51.026503 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics'
[0m00:14:51.036906 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics"
[0m00:14:51.037922 [debug] [ThreadPool]: On list_amazonsalesanalytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics"} */
select  name as [schema]
    from sys.schemas 
  
[0m00:14:51.038908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:51.039909 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:14:53.338985 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:14:53.559675 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m00:14:53.561796 [debug] [ThreadPool]: On list_amazonsalesanalytics: Close
[0m00:14:53.564890 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics_dwh'
[0m00:14:53.568902 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics_dwh"
[0m00:14:53.570811 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics_dwh"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
  
[0m00:14:53.570811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:53.571807 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:14:53.572809 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:14:53.796421 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m00:14:53.798282 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: ROLLBACK
[0m00:14:53.798441 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: Close
[0m00:14:53.800368 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_amazonsalesanalytics_dwh, now list_analytics-raw_dwh)
[0m00:14:53.806596 [debug] [ThreadPool]: Using sqlserver connection "list_analytics-raw_dwh"
[0m00:14:53.808160 [debug] [ThreadPool]: On list_analytics-raw_dwh: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_analytics-raw_dwh"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
  
[0m00:14:53.809478 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:53.809478 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:14:53.811363 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:14:54.044007 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m00:14:54.045949 [debug] [ThreadPool]: On list_analytics-raw_dwh: ROLLBACK
[0m00:14:54.046501 [debug] [ThreadPool]: On list_analytics-raw_dwh: Close
[0m00:14:54.049316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35667e88-a59b-4a36-9212-495c2cc70566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E56D4F9210>]}
[0m00:14:54.050321 [debug] [MainThread]: On master: COMMIT
[0m00:14:54.051446 [info ] [MainThread]: Concurrency: 1 threads (target='target')
[0m00:14:54.052454 [info ] [MainThread]: 
[0m00:14:54.064458 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.dim_product_target
[0m00:14:54.065186 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh.dim_product_target ............................ [RUN]
[0m00:14:54.067609 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.dim_product_target'
[0m00:14:54.068548 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.dim_product_target
[0m00:14:54.080806 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.dim_product_target"
[0m00:14:54.090946 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product_target (compile): 00:14:54.069552 => 00:14:54.090446
[0m00:14:54.092281 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.dim_product_target
[0m00:14:54.116599 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product_target"
[0m00:14:54.118235 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product_target: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product_target"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."dim_product_target__dbt_backup";');

[0m00:14:54.119497 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:14:54.119808 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:14:54.120830 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:14:54.342971 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:14:54.345996 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product_target"
[0m00:14:54.346995 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product_target: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product_target"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
    and table_name like 'dim_product_target'
  
[0m00:14:54.576736 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:14:54.589804 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product_target"
[0m00:14:54.591589 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product_target: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product_target"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_product_target_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m00:14:54.833090 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:14:54.836090 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product_target"
[0m00:14:54.837097 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product_target: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product_target"} */

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_product_target_temp_view";');

  
[0m00:14:55.063233 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:14:55.068231 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product_target"
[0m00:14:55.069231 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product_target: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product_target"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_product_target_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m00:14:55.292844 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:14:55.294856 [debug] [Thread-1 (]: Writing runtime sql for node "model.AmazonSalesAnalytics.dim_product_target"
[0m00:14:55.304854 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product_target"
[0m00:14:55.306479 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product_target: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product_target"} */

  
    

   

    USE [amazonsalesanalytics];
    
    

    EXEC('create view "dwh"."dim_product_target_temp_view" as -- models/target/dim_product.sql


    insert into amazonsalesanalytics.dwh.dim_product
    select * from "analytics-raw"."dwh"."dim_product"
;');



    
      EXEC('SELECT * INTO [amazonsalesanalytics].[dwh].[dim_product_target] FROM [amazonsalesanalytics].[dwh].[dim_product_target_temp_view];');
    

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_product_target_temp_view";');



  
[0m00:14:55.528660 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:14:55.529598 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product_target (execute): 00:14:54.093657 => 00:14:55.529598
[0m00:14:55.530599 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product_target: ROLLBACK
[0m00:14:55.531605 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product_target: Close
[0m00:14:55.533598 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\AmazonSalesAnalytics\models\target\dim_product_target.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'insert'. (156) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Reference to database and/or server name in 'analytics-raw.dwh.dim_product' is not supported in this version of SQL Server. (40515)")
[0m00:14:55.551830 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\base.py", line 380, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\base.py", line 326, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\base.py", line 427, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 83, in macro
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
          ^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'insert'. (156) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Reference to database and/or server name in 'analytics-raw.dwh.dim_product' is not supported in this version of SQL Server. (40515)")

[0m00:14:55.553745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35667e88-a59b-4a36-9212-495c2cc70566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E56E7BC650>]}
[0m00:14:55.554745 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dwh.dim_product_target ................... [[31mERROR[0m in 1.49s]
[0m00:14:55.557344 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.dim_product_target
[0m00:14:55.561107 [debug] [MainThread]: On master: COMMIT
[0m00:14:55.563091 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:14:55.564092 [debug] [MainThread]: Connection 'list_amazonsalesanalytics' was properly closed.
[0m00:14:55.564092 [debug] [MainThread]: Connection 'list_analytics-raw_dwh' was properly closed.
[0m00:14:55.565089 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.dim_product_target' was properly closed.
[0m00:14:55.566092 [info ] [MainThread]: 
[0m00:14:55.568089 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.54 seconds (4.54s).
[0m00:14:55.570090 [debug] [MainThread]: Command end result
[0m00:14:55.586774 [info ] [MainThread]: 
[0m00:14:55.588316 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:14:55.589725 [info ] [MainThread]: 
[0m00:14:55.591749 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'insert'. (156) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Reference to database and/or server name in 'analytics-raw.dwh.dim_product' is not supported in this version of SQL Server. (40515)")
[0m00:14:55.593531 [info ] [MainThread]: 
[0m00:14:55.596105 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:14:55.617684 [debug] [MainThread]: Command `dbt run` failed at 00:14:55.617684 after 7.15 seconds
[0m00:14:55.618894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E56BB85190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E56E6D4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5663FAC90>]}
[0m00:14:55.619893 [debug] [MainThread]: Flushing usage events
[0m00:14:56.550432 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m00:16:05.665312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB07BCA590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB07C1FA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB06FDE690>]}


============================== 00:16:05.675639 | 259ac945-73d3-4d5f-be91-7ad464944760 ==============================
[0m00:16:05.675639 [info ] [MainThread]: Running with dbt=1.7.16
[0m00:16:05.677641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --target target --models target.dim_product_target', 'send_anonymous_usage_stats': 'True'}
[0m00:16:06.282293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '259ac945-73d3-4d5f-be91-7ad464944760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB08128610>]}
[0m00:16:06.324221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '259ac945-73d3-4d5f-be91-7ad464944760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB081A9AD0>]}
[0m00:16:06.326234 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m00:16:06.341240 [debug] [MainThread]: checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, vars: {}, profile: , target: target, version: 1.7.16
[0m00:16:06.672794 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:16:06.673792 [debug] [MainThread]: Partial parsing: updated file: AmazonSalesAnalytics://macros\insert_into_target.sql
[0m00:16:06.674813 [debug] [MainThread]: Partial parsing: updated file: AmazonSalesAnalytics://models\target\dim_product_target.sql
[0m00:16:06.785075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '259ac945-73d3-4d5f-be91-7ad464944760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB09455F10>]}
[0m00:16:06.812395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '259ac945-73d3-4d5f-be91-7ad464944760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0931A090>]}
[0m00:16:06.813774 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 448 macros, 0 groups, 0 semantic models
[0m00:16:06.816029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '259ac945-73d3-4d5f-be91-7ad464944760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB09477490>]}
[0m00:16:06.818419 [info ] [MainThread]: 
[0m00:16:06.820431 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m00:16:06.822432 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics'
[0m00:16:06.834943 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics"
[0m00:16:06.835944 [debug] [ThreadPool]: On list_amazonsalesanalytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics"} */
select  name as [schema]
    from sys.schemas 
  
[0m00:16:06.836944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:06.837946 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:16:09.261991 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:16:09.494092 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m00:16:09.496096 [debug] [ThreadPool]: On list_amazonsalesanalytics: Close
[0m00:16:09.499093 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics_dwh'
[0m00:16:09.505913 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics_dwh"
[0m00:16:09.506754 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics_dwh"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
  
[0m00:16:09.506754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:09.508247 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:16:09.509135 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:16:09.743043 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m00:16:09.745138 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: ROLLBACK
[0m00:16:09.746255 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: Close
[0m00:16:09.747302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_amazonsalesanalytics_dwh, now list_analytics-raw_dwh)
[0m00:16:09.751386 [debug] [ThreadPool]: Using sqlserver connection "list_analytics-raw_dwh"
[0m00:16:09.752941 [debug] [ThreadPool]: On list_analytics-raw_dwh: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_analytics-raw_dwh"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
  
[0m00:16:09.753941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:09.754971 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:16:09.755968 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:16:09.987988 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m00:16:09.989987 [debug] [ThreadPool]: On list_analytics-raw_dwh: ROLLBACK
[0m00:16:09.990991 [debug] [ThreadPool]: On list_analytics-raw_dwh: Close
[0m00:16:09.994173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '259ac945-73d3-4d5f-be91-7ad464944760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0821B990>]}
[0m00:16:09.995488 [debug] [MainThread]: On master: COMMIT
[0m00:16:09.996719 [info ] [MainThread]: Concurrency: 1 threads (target='target')
[0m00:16:09.997718 [info ] [MainThread]: 
[0m00:16:10.008334 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.dim_product_target
[0m00:16:10.009321 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh.dim_product_target ............................ [RUN]
[0m00:16:10.011324 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.dim_product_target'
[0m00:16:10.012804 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.dim_product_target
[0m00:16:10.020787 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.dim_product_target"
[0m00:16:10.029730 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product_target (compile): 00:16:10.013441 => 00:16:10.028750
[0m00:16:10.032752 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.dim_product_target
[0m00:16:10.085879 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product_target"
[0m00:16:10.087879 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product_target: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product_target"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."dim_product_target__dbt_backup";');

[0m00:16:10.088880 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:16:10.091238 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:16:10.092236 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:16:10.330515 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:16:10.335517 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product_target"
[0m00:16:10.336517 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product_target: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product_target"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
    and table_name like 'dim_product_target'
  
[0m00:16:10.567982 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:16:10.581724 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product_target"
[0m00:16:10.583740 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product_target: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product_target"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_product_target_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m00:16:10.815049 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:16:10.818045 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product_target"
[0m00:16:10.819045 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product_target: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product_target"} */

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_product_target_temp_view";');

  
[0m00:16:11.056572 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:16:11.062386 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product_target"
[0m00:16:11.063385 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product_target: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product_target"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_product_target_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m00:16:11.297346 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:16:11.298385 [debug] [Thread-1 (]: Writing runtime sql for node "model.AmazonSalesAnalytics.dim_product_target"
[0m00:16:11.306348 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product_target"
[0m00:16:11.307348 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product_target: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product_target"} */

  
    

   

    USE [amazonsalesanalytics];
    
    

    EXEC('create view "dwh"."dim_product_target_temp_view" as -- models/target/dim_product.sql


    insert into dwh.dim_product
    select * from "analytics-raw"."dwh"."dim_product"
;');



    
      EXEC('SELECT * INTO [amazonsalesanalytics].[dwh].[dim_product_target] FROM [amazonsalesanalytics].[dwh].[dim_product_target_temp_view];');
    

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_product_target_temp_view";');



  
[0m00:16:11.557527 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:16:11.558527 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product_target (execute): 00:16:10.035211 => 00:16:11.558527
[0m00:16:11.559527 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product_target: ROLLBACK
[0m00:16:11.560535 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product_target: Close
[0m00:16:11.562531 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\AmazonSalesAnalytics\models\target\dim_product_target.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'insert'. (156) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Reference to database and/or server name in 'analytics-raw.dwh.dim_product' is not supported in this version of SQL Server. (40515)")
[0m00:16:11.579761 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\base.py", line 380, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\base.py", line 326, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\base.py", line 427, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 83, in macro
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
          ^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'insert'. (156) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Reference to database and/or server name in 'analytics-raw.dwh.dim_product' is not supported in this version of SQL Server. (40515)")

[0m00:16:11.580775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '259ac945-73d3-4d5f-be91-7ad464944760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB09517850>]}
[0m00:16:11.582777 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dwh.dim_product_target ................... [[31mERROR[0m in 1.57s]
[0m00:16:11.584777 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.dim_product_target
[0m00:16:11.586780 [debug] [MainThread]: On master: COMMIT
[0m00:16:11.589787 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:16:11.591779 [debug] [MainThread]: Connection 'list_amazonsalesanalytics' was properly closed.
[0m00:16:11.592779 [debug] [MainThread]: Connection 'list_analytics-raw_dwh' was properly closed.
[0m00:16:11.593778 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.dim_product_target' was properly closed.
[0m00:16:11.594778 [info ] [MainThread]: 
[0m00:16:11.596942 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.77 seconds (4.77s).
[0m00:16:11.598833 [debug] [MainThread]: Command end result
[0m00:16:11.615215 [info ] [MainThread]: 
[0m00:16:11.616732 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:16:11.619728 [info ] [MainThread]: 
[0m00:16:11.620765 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'insert'. (156) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Reference to database and/or server name in 'analytics-raw.dwh.dim_product' is not supported in this version of SQL Server. (40515)")
[0m00:16:11.623220 [info ] [MainThread]: 
[0m00:16:11.625220 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:16:11.648241 [debug] [MainThread]: Command `dbt run` failed at 00:16:11.648241 after 6.58 seconds
[0m00:16:11.649241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0113ABD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0113A950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0933A5D0>]}
[0m00:16:11.651538 [debug] [MainThread]: Flushing usage events
[0m00:16:11.779681 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m00:16:55.868953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2B142A110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2B142BF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2AFD10410>]}


============================== 00:16:55.880633 | f2298ab7-bcdf-43f3-b2a6-92d40f096a15 ==============================
[0m00:16:55.880633 [info ] [MainThread]: Running with dbt=1.7.16
[0m00:16:55.882134 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --target dev --models source.dim_product', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:16:56.463730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2298ab7-bcdf-43f3-b2a6-92d40f096a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2B1A1ED90>]}
[0m00:16:56.505560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2298ab7-bcdf-43f3-b2a6-92d40f096a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2B1A2BF10>]}
[0m00:16:56.507569 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m00:16:56.522160 [debug] [MainThread]: checksum: 02e0ce1b37a1d9c044ec1754ab0cae12786a84ff6628f863172b7bd46a89f9f2, vars: {}, profile: , target: dev, version: 1.7.16
[0m00:16:56.533603 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:16:56.535562 [debug] [MainThread]: previous checksum: 02e0ce1b37a1d9c044ec1754ab0cae12786a84ff6628f863172b7bd46a89f9f2, current checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11
[0m00:16:56.535562 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:16:56.537549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f2298ab7-bcdf-43f3-b2a6-92d40f096a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2B15A2450>]}
[0m00:16:57.608960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2298ab7-bcdf-43f3-b2a6-92d40f096a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2B1A34B50>]}
[0m00:16:57.636129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2298ab7-bcdf-43f3-b2a6-92d40f096a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2B2D0D1D0>]}
[0m00:16:57.637988 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 448 macros, 0 groups, 0 semantic models
[0m00:16:57.640191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2298ab7-bcdf-43f3-b2a6-92d40f096a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2B2CF8950>]}
[0m00:16:57.642189 [info ] [MainThread]: 
[0m00:16:57.643191 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m00:16:57.645191 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_analytics-raw'
[0m00:16:57.657192 [debug] [ThreadPool]: Using sqlserver connection "list_analytics-raw"
[0m00:16:57.658200 [debug] [ThreadPool]: On list_analytics-raw: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "connection_name": "list_analytics-raw"} */
select  name as [schema]
    from sys.schemas 
  
[0m00:16:57.660196 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:57.661202 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=analytics-raw;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:16:59.990971 [debug] [ThreadPool]: SQLServer adapter: Connected to db: analytics-raw
[0m00:17:00.223561 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m00:17:00.225582 [debug] [ThreadPool]: On list_analytics-raw: Close
[0m00:17:00.228794 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics_dbo'
[0m00:17:00.233826 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics_dbo"
[0m00:17:00.234826 [debug] [ThreadPool]: On list_amazonsalesanalytics_dbo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "connection_name": "list_amazonsalesanalytics_dbo"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbo'
  
[0m00:17:00.236095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:00.237270 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=analytics-raw;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:17:00.237770 [debug] [ThreadPool]: SQLServer adapter: Connected to db: analytics-raw
[0m00:17:00.472649 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m00:17:00.474535 [debug] [ThreadPool]: On list_amazonsalesanalytics_dbo: ROLLBACK
[0m00:17:00.475536 [debug] [ThreadPool]: On list_amazonsalesanalytics_dbo: Close
[0m00:17:00.477358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_amazonsalesanalytics_dbo, now list_analytics-raw_dbo)
[0m00:17:00.480360 [debug] [ThreadPool]: Using sqlserver connection "list_analytics-raw_dbo"
[0m00:17:00.480360 [debug] [ThreadPool]: On list_analytics-raw_dbo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "connection_name": "list_analytics-raw_dbo"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbo'
  
[0m00:17:00.482359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:17:00.482359 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=analytics-raw;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:17:00.483370 [debug] [ThreadPool]: SQLServer adapter: Connected to db: analytics-raw
[0m00:17:00.719463 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m00:17:00.721144 [debug] [ThreadPool]: On list_analytics-raw_dbo: ROLLBACK
[0m00:17:00.722153 [debug] [ThreadPool]: On list_analytics-raw_dbo: Close
[0m00:17:00.724147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2298ab7-bcdf-43f3-b2a6-92d40f096a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2B1462210>]}
[0m00:17:00.724887 [debug] [MainThread]: On master: COMMIT
[0m00:17:00.725914 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:17:00.727913 [info ] [MainThread]: 
[0m00:17:00.740039 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.dim_product
[0m00:17:00.742029 [info ] [Thread-1 (]: 1 of 1 START sql view model dbo.dim_product .................................... [RUN]
[0m00:17:00.743027 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.dim_product'
[0m00:17:00.744026 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.dim_product
[0m00:17:00.755888 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.dim_product"
[0m00:17:00.764145 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (compile): 00:17:00.745030 => 00:17:00.764145
[0m00:17:00.766144 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.dim_product
[0m00:17:00.799101 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:17:00.800101 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      USE [analytics-raw];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'analytics-raw'
      and refs.referenced_schema_name = 'dbo'
      and refs.referenced_entity_name = 'dim_product__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m00:17:00.801103 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:17:00.802756 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=analytics-raw;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:17:00.804272 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: analytics-raw
[0m00:17:01.039321 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:17:01.041192 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:17:01.042192 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      
      
    
    USE [analytics-raw];
    EXEC('DROP view IF EXISTS "dbo"."dim_product__dbt_backup";');

[0m00:17:01.276060 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:17:01.280063 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:17:01.281068 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "node_id": "model.AmazonSalesAnalytics.dim_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbo'
    and table_name like 'dim_product'
  
[0m00:17:01.514947 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:17:01.521071 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:17:01.522072 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "node_id": "model.AmazonSalesAnalytics.dim_product"} */
USE [analytics-raw];
      EXEC sp_rename 'dbo.dim_product', 'dim_product__dbt_backup'
[0m00:17:01.799526 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:17:01.807880 [debug] [Thread-1 (]: Writing runtime sql for node "model.AmazonSalesAnalytics.dim_product"
[0m00:17:01.816371 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:17:01.817395 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "node_id": "model.AmazonSalesAnalytics.dim_product"} */
USE [analytics-raw];
    
    

    EXEC('create view "dbo"."dim_product" as with cte_product as 
        (
        SELECT
            distinct 
            Category,
            SIZE,
            SKU,
            Style,
            ASIN
        from "analytics-raw"."dbo"."raw_data"
    )

select Category,
        SIZE,
        SKU,
        Style,
        ASIN
    from cte_product;');



[0m00:17:02.062037 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:17:02.080635 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: COMMIT
[0m00:17:02.083635 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:17:02.084647 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      USE [analytics-raw];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'analytics-raw'
      and refs.referenced_schema_name = 'dbo'
      and refs.referenced_entity_name = 'dim_product__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m00:17:02.320305 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:17:02.322448 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:17:02.323458 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "dev", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      
      
    
    USE [analytics-raw];
    EXEC('DROP view IF EXISTS "dbo"."dim_product__dbt_backup";');

[0m00:17:02.562095 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:17:02.564096 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (execute): 00:17:00.767144 => 00:17:02.564096
[0m00:17:02.565096 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: ROLLBACK
[0m00:17:02.566102 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: Close
[0m00:17:02.568099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2298ab7-bcdf-43f3-b2a6-92d40f096a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2B2DD4910>]}
[0m00:17:02.569098 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbo.dim_product ............................... [[32mOK[0m in 1.82s]
[0m00:17:02.570099 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.dim_product
[0m00:17:02.573075 [debug] [MainThread]: On master: COMMIT
[0m00:17:02.574110 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:17:02.575096 [debug] [MainThread]: Connection 'list_analytics-raw' was properly closed.
[0m00:17:02.576089 [debug] [MainThread]: Connection 'list_analytics-raw_dbo' was properly closed.
[0m00:17:02.577088 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.dim_product' was properly closed.
[0m00:17:02.578089 [info ] [MainThread]: 
[0m00:17:02.579089 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.93 seconds (4.93s).
[0m00:17:02.581092 [debug] [MainThread]: Command end result
[0m00:17:02.597822 [info ] [MainThread]: 
[0m00:17:02.599824 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:17:02.601825 [info ] [MainThread]: 
[0m00:17:02.604475 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:17:02.629559 [debug] [MainThread]: Command `dbt run` succeeded at 00:17:02.629559 after 7.35 seconds
[0m00:17:02.630563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2B1441350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2AE163010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2AA9AB850>]}
[0m00:17:02.631561 [debug] [MainThread]: Flushing usage events
[0m00:17:02.719179 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m00:17:10.812058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D27E6AFF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D27E154750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D27E154AD0>]}


============================== 00:17:10.825075 | 833dc77c-e624-42ce-a9ad-057ecbd87b22 ==============================
[0m00:17:10.825075 [info ] [MainThread]: Running with dbt=1.7.16
[0m00:17:10.827526 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --target target --models target.dim_product_target', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:17:11.541181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '833dc77c-e624-42ce-a9ad-057ecbd87b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D27E6C73D0>]}
[0m00:17:11.589429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '833dc77c-e624-42ce-a9ad-057ecbd87b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D27EA767D0>]}
[0m00:17:11.590430 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m00:17:11.608824 [debug] [MainThread]: checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, vars: {}, profile: , target: target, version: 1.7.16
[0m00:17:11.626780 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:17:11.628783 [debug] [MainThread]: previous checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, current checksum: 02e0ce1b37a1d9c044ec1754ab0cae12786a84ff6628f863172b7bd46a89f9f2
[0m00:17:11.630783 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:17:11.631787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '833dc77c-e624-42ce-a9ad-057ecbd87b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D27FDD0ED0>]}
[0m00:17:12.892953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '833dc77c-e624-42ce-a9ad-057ecbd87b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D27EB9E490>]}
[0m00:17:12.923627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '833dc77c-e624-42ce-a9ad-057ecbd87b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D27FF3FC10>]}
[0m00:17:12.924626 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 448 macros, 0 groups, 0 semantic models
[0m00:17:12.926693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '833dc77c-e624-42ce-a9ad-057ecbd87b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D27FF4E5D0>]}
[0m00:17:12.928590 [info ] [MainThread]: 
[0m00:17:12.930777 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m00:17:12.932829 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics'
[0m00:17:12.946048 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics"
[0m00:17:12.947048 [debug] [ThreadPool]: On list_amazonsalesanalytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics"} */
select  name as [schema]
    from sys.schemas 
  
[0m00:17:12.948061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:12.949013 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:17:15.307140 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:17:15.535710 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m00:17:15.537521 [debug] [ThreadPool]: On list_amazonsalesanalytics: Close
[0m00:17:15.539530 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics_dwh'
[0m00:17:15.544532 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics_dwh"
[0m00:17:15.545532 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics_dwh"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
  
[0m00:17:15.546537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:15.547532 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:17:15.548929 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:17:15.780359 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m00:17:15.783467 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: ROLLBACK
[0m00:17:15.784466 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: Close
[0m00:17:15.786470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_amazonsalesanalytics_dwh, now list_analytics-raw_dwh)
[0m00:17:15.790467 [debug] [ThreadPool]: Using sqlserver connection "list_analytics-raw_dwh"
[0m00:17:15.791466 [debug] [ThreadPool]: On list_analytics-raw_dwh: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_analytics-raw_dwh"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
  
[0m00:17:15.792470 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:17:15.793472 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:17:15.794470 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:17:16.026904 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m00:17:16.029905 [debug] [ThreadPool]: On list_analytics-raw_dwh: ROLLBACK
[0m00:17:16.031903 [debug] [ThreadPool]: On list_analytics-raw_dwh: Close
[0m00:17:16.036655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '833dc77c-e624-42ce-a9ad-057ecbd87b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D27FF69BD0>]}
[0m00:17:16.037547 [debug] [MainThread]: On master: COMMIT
[0m00:17:16.038607 [info ] [MainThread]: Concurrency: 1 threads (target='target')
[0m00:17:16.040583 [info ] [MainThread]: 
[0m00:17:16.051325 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.dim_product_target
[0m00:17:16.053309 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh.dim_product_target ............................ [RUN]
[0m00:17:16.055795 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.dim_product_target'
[0m00:17:16.056807 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.dim_product_target
[0m00:17:16.069473 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.dim_product_target"
[0m00:17:16.087515 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product_target (compile): 00:17:16.058827 => 00:17:16.086517
[0m00:17:16.089516 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.dim_product_target
[0m00:17:16.125210 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product_target"
[0m00:17:16.127069 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product_target: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product_target"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."dim_product_target__dbt_backup";');

[0m00:17:16.128070 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:17:16.129072 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:17:16.130106 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:17:16.359331 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:17:16.362384 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product_target"
[0m00:17:16.364294 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product_target: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product_target"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
    and table_name like 'dim_product_target'
  
[0m00:17:16.593268 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:17:16.609402 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product_target"
[0m00:17:16.611350 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product_target: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product_target"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_product_target_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m00:17:16.840418 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:17:16.844377 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product_target"
[0m00:17:16.846383 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product_target: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product_target"} */

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_product_target_temp_view";');

  
[0m00:17:17.075768 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:17:17.081974 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product_target"
[0m00:17:17.083974 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product_target: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product_target"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_product_target_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m00:17:17.313407 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:17:17.316407 [debug] [Thread-1 (]: Writing runtime sql for node "model.AmazonSalesAnalytics.dim_product_target"
[0m00:17:17.322975 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product_target"
[0m00:17:17.325028 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product_target: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product_target"} */

  
    

   

    USE [amazonsalesanalytics];
    
    

    EXEC('create view "dwh"."dim_product_target_temp_view" as -- models/target/dim_product.sql


    insert into dwh.dim_product
    select * from "analytics-raw"."dwh"."dim_product"
;');



    
      EXEC('SELECT * INTO [amazonsalesanalytics].[dwh].[dim_product_target] FROM [amazonsalesanalytics].[dwh].[dim_product_target_temp_view];');
    

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_product_target_temp_view";');



  
[0m00:17:17.569705 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:17:17.570708 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product_target (execute): 00:17:16.090516 => 00:17:17.570708
[0m00:17:17.571624 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product_target: ROLLBACK
[0m00:17:17.572657 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product_target: Close
[0m00:17:17.573629 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\AmazonSalesAnalytics\models\target\dim_product_target.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'insert'. (156) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Reference to database and/or server name in 'analytics-raw.dwh.dim_product' is not supported in this version of SQL Server. (40515)")
[0m00:17:17.591686 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\base.py", line 380, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\base.py", line 326, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\base.py", line 427, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 83, in macro
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
          ^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'insert'. (156) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Reference to database and/or server name in 'analytics-raw.dwh.dim_product' is not supported in this version of SQL Server. (40515)")

[0m00:17:17.592650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '833dc77c-e624-42ce-a9ad-057ecbd87b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D20006F090>]}
[0m00:17:17.594864 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dwh.dim_product_target ................... [[31mERROR[0m in 1.54s]
[0m00:17:17.597091 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.dim_product_target
[0m00:17:17.600128 [debug] [MainThread]: On master: COMMIT
[0m00:17:17.602524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:17:17.604463 [debug] [MainThread]: Connection 'list_amazonsalesanalytics' was properly closed.
[0m00:17:17.605462 [debug] [MainThread]: Connection 'list_analytics-raw_dwh' was properly closed.
[0m00:17:17.606462 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.dim_product_target' was properly closed.
[0m00:17:17.607462 [info ] [MainThread]: 
[0m00:17:17.609463 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.68 seconds (4.68s).
[0m00:17:17.610596 [debug] [MainThread]: Command end result
[0m00:17:17.626605 [info ] [MainThread]: 
[0m00:17:17.628690 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:17:17.629607 [info ] [MainThread]: 
[0m00:17:17.631388 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'insert'. (156) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Reference to database and/or server name in 'analytics-raw.dwh.dim_product' is not supported in this version of SQL Server. (40515)")
[0m00:17:17.633094 [info ] [MainThread]: 
[0m00:17:17.634744 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:17:17.658148 [debug] [MainThread]: Command `dbt run` failed at 00:17:17.658148 after 7.61 seconds
[0m00:17:17.660180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D27E68D790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D27EC26490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D277BEABD0>]}
[0m00:17:17.661187 [debug] [MainThread]: Flushing usage events
[0m00:17:18.603133 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m00:34:08.177996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178EC783AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178EBB71450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178EC776490>]}


============================== 00:34:08.189335 | 88ff7bfa-a9e4-4517-aae6-ffc27b6b16e9 ==============================
[0m00:34:08.189335 [info ] [MainThread]: Running with dbt=1.7.16
[0m00:34:08.190337 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --target target --models dim_product', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:34:08.774634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88ff7bfa-a9e4-4517-aae6-ffc27b6b16e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178EC79F490>]}
[0m00:34:08.820433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88ff7bfa-a9e4-4517-aae6-ffc27b6b16e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178EC762A90>]}
[0m00:34:08.821437 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m00:34:08.841059 [debug] [MainThread]: checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, vars: {}, profile: , target: target, version: 1.7.16
[0m00:34:09.187724 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m00:34:09.188721 [debug] [MainThread]: Partial parsing: deleted file: AmazonSalesAnalytics://models\target\dim_product_target.sql
[0m00:34:09.189738 [debug] [MainThread]: Partial parsing: updated file: AmazonSalesAnalytics://models\source\dim_product.sql
[0m00:34:09.292494 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.AmazonSalesAnalytics.target
[0m00:34:09.298990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88ff7bfa-a9e4-4517-aae6-ffc27b6b16e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178EE050050>]}
[0m00:34:09.325285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88ff7bfa-a9e4-4517-aae6-ffc27b6b16e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178EE0762D0>]}
[0m00:34:09.327977 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 448 macros, 0 groups, 0 semantic models
[0m00:34:09.329950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88ff7bfa-a9e4-4517-aae6-ffc27b6b16e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178E8BA6810>]}
[0m00:34:09.332963 [info ] [MainThread]: 
[0m00:34:09.334962 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m00:34:09.336967 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_analytics-raw'
[0m00:34:09.348677 [debug] [ThreadPool]: Using sqlserver connection "list_analytics-raw"
[0m00:34:09.350677 [debug] [ThreadPool]: On list_analytics-raw: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_analytics-raw"} */
select  name as [schema]
    from sys.schemas 
  
[0m00:34:09.352848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:34:09.353863 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:34:11.629807 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:34:11.853191 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m00:34:11.855629 [debug] [ThreadPool]: On list_analytics-raw: Close
[0m00:34:11.858542 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_analytics-raw_dwh'
[0m00:34:11.865093 [debug] [ThreadPool]: Using sqlserver connection "list_analytics-raw_dwh"
[0m00:34:11.867095 [debug] [ThreadPool]: On list_analytics-raw_dwh: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_analytics-raw_dwh"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
  
[0m00:34:11.868077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:34:11.869080 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:34:11.870078 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:34:12.098000 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m00:34:12.100003 [debug] [ThreadPool]: On list_analytics-raw_dwh: ROLLBACK
[0m00:34:12.101003 [debug] [ThreadPool]: On list_analytics-raw_dwh: Close
[0m00:34:12.104004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88ff7bfa-a9e4-4517-aae6-ffc27b6b16e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178EDEA99D0>]}
[0m00:34:12.105003 [debug] [MainThread]: On master: COMMIT
[0m00:34:12.106127 [info ] [MainThread]: Concurrency: 1 threads (target='target')
[0m00:34:12.108300 [info ] [MainThread]: 
[0m00:34:12.119811 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.dim_product
[0m00:34:12.120744 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics-raw.dwh.dim_product ...................... [RUN]
[0m00:34:12.123164 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.dim_product'
[0m00:34:12.124162 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.dim_product
[0m00:34:12.132769 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.dim_product"
[0m00:34:12.141298 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (compile): 00:34:12.125162 => 00:34:12.140295
[0m00:34:12.142291 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.dim_product
[0m00:34:12.174906 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:34:12.177172 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      USE [analytics-raw];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'analytics-raw'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_product__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m00:34:12.179127 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:34:12.180532 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:34:12.181529 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:34:12.403284 [debug] [Thread-1 (]: fabric adapter: Database error: ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]USE statement is not supported to switch between databases. Use a new connection to connect to a different database. (40508) (SQLExecDirectW)')
[0m00:34:12.404268 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: ROLLBACK
[0m00:34:12.405293 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: Close
[0m00:34:12.406186 [debug] [Thread-1 (]: fabric adapter: Error running SQL: macro drop_relation
[0m00:34:12.407236 [debug] [Thread-1 (]: fabric adapter: Rolling back transaction.
[0m00:34:12.408187 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (execute): 00:34:12.143726 => 00:34:12.408187
[0m00:34:12.430497 [debug] [Thread-1 (]: Database Error in model dim_product (models\source\dim_product.sql)
  ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]USE statement is not supported to switch between databases. Use a new connection to connect to a different database. (40508) (SQLExecDirectW)')
[0m00:34:12.430497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88ff7bfa-a9e4-4517-aae6-ffc27b6b16e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178EDFBB110>]}
[0m00:34:12.432600 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics-raw.dwh.dim_product ............. [[31mERROR[0m in 0.31s]
[0m00:34:12.433614 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.dim_product
[0m00:34:12.436612 [debug] [MainThread]: On master: COMMIT
[0m00:34:12.438726 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:34:12.439615 [debug] [MainThread]: Connection 'list_analytics-raw' was properly closed.
[0m00:34:12.440697 [debug] [MainThread]: Connection 'list_analytics-raw_dwh' was properly closed.
[0m00:34:12.441614 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.dim_product' was properly closed.
[0m00:34:12.442614 [info ] [MainThread]: 
[0m00:34:12.444616 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.11 seconds (3.11s).
[0m00:34:12.445617 [debug] [MainThread]: Command end result
[0m00:34:12.459631 [info ] [MainThread]: 
[0m00:34:12.461745 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:34:12.463877 [info ] [MainThread]: 
[0m00:34:12.465398 [error] [MainThread]:   Database Error in model dim_product (models\source\dim_product.sql)
  ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]USE statement is not supported to switch between databases. Use a new connection to connect to a different database. (40508) (SQLExecDirectW)')
[0m00:34:12.466843 [info ] [MainThread]: 
[0m00:34:12.468949 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:34:12.488897 [debug] [MainThread]: Command `dbt run` failed at 00:34:12.488897 after 4.95 seconds
[0m00:34:12.489815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178EC3AE110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178ECD2AF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178E5CAAA90>]}
[0m00:34:12.490907 [debug] [MainThread]: Flushing usage events
[0m00:34:13.423659 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m00:35:02.168224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BE14D3190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BE14EFDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BE14EEF10>]}


============================== 00:35:02.178392 | cd811722-d50b-4a2f-bffb-2e3585632ae0 ==============================
[0m00:35:02.178392 [info ] [MainThread]: Running with dbt=1.7.16
[0m00:35:02.180395 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --target target --models dim_product', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:35:02.793783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd811722-d50b-4a2f-bffb-2e3585632ae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BE1A755D0>]}
[0m00:35:02.835930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd811722-d50b-4a2f-bffb-2e3585632ae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BE14CF610>]}
[0m00:35:02.836931 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m00:35:02.852555 [debug] [MainThread]: checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, vars: {}, profile: , target: target, version: 1.7.16
[0m00:35:02.863542 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:35:02.865138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cd811722-d50b-4a2f-bffb-2e3585632ae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BE0F98490>]}
[0m00:35:03.929044 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.AmazonSalesAnalytics.target
[0m00:35:03.935142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd811722-d50b-4a2f-bffb-2e3585632ae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BE1BC6E10>]}
[0m00:35:03.991432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd811722-d50b-4a2f-bffb-2e3585632ae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BE2DFE6D0>]}
[0m00:35:03.993466 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 448 macros, 0 groups, 0 semantic models
[0m00:35:03.995473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd811722-d50b-4a2f-bffb-2e3585632ae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BE2D14550>]}
[0m00:35:03.998467 [info ] [MainThread]: 
[0m00:35:04.001467 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m00:35:04.004379 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics'
[0m00:35:04.015099 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics"
[0m00:35:04.016003 [debug] [ThreadPool]: On list_amazonsalesanalytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics"} */
select  name as [schema]
    from sys.schemas 
  
[0m00:35:04.017001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:35:04.018000 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:35:06.242442 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:35:06.465253 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m00:35:06.467213 [debug] [ThreadPool]: On list_amazonsalesanalytics: Close
[0m00:35:06.469831 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics_dwh'
[0m00:35:06.476344 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics_dwh"
[0m00:35:06.477839 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics_dwh"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
  
[0m00:35:06.478987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:35:06.479485 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:35:06.480495 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:35:06.704165 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m00:35:06.706111 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: ROLLBACK
[0m00:35:06.707112 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: Close
[0m00:35:06.710110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd811722-d50b-4a2f-bffb-2e3585632ae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BE1B67690>]}
[0m00:35:06.711110 [debug] [MainThread]: On master: COMMIT
[0m00:35:06.712111 [info ] [MainThread]: Concurrency: 1 threads (target='target')
[0m00:35:06.713110 [info ] [MainThread]: 
[0m00:35:06.724945 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.dim_product
[0m00:35:06.726960 [info ] [Thread-1 (]: 1 of 1 START sql view model dwh.dim_product .................................... [RUN]
[0m00:35:06.729959 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.dim_product'
[0m00:35:06.729959 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.dim_product
[0m00:35:06.736978 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.dim_product"
[0m00:35:06.745326 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (compile): 00:35:06.731032 => 00:35:06.744324
[0m00:35:06.747325 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.dim_product
[0m00:35:06.775128 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:35:06.776128 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."dim_product__dbt_backup";');

[0m00:35:06.777128 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:35:06.777128 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:35:06.779131 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:35:07.005783 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:35:07.007770 [debug] [Thread-1 (]: fabric adapter: Database error: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Could not drop object 'dwh.dim_product__dbt_backup' because it is referenced by a FOREIGN KEY constraint. (3726) (SQLMoreResults)")
[0m00:35:07.008772 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: Close
[0m00:35:07.009771 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (execute): 00:35:06.748326 => 00:35:07.009771
[0m00:35:07.035644 [debug] [Thread-1 (]: Database Error in model dim_product (models\source\dim_product.sql)
  ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Could not drop object 'dwh.dim_product__dbt_backup' because it is referenced by a FOREIGN KEY constraint. (3726) (SQLMoreResults)")
[0m00:35:07.037287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd811722-d50b-4a2f-bffb-2e3585632ae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BE1AEA1D0>]}
[0m00:35:07.038920 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dwh.dim_product ........................... [[31mERROR[0m in 0.31s]
[0m00:35:07.040934 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.dim_product
[0m00:35:07.043936 [debug] [MainThread]: On master: COMMIT
[0m00:35:07.044935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:35:07.046739 [debug] [MainThread]: Connection 'list_amazonsalesanalytics' was properly closed.
[0m00:35:07.048007 [debug] [MainThread]: Connection 'list_amazonsalesanalytics_dwh' was properly closed.
[0m00:35:07.049011 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.dim_product' was properly closed.
[0m00:35:07.049505 [info ] [MainThread]: 
[0m00:35:07.051511 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.05 seconds (3.05s).
[0m00:35:07.053511 [debug] [MainThread]: Command end result
[0m00:35:07.069513 [info ] [MainThread]: 
[0m00:35:07.072249 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:35:07.073585 [info ] [MainThread]: 
[0m00:35:07.075113 [error] [MainThread]:   Database Error in model dim_product (models\source\dim_product.sql)
  ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Could not drop object 'dwh.dim_product__dbt_backup' because it is referenced by a FOREIGN KEY constraint. (3726) (SQLMoreResults)")
[0m00:35:07.076113 [info ] [MainThread]: 
[0m00:35:07.077501 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:35:07.104004 [debug] [MainThread]: Command `dbt run` failed at 00:35:07.102735 after 5.59 seconds
[0m00:35:07.105034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BE0F10ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BDA9BAA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BE149A110>]}
[0m00:35:07.107043 [debug] [MainThread]: Flushing usage events
[0m00:35:07.184360 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m00:39:52.216323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002641922FF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264191DE0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264191DD490>]}


============================== 00:39:52.228181 | 0dcb487b-755b-433f-8f6a-d3c4d16836bc ==============================
[0m00:39:52.228181 [info ] [MainThread]: Running with dbt=1.7.16
[0m00:39:52.230172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --target target --models dim_product', 'send_anonymous_usage_stats': 'True'}
[0m00:39:52.835314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0dcb487b-755b-433f-8f6a-d3c4d16836bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264197DBD90>]}
[0m00:39:52.878835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0dcb487b-755b-433f-8f6a-d3c4d16836bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026418CD8510>]}
[0m00:39:52.880845 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m00:39:52.897345 [debug] [MainThread]: checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, vars: {}, profile: , target: target, version: 1.7.16
[0m00:39:53.212367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:39:53.213441 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:39:53.214383 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.AmazonSalesAnalytics.target
[0m00:39:53.220561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0dcb487b-755b-433f-8f6a-d3c4d16836bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026419978D90>]}
[0m00:39:53.250862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0dcb487b-755b-433f-8f6a-d3c4d16836bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002641989A210>]}
[0m00:39:53.254686 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 448 macros, 0 groups, 0 semantic models
[0m00:39:53.256692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0dcb487b-755b-433f-8f6a-d3c4d16836bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026415636810>]}
[0m00:39:53.258699 [info ] [MainThread]: 
[0m00:39:53.259681 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m00:39:53.261681 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics'
[0m00:39:53.272720 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics"
[0m00:39:53.273726 [debug] [ThreadPool]: On list_amazonsalesanalytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics"} */
select  name as [schema]
    from sys.schemas 
  
[0m00:39:53.274726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:39:53.275715 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:39:55.508210 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:39:55.730344 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m00:39:55.733724 [debug] [ThreadPool]: On list_amazonsalesanalytics: Close
[0m00:39:55.736994 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics_dwh'
[0m00:39:55.741907 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics_dwh"
[0m00:39:55.742907 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics_dwh"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
  
[0m00:39:55.743907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:39:55.745305 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:39:55.746874 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:39:55.970737 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m00:39:55.972739 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: ROLLBACK
[0m00:39:55.973749 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: Close
[0m00:39:55.976742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0dcb487b-755b-433f-8f6a-d3c4d16836bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264197AACD0>]}
[0m00:39:55.977739 [debug] [MainThread]: On master: COMMIT
[0m00:39:55.979016 [info ] [MainThread]: Concurrency: 1 threads (target='target')
[0m00:39:55.980050 [info ] [MainThread]: 
[0m00:39:55.992099 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.dim_product
[0m00:39:55.993099 [info ] [Thread-1 (]: 1 of 1 START sql view model dwh.dim_product .................................... [RUN]
[0m00:39:55.995524 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.dim_product'
[0m00:39:55.996524 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.dim_product
[0m00:39:56.006473 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.dim_product"
[0m00:39:56.014174 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (compile): 00:39:55.997524 => 00:39:56.014174
[0m00:39:56.016170 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.dim_product
[0m00:39:56.047474 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:39:56.048386 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."dim_product__dbt_backup";');

[0m00:39:56.049397 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:39:56.051301 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:39:57.282529 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:39:57.512306 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m00:39:57.516466 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:39:57.517490 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
    and table_name like 'dim_product'
  
[0m00:39:57.750084 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:39:57.759717 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:39:57.760717 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */
USE [amazonsalesanalytics];
      EXEC sp_rename 'dwh.dim_product', 'dim_product__dbt_backup'
[0m00:39:58.003834 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:39:58.010828 [debug] [Thread-1 (]: Writing runtime sql for node "model.AmazonSalesAnalytics.dim_product"
[0m00:39:58.018801 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:39:58.020966 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */
USE [amazonsalesanalytics];
    
    

    EXEC('create view "dwh"."dim_product" as with cte_product as 
        (
        SELECT
            distinct 
            SKU,
            Style,
            Category,
            SIZE,
            ASIN
        from RAW.raw_data
    )

INSERT into dwh.dim_product
select * from cte_product;');



[0m00:39:58.250223 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:39:58.252604 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (execute): 00:39:56.016813 => 00:39:58.252604
[0m00:39:58.253609 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: ROLLBACK
[0m00:39:58.254635 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: Close
[0m00:39:58.256607 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\AmazonSalesAnalytics\models\source\dim_product.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'INSERT'. (156) (SQLMoreResults)")
[0m00:39:58.276513 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\base.py", line 380, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\base.py", line 326, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\base.py", line 427, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 86, in macro
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
          ^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'INSERT'. (156) (SQLMoreResults)")

[0m00:39:58.278637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dcb487b-755b-433f-8f6a-d3c4d16836bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026419231450>]}
[0m00:39:58.279667 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dwh.dim_product ........................... [[31mERROR[0m in 2.28s]
[0m00:39:58.281662 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.dim_product
[0m00:39:58.285627 [debug] [MainThread]: On master: COMMIT
[0m00:39:58.287720 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:39:58.288631 [debug] [MainThread]: Connection 'list_amazonsalesanalytics' was properly closed.
[0m00:39:58.289627 [debug] [MainThread]: Connection 'list_amazonsalesanalytics_dwh' was properly closed.
[0m00:39:58.290631 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.dim_product' was properly closed.
[0m00:39:58.291630 [info ] [MainThread]: 
[0m00:39:58.292630 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.03 seconds (5.03s).
[0m00:39:58.295715 [debug] [MainThread]: Command end result
[0m00:39:58.312456 [info ] [MainThread]: 
[0m00:39:58.314461 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:39:58.316612 [info ] [MainThread]: 
[0m00:39:58.318566 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'INSERT'. (156) (SQLMoreResults)")
[0m00:39:58.319592 [info ] [MainThread]: 
[0m00:39:58.321921 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:39:58.346826 [debug] [MainThread]: Command `dbt run` failed at 00:39:58.346826 after 6.82 seconds
[0m00:39:58.347828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026418CD8810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002641271AA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002641981FA50>]}
[0m00:39:58.349489 [debug] [MainThread]: Flushing usage events
[0m00:39:59.254957 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m00:42:01.453020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F49E2ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F3744C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F49FFE10>]}


============================== 00:42:01.463027 | a55737dd-dc03-4021-a255-ef7b54d184ea ==============================
[0m00:42:01.463027 [info ] [MainThread]: Running with dbt=1.7.16
[0m00:42:01.466001 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --target target --models dim_product', 'send_anonymous_usage_stats': 'True'}
[0m00:42:02.041051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a55737dd-dc03-4021-a255-ef7b54d184ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F4A158D0>]}
[0m00:42:02.083492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a55737dd-dc03-4021-a255-ef7b54d184ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F41E8DD0>]}
[0m00:42:02.084519 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m00:42:02.099708 [debug] [MainThread]: checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, vars: {}, profile: , target: target, version: 1.7.16
[0m00:42:02.109713 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:42:02.111612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a55737dd-dc03-4021-a255-ef7b54d184ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F5006350>]}
[0m00:42:03.171185 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.AmazonSalesAnalytics.dim_product
[0m00:42:03.176299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a55737dd-dc03-4021-a255-ef7b54d184ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F6164A90>]}
[0m00:42:03.203976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a55737dd-dc03-4021-a255-ef7b54d184ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F635A6D0>]}
[0m00:42:03.205974 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 448 macros, 0 groups, 0 semantic models
[0m00:42:03.209580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a55737dd-dc03-4021-a255-ef7b54d184ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F5105A50>]}
[0m00:42:03.211583 [info ] [MainThread]: 
[0m00:42:03.215159 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m00:42:03.218684 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics'
[0m00:42:03.228767 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics"
[0m00:42:03.230733 [debug] [ThreadPool]: On list_amazonsalesanalytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics"} */
select  name as [schema]
    from sys.schemas 
  
[0m00:42:03.232103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:42:03.234122 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:42:05.488543 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:42:05.711346 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m00:42:05.713539 [debug] [ThreadPool]: On list_amazonsalesanalytics: Close
[0m00:42:05.717190 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics_dwh'
[0m00:42:05.724189 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics_dwh"
[0m00:42:05.725194 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics_dwh"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
  
[0m00:42:05.726189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:42:05.727189 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:42:05.728189 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:42:05.954352 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m00:42:05.956387 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: ROLLBACK
[0m00:42:05.957445 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: Close
[0m00:42:05.960439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a55737dd-dc03-4021-a255-ef7b54d184ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F6159C90>]}
[0m00:42:05.961353 [debug] [MainThread]: On master: COMMIT
[0m00:42:05.963388 [info ] [MainThread]: Concurrency: 1 threads (target='target')
[0m00:42:05.965049 [info ] [MainThread]: 
[0m00:42:05.977063 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.dim_product
[0m00:42:05.979067 [info ] [Thread-1 (]: 1 of 1 START sql view model dwh.dim_product .................................... [RUN]
[0m00:42:05.982629 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.dim_product'
[0m00:42:05.983642 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.dim_product
[0m00:42:05.991729 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.dim_product"
[0m00:42:06.001606 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (compile): 00:42:05.984728 => 00:42:06.001606
[0m00:42:06.003635 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.dim_product
[0m00:42:06.037025 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:42:06.038024 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_product__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m00:42:06.039034 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:42:06.040027 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:42:06.042397 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:42:06.280295 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:42:06.282544 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:42:06.283521 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_product__dbt_backup";');

[0m00:42:06.547289 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:42:06.549292 [debug] [Thread-1 (]: fabric adapter: Database error: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Cannot use DROP VIEW with 'dwh.dim_product__dbt_backup' because 'dwh.dim_product__dbt_backup' is a table. Use DROP TABLE. (3705) (SQLMoreResults)")
[0m00:42:06.550288 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: ROLLBACK
[0m00:42:06.551369 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: Close
[0m00:42:06.552289 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (execute): 00:42:06.004636 => 00:42:06.552289
[0m00:42:06.576952 [debug] [Thread-1 (]: Database Error in model dim_product (models\source\dim_product.sql)
  ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Cannot use DROP VIEW with 'dwh.dim_product__dbt_backup' because 'dwh.dim_product__dbt_backup' is a table. Use DROP TABLE. (3705) (SQLMoreResults)")
[0m00:42:06.578969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a55737dd-dc03-4021-a255-ef7b54d184ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F50DEE10>]}
[0m00:42:06.579950 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dwh.dim_product ........................... [[31mERROR[0m in 0.60s]
[0m00:42:06.581949 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.dim_product
[0m00:42:06.584949 [debug] [MainThread]: On master: COMMIT
[0m00:42:06.585993 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:42:06.587052 [debug] [MainThread]: Connection 'list_amazonsalesanalytics' was properly closed.
[0m00:42:06.587553 [debug] [MainThread]: Connection 'list_amazonsalesanalytics_dwh' was properly closed.
[0m00:42:06.588567 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.dim_product' was properly closed.
[0m00:42:06.590049 [info ] [MainThread]: 
[0m00:42:06.592025 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.38 seconds (3.38s).
[0m00:42:06.593151 [debug] [MainThread]: Command end result
[0m00:42:06.607912 [info ] [MainThread]: 
[0m00:42:06.609920 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:42:06.611013 [info ] [MainThread]: 
[0m00:42:06.612762 [error] [MainThread]:   Database Error in model dim_product (models\source\dim_product.sql)
  ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Cannot use DROP VIEW with 'dwh.dim_product__dbt_backup' because 'dwh.dim_product__dbt_backup' is a table. Use DROP TABLE. (3705) (SQLMoreResults)")
[0m00:42:06.615806 [info ] [MainThread]: 
[0m00:42:06.616805 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:42:06.636721 [debug] [MainThread]: Command `dbt run` failed at 00:42:06.636721 after 5.87 seconds
[0m00:42:06.638729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F49C1F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F49C0F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206EDECAA90>]}
[0m00:42:06.638729 [debug] [MainThread]: Flushing usage events
[0m00:42:07.560818 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m00:44:33.217009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002009504DB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020094C29D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020094B44750>]}


============================== 00:44:33.227399 | fe7b3788-d2d3-44de-8818-87e3382f032b ==============================
[0m00:44:33.227399 [info ] [MainThread]: Running with dbt=1.7.16
[0m00:44:33.229339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --target target --models dim_product', 'send_anonymous_usage_stats': 'True'}
[0m00:44:33.803951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe7b3788-d2d3-44de-8818-87e3382f032b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200955F3710>]}
[0m00:44:33.846614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe7b3788-d2d3-44de-8818-87e3382f032b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020095625490>]}
[0m00:44:33.848507 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m00:44:33.862518 [debug] [MainThread]: checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, vars: {}, profile: , target: target, version: 1.7.16
[0m00:44:34.178733 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:44:34.179672 [debug] [MainThread]: Partial parsing: updated file: AmazonSalesAnalytics://models\source\dim_product.sql
[0m00:44:34.280726 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.AmazonSalesAnalytics.dim_product
[0m00:44:34.286912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe7b3788-d2d3-44de-8818-87e3382f032b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200956A9E10>]}
[0m00:44:34.314713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe7b3788-d2d3-44de-8818-87e3382f032b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020096982390>]}
[0m00:44:34.316696 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 448 macros, 0 groups, 0 semantic models
[0m00:44:34.318862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe7b3788-d2d3-44de-8818-87e3382f032b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200914A6810>]}
[0m00:44:34.321799 [info ] [MainThread]: 
[0m00:44:34.324791 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m00:44:34.326790 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics'
[0m00:44:34.337886 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics"
[0m00:44:34.338886 [debug] [ThreadPool]: On list_amazonsalesanalytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics"} */
select  name as [schema]
    from sys.schemas 
  
[0m00:44:34.339886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:44:34.340889 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:44:36.674566 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:44:36.907054 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m00:44:36.909991 [debug] [ThreadPool]: On list_amazonsalesanalytics: Close
[0m00:44:36.911990 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics_dwh'
[0m00:44:36.918987 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics_dwh"
[0m00:44:36.920172 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics_dwh"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
  
[0m00:44:36.921188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:44:36.922187 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:44:36.923198 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:44:37.154690 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m00:44:37.156769 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: ROLLBACK
[0m00:44:37.157687 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: Close
[0m00:44:37.160691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe7b3788-d2d3-44de-8818-87e3382f032b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200958EFF10>]}
[0m00:44:37.161690 [debug] [MainThread]: On master: COMMIT
[0m00:44:37.161890 [info ] [MainThread]: Concurrency: 1 threads (target='target')
[0m00:44:37.164017 [info ] [MainThread]: 
[0m00:44:37.177448 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.dim_product
[0m00:44:37.178451 [info ] [Thread-1 (]: 1 of 1 START sql view model dwh.dim_product .................................... [RUN]
[0m00:44:37.180529 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.dim_product'
[0m00:44:37.181529 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.dim_product
[0m00:44:37.190655 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.dim_product"
[0m00:44:37.197556 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (compile): 00:44:37.182453 => 00:44:37.197556
[0m00:44:37.200269 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.dim_product
[0m00:44:37.234141 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:44:37.235722 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_product__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m00:44:37.236738 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:44:37.238717 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:44:37.238717 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:44:37.472195 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:44:37.473114 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:44:37.474114 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_product__dbt_backup";');

[0m00:44:37.713667 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:44:37.717813 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:44:37.718813 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
    and table_name like 'dim_product'
  
[0m00:44:37.948022 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:44:37.955104 [debug] [Thread-1 (]: Writing runtime sql for node "model.AmazonSalesAnalytics.dim_product"
[0m00:44:37.962259 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:44:37.963035 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */
USE [amazonsalesanalytics];
    
    

    EXEC('create view "dwh"."dim_product" as with cte_product as 
        (
        SELECT
            distinct 
            SKU,
            Style,
            Category,
            SIZE,
            ASIN
        from RAW.raw_data
    )

select * from cte_product;');



[0m00:44:38.202085 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:44:38.215145 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: COMMIT
[0m00:44:38.223421 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:44:38.224811 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_product__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m00:44:38.765349 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m00:44:38.767349 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:44:38.768348 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_product__dbt_backup";');

[0m00:44:38.997268 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:44:39.000250 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (execute): 00:44:37.201601 => 00:44:38.999237
[0m00:44:39.000810 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: ROLLBACK
[0m00:44:39.001836 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: Close
[0m00:44:39.002836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe7b3788-d2d3-44de-8818-87e3382f032b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200956F0C90>]}
[0m00:44:39.004873 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dwh.dim_product ............................... [[32mOK[0m in 1.82s]
[0m00:44:39.007109 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.dim_product
[0m00:44:39.009132 [debug] [MainThread]: On master: COMMIT
[0m00:44:39.010132 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:44:39.011171 [debug] [MainThread]: Connection 'list_amazonsalesanalytics' was properly closed.
[0m00:44:39.011171 [debug] [MainThread]: Connection 'list_amazonsalesanalytics_dwh' was properly closed.
[0m00:44:39.012211 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.dim_product' was properly closed.
[0m00:44:39.013212 [info ] [MainThread]: 
[0m00:44:39.015171 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.69 seconds (4.69s).
[0m00:44:39.017588 [debug] [MainThread]: Command end result
[0m00:44:39.032857 [info ] [MainThread]: 
[0m00:44:39.033868 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:44:39.035439 [info ] [MainThread]: 
[0m00:44:39.037766 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:44:39.062615 [debug] [MainThread]: Command `dbt run` succeeded at 00:44:39.062615 after 6.46 seconds
[0m00:44:39.063592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002008E5CAA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002008E5CAD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020093D11990>]}
[0m00:44:39.064592 [debug] [MainThread]: Flushing usage events
[0m00:44:39.975551 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m00:46:50.606103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002309261B110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230922514D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002309261A050>]}


============================== 00:46:50.616106 | cdc69d6c-3636-49db-9781-83fb665a81f1 ==============================
[0m00:46:50.616106 [info ] [MainThread]: Running with dbt=1.7.16
[0m00:46:50.618112 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --target target --models dim_product_target', 'send_anonymous_usage_stats': 'True'}
[0m00:46:51.197058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdc69d6c-3636-49db-9781-83fb665a81f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023092685350>]}
[0m00:46:51.239079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdc69d6c-3636-49db-9781-83fb665a81f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023092BF5DD0>]}
[0m00:46:51.241001 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m00:46:51.256082 [debug] [MainThread]: checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, vars: {}, profile: , target: target, version: 1.7.16
[0m00:46:51.583474 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:46:51.583474 [debug] [MainThread]: Partial parsing: added file: AmazonSalesAnalytics://models\source\dim_product_target.sql
[0m00:46:51.689957 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.AmazonSalesAnalytics.dim_product
[0m00:46:51.695952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdc69d6c-3636-49db-9781-83fb665a81f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023092E69FD0>]}
[0m00:46:51.727756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdc69d6c-3636-49db-9781-83fb665a81f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023092D6E250>]}
[0m00:46:51.730816 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 448 macros, 0 groups, 0 semantic models
[0m00:46:51.732817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdc69d6c-3636-49db-9781-83fb665a81f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023092BC42D0>]}
[0m00:46:51.734898 [info ] [MainThread]: 
[0m00:46:51.737429 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m00:46:51.739411 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics'
[0m00:46:51.748734 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics"
[0m00:46:51.750735 [debug] [ThreadPool]: On list_amazonsalesanalytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics"} */
select  name as [schema]
    from sys.schemas 
  
[0m00:46:51.751727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:46:51.752308 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:46:53.993138 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:46:54.213486 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m00:46:54.215778 [debug] [ThreadPool]: On list_amazonsalesanalytics: Close
[0m00:46:54.218815 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics_dwh'
[0m00:46:54.226724 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics_dwh"
[0m00:46:54.227756 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics_dwh"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
  
[0m00:46:54.228877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:46:54.229882 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:46:54.230877 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:46:54.453891 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m00:46:54.454910 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: ROLLBACK
[0m00:46:54.456837 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: Close
[0m00:46:54.459514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdc69d6c-3636-49db-9781-83fb665a81f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023092BA66D0>]}
[0m00:46:54.461058 [debug] [MainThread]: On master: COMMIT
[0m00:46:54.462095 [info ] [MainThread]: Concurrency: 1 threads (target='target')
[0m00:46:54.463057 [info ] [MainThread]: 
[0m00:46:54.473062 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.dim_product_target
[0m00:46:54.475063 [info ] [Thread-1 (]: 1 of 1 START sql view model dwh.dim_product_target ............................. [RUN]
[0m00:46:54.476646 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.dim_product_target'
[0m00:46:54.477704 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.dim_product_target
[0m00:46:54.484984 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.dim_product_target"
[0m00:46:54.492895 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product_target (compile): 00:46:54.478698 => 00:46:54.491999
[0m00:46:54.493894 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.dim_product_target
[0m00:46:54.523460 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product_target"
[0m00:46:54.524418 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product_target: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product_target"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_product_target__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m00:46:54.526206 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:46:54.526206 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:46:55.768420 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:46:56.013646 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m00:46:56.015649 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product_target"
[0m00:46:56.016651 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product_target: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product_target"} */

      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_product_target__dbt_backup";');

[0m00:46:56.251994 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:46:56.254839 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product_target"
[0m00:46:56.256845 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product_target: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product_target"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
    and table_name like 'dim_product_target'
  
[0m00:46:56.487470 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:46:56.494474 [debug] [Thread-1 (]: Writing runtime sql for node "model.AmazonSalesAnalytics.dim_product_target"
[0m00:46:56.501473 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product_target"
[0m00:46:56.503545 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product_target: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product_target"} */
USE [amazonsalesanalytics];
    
    

    EXEC('create view "dwh"."dim_product_target" as -- models/target/dim_product_target.sql



insert into amazonsalesanalytics.dwh.dim_product
select * from "amazonsalesanalytics"."dwh"."dim_product";');



[0m00:46:56.732161 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:46:56.733160 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product_target (execute): 00:46:54.495908 => 00:46:56.733160
[0m00:46:56.734159 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product_target: ROLLBACK
[0m00:46:56.735160 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product_target: Close
[0m00:46:56.737243 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\AmazonSalesAnalytics\models\source\dim_product_target.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'insert'. (156) (SQLMoreResults)")
[0m00:46:56.751876 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\base.py", line 380, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\base.py", line 326, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\base.py", line 427, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 86, in macro
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
          ^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'insert'. (156) (SQLMoreResults)")

[0m00:46:56.753954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdc69d6c-3636-49db-9781-83fb665a81f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023093F3FC90>]}
[0m00:46:56.754954 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dwh.dim_product_target .................... [[31mERROR[0m in 2.28s]
[0m00:46:56.757967 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.dim_product_target
[0m00:46:56.760282 [debug] [MainThread]: On master: COMMIT
[0m00:46:56.762282 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:46:56.764283 [debug] [MainThread]: Connection 'list_amazonsalesanalytics' was properly closed.
[0m00:46:56.766317 [debug] [MainThread]: Connection 'list_amazonsalesanalytics_dwh' was properly closed.
[0m00:46:56.767284 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.dim_product_target' was properly closed.
[0m00:46:56.768280 [info ] [MainThread]: 
[0m00:46:56.769882 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.03 seconds (5.03s).
[0m00:46:56.771892 [debug] [MainThread]: Command end result
[0m00:46:56.786597 [info ] [MainThread]: 
[0m00:46:56.787864 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:46:56.788878 [info ] [MainThread]: 
[0m00:46:56.790862 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'insert'. (156) (SQLMoreResults)")
[0m00:46:56.792485 [info ] [MainThread]: 
[0m00:46:56.794309 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:46:56.817053 [debug] [MainThread]: Command `dbt run` failed at 00:46:56.817053 after 6.83 seconds
[0m00:46:56.818063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002309266F690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002308BBBA950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023092C7A5D0>]}
[0m00:46:56.820052 [debug] [MainThread]: Flushing usage events
[0m00:46:57.708934 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m00:56:01.903102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F72DD550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F6DC4750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F72DCC50>]}


============================== 00:56:01.915455 | 99a4bdb6-d93a-404d-85c0-4fd20d56f978 ==============================
[0m00:56:01.915455 [info ] [MainThread]: Running with dbt=1.7.16
[0m00:56:01.917418 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --target target --models dim_product', 'send_anonymous_usage_stats': 'True'}
[0m00:56:02.619372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99a4bdb6-d93a-404d-85c0-4fd20d56f978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F7881010>]}
[0m00:56:02.669006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99a4bdb6-d93a-404d-85c0-4fd20d56f978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F72F4950>]}
[0m00:56:02.670980 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m00:56:02.687733 [debug] [MainThread]: checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, vars: {}, profile: , target: target, version: 1.7.16
[0m00:56:02.700819 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:56:02.703159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '99a4bdb6-d93a-404d-85c0-4fd20d56f978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F8A50390>]}
[0m00:56:04.001431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99a4bdb6-d93a-404d-85c0-4fd20d56f978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F79F6E10>]}
[0m00:56:04.057289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99a4bdb6-d93a-404d-85c0-4fd20d56f978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F8C38990>]}
[0m00:56:04.059380 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 448 macros, 0 groups, 0 semantic models
[0m00:56:04.061287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99a4bdb6-d93a-404d-85c0-4fd20d56f978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F3726810>]}
[0m00:56:04.062287 [info ] [MainThread]: 
[0m00:56:04.065371 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m00:56:04.067285 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics'
[0m00:56:04.077968 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics"
[0m00:56:04.101454 [debug] [ThreadPool]: On list_amazonsalesanalytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics"} */
select  name as [schema]
    from sys.schemas 
  
[0m00:56:04.102463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:56:04.103463 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:56:06.436499 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:56:06.669193 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m00:56:06.671195 [debug] [ThreadPool]: On list_amazonsalesanalytics: Close
[0m00:56:06.674195 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics_dwh'
[0m00:56:06.680954 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics_dwh"
[0m00:56:06.682469 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics_dwh"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
  
[0m00:56:06.683467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:56:06.684467 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:56:06.684777 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:56:06.916393 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m00:56:06.918504 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: ROLLBACK
[0m00:56:06.919514 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: Close
[0m00:56:06.921781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99a4bdb6-d93a-404d-85c0-4fd20d56f978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F8B9FAD0>]}
[0m00:56:06.923960 [debug] [MainThread]: On master: COMMIT
[0m00:56:06.925004 [info ] [MainThread]: Concurrency: 1 threads (target='target')
[0m00:56:06.926321 [info ] [MainThread]: 
[0m00:56:06.938976 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.dim_product
[0m00:56:06.939987 [info ] [Thread-1 (]: 1 of 1 START sql view model dwh.dim_product .................................... [RUN]
[0m00:56:06.942723 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.dim_product'
[0m00:56:06.943735 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.dim_product
[0m00:56:06.953448 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.dim_product"
[0m00:56:06.963956 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (compile): 00:56:06.944730 => 00:56:06.962230
[0m00:56:06.965871 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.dim_product
[0m00:56:06.999270 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:56:07.000758 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_product__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m00:56:07.002376 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:56:07.002885 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:56:07.004928 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:56:07.236923 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:56:07.238992 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:56:07.240460 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_product__dbt_backup";');

[0m00:56:07.469019 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:56:07.472103 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:56:07.474109 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
    and table_name like 'dim_product'
  
[0m00:56:07.706397 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:56:07.714037 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:56:07.715687 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */
USE [amazonsalesanalytics];
      EXEC sp_rename 'dwh.dim_product', 'dim_product__dbt_backup'
[0m00:56:07.983343 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:56:07.991171 [debug] [Thread-1 (]: Writing runtime sql for node "model.AmazonSalesAnalytics.dim_product"
[0m00:56:07.999692 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m00:56:08.001424 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */
USE [amazonsalesanalytics];
    
    

    EXEC('create view "dwh"."dim_product" as with cte_product as 
        (
        SELECT
            distinct 
            SKU,
            Style,
            Category,
            SIZE,
            ASIN
        from RAW.raw_data
    )

INSERT into dwh.dim_product
select * from cte_product;');



[0m00:56:08.233479 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m00:56:08.235531 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (execute): 00:56:06.967262 => 00:56:08.235531
[0m00:56:08.236547 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: ROLLBACK
[0m00:56:08.237555 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: Close
[0m00:56:08.239531 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\AmazonSalesAnalytics\models\source\dim_product.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'INSERT'. (156) (SQLMoreResults)")
[0m00:56:08.256180 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\base.py", line 380, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\base.py", line 326, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\base.py", line 427, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 86, in macro
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
          ^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'INSERT'. (156) (SQLMoreResults)")

[0m00:56:08.259196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99a4bdb6-d93a-404d-85c0-4fd20d56f978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F8CCE550>]}
[0m00:56:08.260297 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dwh.dim_product ........................... [[31mERROR[0m in 1.32s]
[0m00:56:08.262226 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.dim_product
[0m00:56:08.265026 [debug] [MainThread]: On master: COMMIT
[0m00:56:08.266578 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:56:08.267596 [debug] [MainThread]: Connection 'list_amazonsalesanalytics' was properly closed.
[0m00:56:08.268603 [debug] [MainThread]: Connection 'list_amazonsalesanalytics_dwh' was properly closed.
[0m00:56:08.269595 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.dim_product' was properly closed.
[0m00:56:08.270597 [info ] [MainThread]: 
[0m00:56:08.272597 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.21 seconds (4.21s).
[0m00:56:08.273599 [debug] [MainThread]: Command end result
[0m00:56:08.292328 [info ] [MainThread]: 
[0m00:56:08.293325 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:56:08.295333 [info ] [MainThread]: 
[0m00:56:08.297424 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'INSERT'. (156) (SQLMoreResults)")
[0m00:56:08.298454 [info ] [MainThread]: 
[0m00:56:08.300456 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:56:08.327490 [debug] [MainThread]: Command `dbt run` failed at 00:56:08.326987 after 7.11 seconds
[0m00:56:08.328505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F732E250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F6EA9FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F6F2E550>]}
[0m00:56:08.329720 [debug] [MainThread]: Flushing usage events
[0m00:56:09.254628 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m00:58:51.847980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C59DF19CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C59DF19B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C59DF19E10>]}


============================== 00:58:51.858992 | 68950172-d1d6-47f9-b0b8-893255c41ddb ==============================
[0m00:58:51.858992 [info ] [MainThread]: Running with dbt=1.7.16
[0m00:58:51.861097 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --target target --models dim_product', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:58:52.462185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68950172-d1d6-47f9-b0b8-893255c41ddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C59DF1D110>]}
[0m00:58:52.505220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68950172-d1d6-47f9-b0b8-893255c41ddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C59D758710>]}
[0m00:58:52.507220 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m00:58:52.525097 [debug] [MainThread]: checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, vars: {}, profile: , target: target, version: 1.7.16
[0m00:58:52.842062 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:58:52.843164 [debug] [MainThread]: Partial parsing: updated file: AmazonSalesAnalytics://models\source\dim_product.sql
[0m00:58:52.951574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68950172-d1d6-47f9-b0b8-893255c41ddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C59F6F3510>]}
[0m00:58:52.975982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68950172-d1d6-47f9-b0b8-893255c41ddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C59F852310>]}
[0m00:58:52.977974 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 448 macros, 0 groups, 0 semantic models
[0m00:58:52.979943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68950172-d1d6-47f9-b0b8-893255c41ddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C59DF70B50>]}
[0m00:58:52.982169 [info ] [MainThread]: 
[0m00:58:52.984134 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m00:58:52.986136 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics'
[0m00:58:52.997439 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics"
[0m00:58:52.998445 [debug] [ThreadPool]: On list_amazonsalesanalytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics"} */
select  name as [schema]
    from sys.schemas 
  
[0m00:58:52.999445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:58:53.000443 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:58:55.256439 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:58:55.486748 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m00:58:55.489225 [debug] [ThreadPool]: On list_amazonsalesanalytics: Close
[0m00:58:55.492226 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics_dwh'
[0m00:58:55.497986 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics_dwh"
[0m00:58:55.498988 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics_dwh"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
  
[0m00:58:55.499985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:58:55.500986 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m00:58:55.501988 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m00:58:55.738302 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m00:58:55.742291 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: ROLLBACK
[0m00:58:55.742943 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: Close
[0m00:58:55.746434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68950172-d1d6-47f9-b0b8-893255c41ddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C59E5258D0>]}
[0m00:58:55.746434 [debug] [MainThread]: On master: COMMIT
[0m00:58:55.748423 [info ] [MainThread]: Concurrency: 1 threads (target='target')
[0m00:58:55.749423 [info ] [MainThread]: 
[0m00:58:55.760264 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.dim_product
[0m00:58:55.761430 [info ] [Thread-1 (]: 1 of 1 START sql Ephemeral model dwh.dim_product ............................... [RUN]
[0m00:58:55.764434 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.dim_product'
[0m00:58:55.765530 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.dim_product
[0m00:58:55.772537 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.dim_product"
[0m00:58:55.782929 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (compile): 00:58:55.766529 => 00:58:55.780362
[0m00:58:55.783429 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.dim_product
[0m00:58:55.786321 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (execute): 00:58:55.784442 => 00:58:55.786321
[0m00:58:55.791323 [debug] [Thread-1 (]: Compilation Error in model dim_product (models\source\dim_product.sql)
  No materialization 'Ephemeral' was found for adapter sqlserver! (searched types 'default' and 'sqlserver')
[0m00:58:55.792323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68950172-d1d6-47f9-b0b8-893255c41ddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C59E67AF10>]}
[0m00:58:55.793935 [error] [Thread-1 (]: 1 of 1 ERROR creating sql Ephemeral model dwh.dim_product ...................... [[31mERROR[0m in 0.03s]
[0m00:58:55.795350 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.dim_product
[0m00:58:55.798763 [debug] [MainThread]: On master: COMMIT
[0m00:58:55.799821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:58:55.800859 [debug] [MainThread]: Connection 'list_amazonsalesanalytics' was properly closed.
[0m00:58:55.801850 [debug] [MainThread]: Connection 'list_amazonsalesanalytics_dwh' was properly closed.
[0m00:58:55.802865 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.dim_product' was properly closed.
[0m00:58:55.803780 [info ] [MainThread]: 
[0m00:58:55.805776 [info ] [MainThread]: Finished running 1 Ephemeral model in 0 hours 0 minutes and 2.82 seconds (2.82s).
[0m00:58:55.807777 [debug] [MainThread]: Command end result
[0m00:58:55.824230 [info ] [MainThread]: 
[0m00:58:55.826442 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:58:55.827967 [info ] [MainThread]: 
[0m00:58:55.828780 [error] [MainThread]:   Compilation Error in model dim_product (models\source\dim_product.sql)
  No materialization 'Ephemeral' was found for adapter sqlserver! (searched types 'default' and 'sqlserver')
[0m00:58:55.830808 [info ] [MainThread]: 
[0m00:58:55.832651 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:58:55.854134 [debug] [MainThread]: Command `dbt run` failed at 00:58:55.853179 after 4.66 seconds
[0m00:58:55.855177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C59748AD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C59748ADD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C59DF85110>]}
[0m00:58:55.856132 [debug] [MainThread]: Flushing usage events
[0m00:58:56.720509 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m01:00:28.470045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D79B6A110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D79B6BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D79B807D0>]}


============================== 01:00:28.479488 | d7411070-3894-425b-9763-e8ece1b2778e ==============================
[0m01:00:28.479488 [info ] [MainThread]: Running with dbt=1.7.16
[0m01:00:28.481403 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --target target --models dim_product', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:00:29.068696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7411070-3894-425b-9763-e8ece1b2778e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D7A02B5D0>]}
[0m01:00:29.119159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7411070-3894-425b-9763-e8ece1b2778e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D79BE4590>]}
[0m01:00:29.120076 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m01:00:29.139658 [debug] [MainThread]: checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, vars: {}, profile: , target: target, version: 1.7.16
[0m01:00:29.453044 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:00:29.453913 [debug] [MainThread]: Partial parsing: updated file: AmazonSalesAnalytics://models\source\dim_product.sql
[0m01:00:29.560991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7411070-3894-425b-9763-e8ece1b2778e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D7B1EA850>]}
[0m01:00:29.585625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7411070-3894-425b-9763-e8ece1b2778e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D7B4A6510>]}
[0m01:00:29.588276 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 448 macros, 0 groups, 0 semantic models
[0m01:00:29.590320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7411070-3894-425b-9763-e8ece1b2778e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D75FC6810>]}
[0m01:00:29.591343 [info ] [MainThread]: 
[0m01:00:29.593370 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m01:00:29.595390 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics'
[0m01:00:29.609456 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics"
[0m01:00:29.610456 [debug] [ThreadPool]: On list_amazonsalesanalytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics"} */
select  name as [schema]
    from sys.schemas 
  
[0m01:00:29.611456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:29.612455 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m01:00:31.831663 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m01:00:32.053521 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m01:00:32.055934 [debug] [ThreadPool]: On list_amazonsalesanalytics: Close
[0m01:00:32.057910 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics_dwh'
[0m01:00:32.062938 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics_dwh"
[0m01:00:32.064937 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics_dwh"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
  
[0m01:00:32.065937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:32.066233 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m01:00:32.068249 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m01:00:32.304864 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:00:32.306768 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: ROLLBACK
[0m01:00:32.307041 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: Close
[0m01:00:32.311580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7411070-3894-425b-9763-e8ece1b2778e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D7B451890>]}
[0m01:00:32.312997 [debug] [MainThread]: On master: COMMIT
[0m01:00:32.314023 [info ] [MainThread]: Concurrency: 1 threads (target='target')
[0m01:00:32.315023 [info ] [MainThread]: 
[0m01:00:32.326520 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.dim_product
[0m01:00:32.327554 [info ] [Thread-1 (]: 1 of 1 START sql Incremental model dwh.dim_product ............................. [RUN]
[0m01:00:32.329518 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.dim_product'
[0m01:00:32.330519 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.dim_product
[0m01:00:32.338927 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.dim_product"
[0m01:00:32.345927 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (compile): 01:00:32.332085 => 01:00:32.345927
[0m01:00:32.347552 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.dim_product
[0m01:00:32.350081 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (execute): 01:00:32.349067 => 01:00:32.350081
[0m01:00:32.357990 [debug] [Thread-1 (]: Compilation Error in model dim_product (models\source\dim_product.sql)
  No materialization 'Incremental' was found for adapter sqlserver! (searched types 'default' and 'sqlserver')
[0m01:00:32.358975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7411070-3894-425b-9763-e8ece1b2778e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D7B403D50>]}
[0m01:00:32.360964 [error] [Thread-1 (]: 1 of 1 ERROR creating sql Incremental model dwh.dim_product .................... [[31mERROR[0m in 0.03s]
[0m01:00:32.362100 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.dim_product
[0m01:00:32.365197 [debug] [MainThread]: On master: COMMIT
[0m01:00:32.366285 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:00:32.367199 [debug] [MainThread]: Connection 'list_amazonsalesanalytics' was properly closed.
[0m01:00:32.368203 [debug] [MainThread]: Connection 'list_amazonsalesanalytics_dwh' was properly closed.
[0m01:00:32.369197 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.dim_product' was properly closed.
[0m01:00:32.371028 [info ] [MainThread]: 
[0m01:00:32.373020 [info ] [MainThread]: Finished running 1 Incremental model in 0 hours 0 minutes and 2.78 seconds (2.78s).
[0m01:00:32.375051 [debug] [MainThread]: Command end result
[0m01:00:32.388263 [info ] [MainThread]: 
[0m01:00:32.389730 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:00:32.391738 [info ] [MainThread]: 
[0m01:00:32.392727 [error] [MainThread]:   Compilation Error in model dim_product (models\source\dim_product.sql)
  No materialization 'Incremental' was found for adapter sqlserver! (searched types 'default' and 'sqlserver')
[0m01:00:32.393816 [info ] [MainThread]: 
[0m01:00:32.396231 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m01:00:32.416828 [debug] [MainThread]: Command `dbt run` failed at 01:00:32.416828 after 4.54 seconds
[0m01:00:32.417827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D797C65D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D797C6650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D730AAA90>]}
[0m01:00:32.419879 [debug] [MainThread]: Flushing usage events
[0m01:00:32.598788 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m01:00:57.641982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CCE0DA290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CCDB51150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CCE0DA250>]}


============================== 01:00:57.652526 | bca4edc3-b870-474b-8cff-40e5da93ffd1 ==============================
[0m01:00:57.652526 [info ] [MainThread]: Running with dbt=1.7.16
[0m01:00:57.654616 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --target target --models dim_product', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:00:58.381375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bca4edc3-b870-474b-8cff-40e5da93ffd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CCE6DB690>]}
[0m01:00:58.428253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bca4edc3-b870-474b-8cff-40e5da93ffd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CCE6B5750>]}
[0m01:00:58.429254 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m01:00:58.450581 [debug] [MainThread]: checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, vars: {}, profile: , target: target, version: 1.7.16
[0m01:00:58.907422 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:00:58.908093 [debug] [MainThread]: Partial parsing: updated file: AmazonSalesAnalytics://models\source\dim_product.sql
[0m01:00:59.019281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bca4edc3-b870-474b-8cff-40e5da93ffd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CCE74E4D0>]}
[0m01:00:59.050131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bca4edc3-b870-474b-8cff-40e5da93ffd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CCFA12590>]}
[0m01:00:59.053229 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 448 macros, 0 groups, 0 semantic models
[0m01:00:59.055317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bca4edc3-b870-474b-8cff-40e5da93ffd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CCE9283D0>]}
[0m01:00:59.058144 [info ] [MainThread]: 
[0m01:00:59.063651 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m01:00:59.078498 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics'
[0m01:00:59.110410 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics"
[0m01:00:59.112541 [debug] [ThreadPool]: On list_amazonsalesanalytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics"} */
select  name as [schema]
    from sys.schemas 
  
[0m01:00:59.114255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:59.114838 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m01:01:01.480154 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m01:01:01.711129 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m01:01:01.713570 [debug] [ThreadPool]: On list_amazonsalesanalytics: Close
[0m01:01:01.715581 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics_dwh'
[0m01:01:01.720654 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics_dwh"
[0m01:01:01.721571 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics_dwh"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
  
[0m01:01:01.722571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:01:01.723573 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m01:01:01.724581 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m01:01:01.961127 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:01:01.963126 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: ROLLBACK
[0m01:01:01.964041 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: Close
[0m01:01:01.966127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bca4edc3-b870-474b-8cff-40e5da93ffd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CCE92B7D0>]}
[0m01:01:01.967041 [debug] [MainThread]: On master: COMMIT
[0m01:01:01.969129 [info ] [MainThread]: Concurrency: 1 threads (target='target')
[0m01:01:01.970067 [info ] [MainThread]: 
[0m01:01:01.981422 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.dim_product
[0m01:01:01.983506 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh.dim_product ................................... [RUN]
[0m01:01:01.986063 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.dim_product'
[0m01:01:01.987402 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.dim_product
[0m01:01:01.999588 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.dim_product"
[0m01:01:02.010982 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (compile): 01:01:01.989245 => 01:01:02.009979
[0m01:01:02.013253 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.dim_product
[0m01:01:02.044720 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m01:01:02.046237 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."dim_product__dbt_backup";');

[0m01:01:02.047344 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:01:02.048692 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m01:01:02.050267 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m01:01:02.321945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:01:02.322945 [debug] [Thread-1 (]: fabric adapter: Database error: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Cannot use DROP TABLE with 'dwh.dim_product__dbt_backup' because 'dwh.dim_product__dbt_backup' is a view. Use DROP VIEW. (3705) (SQLMoreResults)")
[0m01:01:02.324467 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: Close
[0m01:01:02.325501 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (execute): 01:01:02.014702 => 01:01:02.325501
[0m01:01:02.347155 [debug] [Thread-1 (]: Database Error in model dim_product (models\source\dim_product.sql)
  ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Cannot use DROP TABLE with 'dwh.dim_product__dbt_backup' because 'dwh.dim_product__dbt_backup' is a view. Use DROP VIEW. (3705) (SQLMoreResults)")
[0m01:01:02.348239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bca4edc3-b870-474b-8cff-40e5da93ffd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CCFA38D50>]}
[0m01:01:02.349591 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dwh.dim_product .......................... [[31mERROR[0m in 0.36s]
[0m01:01:02.351589 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.dim_product
[0m01:01:02.353590 [debug] [MainThread]: On master: COMMIT
[0m01:01:02.354589 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:01:02.355590 [debug] [MainThread]: Connection 'list_amazonsalesanalytics' was properly closed.
[0m01:01:02.356978 [debug] [MainThread]: Connection 'list_amazonsalesanalytics_dwh' was properly closed.
[0m01:01:02.357954 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.dim_product' was properly closed.
[0m01:01:02.358983 [info ] [MainThread]: 
[0m01:01:02.360964 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.30 seconds (3.30s).
[0m01:01:02.363000 [debug] [MainThread]: Command end result
[0m01:01:02.380814 [info ] [MainThread]: 
[0m01:01:02.383828 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:01:02.384827 [info ] [MainThread]: 
[0m01:01:02.385838 [error] [MainThread]:   Database Error in model dim_product (models\source\dim_product.sql)
  ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Cannot use DROP TABLE with 'dwh.dim_product__dbt_backup' because 'dwh.dim_product__dbt_backup' is a view. Use DROP VIEW. (3705) (SQLMoreResults)")
[0m01:01:02.387832 [info ] [MainThread]: 
[0m01:01:02.388827 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m01:01:02.411080 [debug] [MainThread]: Command `dbt run` failed at 01:01:02.411080 after 5.36 seconds
[0m01:01:02.412093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CCE1311D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CC75FAD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CC75FAA90>]}
[0m01:01:02.414105 [debug] [MainThread]: Flushing usage events
[0m01:01:02.488518 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m01:02:32.372530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C77147F8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C770F14750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C770F14AD0>]}


============================== 01:02:32.383543 | 45e640b0-4c79-44ab-9289-07b78bf471df ==============================
[0m01:02:32.383543 [info ] [MainThread]: Running with dbt=1.7.16
[0m01:02:32.384550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --target target --models dim_product', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:02:32.961237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45e640b0-4c79-44ab-9289-07b78bf471df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C771A0F410>]}
[0m01:02:33.001101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45e640b0-4c79-44ab-9289-07b78bf471df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C77142AFD0>]}
[0m01:02:33.003019 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m01:02:33.020023 [debug] [MainThread]: checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, vars: {}, profile: , target: target, version: 1.7.16
[0m01:02:33.395959 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:02:33.396960 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:02:33.401966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45e640b0-4c79-44ab-9289-07b78bf471df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C77186C290>]}
[0m01:02:33.428811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45e640b0-4c79-44ab-9289-07b78bf471df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C771AEA590>]}
[0m01:02:33.430840 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 448 macros, 0 groups, 0 semantic models
[0m01:02:33.432737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45e640b0-4c79-44ab-9289-07b78bf471df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C76D876810>]}
[0m01:02:33.433733 [info ] [MainThread]: 
[0m01:02:33.435979 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m01:02:33.437644 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics'
[0m01:02:33.446649 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics"
[0m01:02:33.447649 [debug] [ThreadPool]: On list_amazonsalesanalytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics"} */
select  name as [schema]
    from sys.schemas 
  
[0m01:02:33.448651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:33.449746 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m01:02:35.798390 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m01:02:36.030003 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m01:02:36.033128 [debug] [ThreadPool]: On list_amazonsalesanalytics: Close
[0m01:02:36.036625 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics_dwh'
[0m01:02:36.040972 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics_dwh"
[0m01:02:36.041970 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics_dwh"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
  
[0m01:02:36.042982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:36.043970 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m01:02:36.044726 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m01:02:36.275980 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:02:36.278028 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: ROLLBACK
[0m01:02:36.278938 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: Close
[0m01:02:36.280938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45e640b0-4c79-44ab-9289-07b78bf471df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7715A9C90>]}
[0m01:02:36.281939 [debug] [MainThread]: On master: COMMIT
[0m01:02:36.282760 [info ] [MainThread]: Concurrency: 1 threads (target='target')
[0m01:02:36.284819 [info ] [MainThread]: 
[0m01:02:36.294818 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.dim_product
[0m01:02:36.295901 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh.dim_product ................................... [RUN]
[0m01:02:36.297818 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.dim_product'
[0m01:02:36.298823 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.dim_product
[0m01:02:36.309396 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.dim_product"
[0m01:02:36.318890 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (compile): 01:02:36.299820 => 01:02:36.318286
[0m01:02:36.321543 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.dim_product
[0m01:02:36.345154 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m01:02:36.346154 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."dim_product__dbt_backup";');

[0m01:02:36.347154 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:02:36.348155 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m01:02:37.536325 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m01:02:37.759667 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m01:02:37.762703 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m01:02:37.763707 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
    and table_name like 'dim_product'
  
[0m01:02:37.985510 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:02:37.998895 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m01:02:37.999895 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m01:02:38.550725 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m01:02:38.554726 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m01:02:38.555730 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_product_temp_view";');

  
[0m01:02:38.776291 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:02:38.782359 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m01:02:38.784092 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m01:02:39.004957 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:02:39.006957 [debug] [Thread-1 (]: Writing runtime sql for node "model.AmazonSalesAnalytics.dim_product"
[0m01:02:39.014624 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m01:02:39.015736 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

  
    

   

    USE [amazonsalesanalytics];
    
    

    EXEC('create view "dwh"."dim_product_temp_view" as 

with cte_product as 
        (
        SELECT
            distinct 
            SKU,
            Style,
            Category,
            SIZE,
            ASIN
        from RAW.raw_data
    )

--INSERT into dwh.dim_product
select * from cte_product;');



    
      EXEC('SELECT * INTO [amazonsalesanalytics].[dwh].[dim_product] FROM [amazonsalesanalytics].[dwh].[dim_product_temp_view];');
    

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_product_temp_view";');



  
[0m01:02:55.792792 [debug] [Thread-1 (]: SQL status: OK in 17.0 seconds
[0m01:02:55.805788 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: COMMIT
[0m01:02:55.809798 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m01:02:55.810895 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      USE [amazonsalesanalytics];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dwh' and tab2.name = 'dim_product__dbt_backup'
  
[0m01:02:57.262935 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m01:02:57.266930 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m01:02:57.268350 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."dim_product__dbt_backup";');

[0m01:02:57.492111 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:02:57.500230 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (execute): 01:02:36.322539 => 01:02:57.499231
[0m01:02:57.501830 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: ROLLBACK
[0m01:02:57.503904 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: Close
[0m01:02:57.506905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45e640b0-4c79-44ab-9289-07b78bf471df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C772CAC310>]}
[0m01:02:57.509295 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dwh.dim_product .............................. [[32mOK[0m in 21.21s]
[0m01:02:57.512245 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.dim_product
[0m01:02:57.514871 [debug] [MainThread]: On master: COMMIT
[0m01:02:57.516929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:02:57.517930 [debug] [MainThread]: Connection 'list_amazonsalesanalytics' was properly closed.
[0m01:02:57.519116 [debug] [MainThread]: Connection 'list_amazonsalesanalytics_dwh' was properly closed.
[0m01:02:57.520176 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.dim_product' was properly closed.
[0m01:02:57.521191 [info ] [MainThread]: 
[0m01:02:57.522946 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 24.09 seconds (24.09s).
[0m01:02:57.524954 [debug] [MainThread]: Command end result
[0m01:02:57.541075 [info ] [MainThread]: 
[0m01:02:57.544663 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:02:57.546743 [info ] [MainThread]: 
[0m01:02:57.548042 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:02:57.577259 [debug] [MainThread]: Command `dbt run` succeeded at 01:02:57.576610 after 25.92 seconds
[0m01:02:57.581103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C76A9AAA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C76A9AAD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C76A8157D0>]}
[0m01:02:57.582570 [debug] [MainThread]: Flushing usage events
[0m01:02:58.526917 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m01:52:19.687549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5184BB090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5184BBFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E517FB4750>]}


============================== 01:52:19.697464 | e9ccd8d6-b5bc-418c-8ffb-c3763abb3bd9 ==============================
[0m01:52:19.697464 [info ] [MainThread]: Running with dbt=1.7.16
[0m01:52:19.699465 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --target target --models dim_product', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:52:20.303812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9ccd8d6-b5bc-418c-8ffb-c3763abb3bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E518A95F10>]}
[0m01:52:20.348038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9ccd8d6-b5bc-418c-8ffb-c3763abb3bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E518A85BD0>]}
[0m01:52:20.350466 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m01:52:20.367053 [debug] [MainThread]: checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, vars: {}, profile: , target: target, version: 1.7.16
[0m01:52:20.691438 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:52:20.692438 [debug] [MainThread]: Partial parsing: updated file: AmazonSalesAnalytics://models\source\dim_product.sql
[0m01:52:20.797896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9ccd8d6-b5bc-418c-8ffb-c3763abb3bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E518B89CD0>]}
[0m01:52:20.823191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9ccd8d6-b5bc-418c-8ffb-c3763abb3bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E519DF2490>]}
[0m01:52:20.826393 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 448 macros, 0 groups, 0 semantic models
[0m01:52:20.827559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9ccd8d6-b5bc-418c-8ffb-c3763abb3bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E518B603D0>]}
[0m01:52:20.831306 [info ] [MainThread]: 
[0m01:52:20.832318 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m01:52:20.834381 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics'
[0m01:52:20.845183 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics"
[0m01:52:20.847000 [debug] [ThreadPool]: On list_amazonsalesanalytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics"} */
select  name as [schema]
    from sys.schemas 
  
[0m01:52:20.848671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:52:20.850373 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m01:52:23.075690 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m01:52:23.303469 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m01:52:23.305435 [debug] [ThreadPool]: On list_amazonsalesanalytics: Close
[0m01:52:23.307374 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics_dwh'
[0m01:52:23.313067 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics_dwh"
[0m01:52:23.315468 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics_dwh"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
  
[0m01:52:23.316468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:52:23.316816 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m01:52:23.317877 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m01:52:23.546131 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:52:23.547737 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: ROLLBACK
[0m01:52:23.548725 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: Close
[0m01:52:23.551646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9ccd8d6-b5bc-418c-8ffb-c3763abb3bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E518A44B90>]}
[0m01:52:23.552645 [debug] [MainThread]: On master: COMMIT
[0m01:52:23.553646 [info ] [MainThread]: Concurrency: 1 threads (target='target')
[0m01:52:23.555644 [info ] [MainThread]: 
[0m01:52:23.566644 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.dim_product
[0m01:52:23.568644 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh.dim_product ................................... [RUN]
[0m01:52:23.571646 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.dim_product'
[0m01:52:23.572652 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.dim_product
[0m01:52:23.581215 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.dim_product"
[0m01:52:23.588215 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (compile): 01:52:23.573963 => 01:52:23.588215
[0m01:52:23.590076 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.dim_product
[0m01:52:23.613123 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m01:52:23.614122 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."dim_product__dbt_backup";');

[0m01:52:23.616122 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:52:23.617123 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m01:52:23.619126 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m01:52:23.845886 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:52:23.849983 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m01:52:23.850901 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
    and table_name like 'dim_product'
  
[0m01:52:24.088391 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:52:24.095947 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m01:52:24.096948 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */
USE [amazonsalesanalytics];
      EXEC sp_rename 'dwh.dim_product', 'dim_product__dbt_backup'
[0m01:52:24.325962 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:52:24.340912 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m01:52:24.341837 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m01:52:24.890601 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m01:52:24.895147 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m01:52:24.895998 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_product_temp_view";');

  
[0m01:52:25.118878 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:52:25.123876 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m01:52:25.125007 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m01:52:25.346331 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:52:25.348421 [debug] [Thread-1 (]: Writing runtime sql for node "model.AmazonSalesAnalytics.dim_product"
[0m01:52:25.355328 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m01:52:25.356325 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

  
    

   

    USE [amazonsalesanalytics];
    
    

    EXEC('create view "dwh"."dim_product_temp_view" as 

with cte_product as 
        (
        SELECT
            distinct 
            SKU,
            Style,
            Category,
            SIZE,
            ASIN
        from RAW.raw_data
    )

--INSERT into dwh.dim_product
select row_number() over(order by SKU, Style, Category, SIZE, ASIN) as ProductID,
        *
     from cte_product;');



    
      EXEC('SELECT * INTO [amazonsalesanalytics].[dwh].[dim_product] FROM [amazonsalesanalytics].[dwh].[dim_product_temp_view];');
    

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_product_temp_view";');



  
[0m01:52:41.796706 [debug] [Thread-1 (]: SQL status: OK in 16.0 seconds
[0m01:52:41.811409 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: COMMIT
[0m01:52:41.815681 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m01:52:41.816646 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      USE [amazonsalesanalytics];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dwh' and tab2.name = 'dim_product__dbt_backup'
  
[0m01:52:42.036441 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:52:42.044536 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m01:52:42.046442 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."dim_product__dbt_backup";');

[0m01:52:42.278838 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:52:42.288252 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (execute): 01:52:23.591124 => 01:52:42.288252
[0m01:52:42.289446 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: ROLLBACK
[0m01:52:42.290661 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: Close
[0m01:52:42.291668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9ccd8d6-b5bc-418c-8ffb-c3763abb3bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E519DFF410>]}
[0m01:52:42.292668 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dwh.dim_product .............................. [[32mOK[0m in 18.72s]
[0m01:52:42.294987 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.dim_product
[0m01:52:42.297064 [debug] [MainThread]: On master: COMMIT
[0m01:52:42.298136 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:52:42.298136 [debug] [MainThread]: Connection 'list_amazonsalesanalytics' was properly closed.
[0m01:52:42.299187 [debug] [MainThread]: Connection 'list_amazonsalesanalytics_dwh' was properly closed.
[0m01:52:42.300118 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.dim_product' was properly closed.
[0m01:52:42.301114 [info ] [MainThread]: 
[0m01:52:42.302112 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 21.47 seconds (21.47s).
[0m01:52:42.304442 [debug] [MainThread]: Command end result
[0m01:52:42.319804 [info ] [MainThread]: 
[0m01:52:42.321591 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:52:42.324720 [info ] [MainThread]: 
[0m01:52:42.326604 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:52:42.347935 [debug] [MainThread]: Command `dbt run` succeeded at 01:52:42.347935 after 23.31 seconds
[0m01:52:42.348936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E518116810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5170E77D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E517361990>]}
[0m01:52:42.349935 [debug] [MainThread]: Flushing usage events
[0m01:52:43.312712 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m02:01:23.271541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA5676FFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA56214AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA5671D290>]}


============================== 02:01:23.287580 | 6944e91d-aecf-4a44-951a-29e08e5374a9 ==============================
[0m02:01:23.287580 [info ] [MainThread]: Running with dbt=1.7.16
[0m02:01:23.289479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --target target --models dim_locations', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:01:24.054372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6944e91d-aecf-4a44-951a-29e08e5374a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA56731B10>]}
[0m02:01:24.104265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6944e91d-aecf-4a44-951a-29e08e5374a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA56734690>]}
[0m02:01:24.106263 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m02:01:24.133592 [debug] [MainThread]: checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, vars: {}, profile: , target: target, version: 1.7.16
[0m02:01:24.539743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m02:01:24.540665 [debug] [MainThread]: Partial parsing: added file: AmazonSalesAnalytics://models\source\dim_locations.sql
[0m02:01:24.655603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6944e91d-aecf-4a44-951a-29e08e5374a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA56FB2050>]}
[0m02:01:24.689008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6944e91d-aecf-4a44-951a-29e08e5374a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA58052450>]}
[0m02:01:24.693166 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 448 macros, 0 groups, 0 semantic models
[0m02:01:24.694534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6944e91d-aecf-4a44-951a-29e08e5374a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA56F5F690>]}
[0m02:01:24.697494 [info ] [MainThread]: 
[0m02:01:24.699494 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m02:01:24.702293 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics'
[0m02:01:24.712304 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics"
[0m02:01:24.715404 [debug] [ThreadPool]: On list_amazonsalesanalytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics"} */
select  name as [schema]
    from sys.schemas 
  
[0m02:01:24.716392 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:01:24.717954 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m02:01:27.011381 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m02:01:27.234788 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m02:01:27.240785 [debug] [ThreadPool]: On list_amazonsalesanalytics: Close
[0m02:01:27.245845 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics_dwh'
[0m02:01:27.257193 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics_dwh"
[0m02:01:27.259194 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics_dwh"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
  
[0m02:01:27.260193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:01:27.260923 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m02:01:27.262989 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m02:01:27.489277 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:01:27.491831 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: ROLLBACK
[0m02:01:27.494779 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: Close
[0m02:01:27.499717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6944e91d-aecf-4a44-951a-29e08e5374a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA56E728D0>]}
[0m02:01:27.500716 [debug] [MainThread]: On master: COMMIT
[0m02:01:27.502803 [info ] [MainThread]: Concurrency: 1 threads (target='target')
[0m02:01:27.503715 [info ] [MainThread]: 
[0m02:01:27.517747 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.dim_locations
[0m02:01:27.518754 [info ] [Thread-1 (]: 1 of 1 START sql view model dwh.dim_locations .................................. [RUN]
[0m02:01:27.521052 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.dim_locations'
[0m02:01:27.522072 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.dim_locations
[0m02:01:27.530739 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.dim_locations"
[0m02:01:27.541330 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_locations (compile): 02:01:27.523478 => 02:01:27.540328
[0m02:01:27.543087 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.dim_locations
[0m02:01:27.577311 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_locations"
[0m02:01:27.579571 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_locations: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_locations"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_locations__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m02:01:27.580624 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:01:27.581624 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m02:01:27.582653 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m02:01:27.939965 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:01:27.947017 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_locations"
[0m02:01:27.950698 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_locations: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_locations"} */

      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_locations__dbt_backup";');

[0m02:01:28.173307 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:01:28.184382 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_locations"
[0m02:01:28.186377 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_locations: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_locations"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
    and table_name like 'dim_locations'
  
[0m02:01:28.417571 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:01:28.433767 [debug] [Thread-1 (]: Writing runtime sql for node "model.AmazonSalesAnalytics.dim_locations"
[0m02:01:28.447963 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_locations"
[0m02:01:28.450956 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_locations: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_locations"} */
USE [amazonsalesanalytics];
    
    

    EXEC('create view "dwh"."dim_locations" as with dim_locations as (
    SELECT
        DISTINCT
        [ship-city] as ShipCity,
        [ship-state] as ShipState ,
        [ship-country] as ShipCountry ,
        [ship-postal-code] as ShipPostalCode
    from 
        raw.raw_data
    )

select row_number() over(order by ShipCity, ShipState, ShipCountry, ShipPostalCode) as LocationID,
        *
    from dim_locations;');



[0m02:01:28.695787 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:01:28.721294 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_locations: COMMIT
[0m02:01:28.727523 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_locations"
[0m02:01:28.728529 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_locations: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_locations"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_locations__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m02:01:28.952709 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:01:28.956588 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_locations"
[0m02:01:28.958145 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_locations: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_locations"} */

      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_locations__dbt_backup";');

[0m02:01:29.189478 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:01:29.191997 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_locations (execute): 02:01:27.544588 => 02:01:29.191997
[0m02:01:29.193998 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_locations: ROLLBACK
[0m02:01:29.195433 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_locations: Close
[0m02:01:29.196656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6944e91d-aecf-4a44-951a-29e08e5374a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA580642D0>]}
[0m02:01:29.198656 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dwh.dim_locations ............................. [[32mOK[0m in 1.67s]
[0m02:01:29.200535 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.dim_locations
[0m02:01:29.202734 [debug] [MainThread]: On master: COMMIT
[0m02:01:29.205282 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:01:29.206897 [debug] [MainThread]: Connection 'list_amazonsalesanalytics' was properly closed.
[0m02:01:29.208020 [debug] [MainThread]: Connection 'list_amazonsalesanalytics_dwh' was properly closed.
[0m02:01:29.209094 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.dim_locations' was properly closed.
[0m02:01:29.210466 [info ] [MainThread]: 
[0m02:01:29.212129 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.51 seconds (4.51s).
[0m02:01:29.214517 [debug] [MainThread]: Command end result
[0m02:01:29.233252 [info ] [MainThread]: 
[0m02:01:29.235092 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:01:29.236591 [info ] [MainThread]: 
[0m02:01:29.238308 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:01:29.267811 [debug] [MainThread]: Command `dbt run` succeeded at 02:01:29.267313 after 6.74 seconds
[0m02:01:29.269340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA56771290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA535A5F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA5637DF50>]}
[0m02:01:29.270968 [debug] [MainThread]: Flushing usage events
[0m02:01:30.150443 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m02:01:57.492090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DF02DD310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DEEF0B0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DF02DCB10>]}


============================== 02:01:57.502418 | bca8c2ca-459b-4b3e-b1a2-a923a7886f6d ==============================
[0m02:01:57.502418 [info ] [MainThread]: Running with dbt=1.7.16
[0m02:01:57.504329 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --target target --models dim_locations', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:01:58.101848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bca8c2ca-459b-4b3e-b1a2-a923a7886f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DEFF36750>]}
[0m02:01:58.144367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bca8c2ca-459b-4b3e-b1a2-a923a7886f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DF030B750>]}
[0m02:01:58.145383 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m02:01:58.160452 [debug] [MainThread]: checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, vars: {}, profile: , target: target, version: 1.7.16
[0m02:01:58.489280 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:01:58.490276 [debug] [MainThread]: Partial parsing: updated file: AmazonSalesAnalytics://models\source\dim_locations.sql
[0m02:01:58.597431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bca8c2ca-459b-4b3e-b1a2-a923a7886f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DF032F690>]}
[0m02:01:58.623647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bca8c2ca-459b-4b3e-b1a2-a923a7886f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DF09E4C10>]}
[0m02:01:58.626666 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 448 macros, 0 groups, 0 semantic models
[0m02:01:58.628202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bca8c2ca-459b-4b3e-b1a2-a923a7886f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DEC736810>]}
[0m02:01:58.630322 [info ] [MainThread]: 
[0m02:01:58.631288 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m02:01:58.633919 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics'
[0m02:01:58.669918 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics"
[0m02:01:58.671908 [debug] [ThreadPool]: On list_amazonsalesanalytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics"} */
select  name as [schema]
    from sys.schemas 
  
[0m02:01:58.676316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:01:58.678823 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m02:02:00.925360 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m02:02:01.147600 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m02:02:01.151125 [debug] [ThreadPool]: On list_amazonsalesanalytics: Close
[0m02:02:01.153278 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics_dwh'
[0m02:02:01.160977 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics_dwh"
[0m02:02:01.162972 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics_dwh"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
  
[0m02:02:01.163972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:02:01.164972 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m02:02:01.165973 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m02:02:01.393045 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:02:01.395064 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: ROLLBACK
[0m02:02:01.397050 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: Close
[0m02:02:01.400848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bca8c2ca-459b-4b3e-b1a2-a923a7886f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DF0988E10>]}
[0m02:02:01.401751 [debug] [MainThread]: On master: COMMIT
[0m02:02:01.403408 [info ] [MainThread]: Concurrency: 1 threads (target='target')
[0m02:02:01.404442 [info ] [MainThread]: 
[0m02:02:01.415881 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.dim_locations
[0m02:02:01.416927 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh.dim_locations ................................. [RUN]
[0m02:02:01.418845 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.dim_locations'
[0m02:02:01.420846 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.dim_locations
[0m02:02:01.429926 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.dim_locations"
[0m02:02:01.437928 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_locations (compile): 02:02:01.421848 => 02:02:01.436926
[0m02:02:01.439596 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.dim_locations
[0m02:02:01.463668 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_locations"
[0m02:02:01.464668 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_locations: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_locations"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."dim_locations__dbt_backup";');

[0m02:02:01.465672 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:02:01.466668 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m02:02:01.467668 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m02:02:01.690107 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:02:01.693952 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_locations"
[0m02:02:01.694955 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_locations: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_locations"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
    and table_name like 'dim_locations'
  
[0m02:02:01.917087 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:02:01.924747 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_locations"
[0m02:02:01.926747 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_locations: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_locations"} */
USE [amazonsalesanalytics];
      EXEC sp_rename 'dwh.dim_locations', 'dim_locations__dbt_backup'
[0m02:02:02.159596 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:02:02.172897 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_locations"
[0m02:02:02.174706 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_locations: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_locations"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_locations_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m02:02:02.412763 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:02:02.416861 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_locations"
[0m02:02:02.417859 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_locations: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_locations"} */

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_locations_temp_view";');

  
[0m02:02:02.639217 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:02:02.645299 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_locations"
[0m02:02:02.646235 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_locations: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_locations"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_locations_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m02:02:02.866461 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:02:02.868385 [debug] [Thread-1 (]: Writing runtime sql for node "model.AmazonSalesAnalytics.dim_locations"
[0m02:02:02.876793 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_locations"
[0m02:02:02.878790 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_locations: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_locations"} */

  
    

   

    USE [amazonsalesanalytics];
    
    

    EXEC('create view "dwh"."dim_locations_temp_view" as 

with dim_locations as (
    SELECT
        DISTINCT
        [ship-city] as ShipCity,
        [ship-state] as ShipState ,
        [ship-country] as ShipCountry ,
        [ship-postal-code] as ShipPostalCode
    from 
        raw.raw_data
    )

select row_number() over(order by ShipCity, ShipState, ShipCountry, ShipPostalCode) as LocationID,
        *
    from dim_locations;');



    
      EXEC('SELECT * INTO [amazonsalesanalytics].[dwh].[dim_locations] FROM [amazonsalesanalytics].[dwh].[dim_locations_temp_view];');
    

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_locations_temp_view";');



  
[0m02:02:19.202494 [debug] [Thread-1 (]: SQL status: OK in 16.0 seconds
[0m02:02:19.212929 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_locations: COMMIT
[0m02:02:19.215936 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_locations"
[0m02:02:19.216963 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_locations: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_locations"} */

      USE [amazonsalesanalytics];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dwh' and tab2.name = 'dim_locations__dbt_backup'
  
[0m02:02:20.267701 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m02:02:20.272709 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_locations"
[0m02:02:20.274683 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_locations: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_locations"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."dim_locations__dbt_backup";');

[0m02:02:20.501648 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:02:20.503165 [debug] [Thread-1 (]: fabric adapter: Database error: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Cannot use DROP TABLE with 'dwh.dim_locations__dbt_backup' because 'dwh.dim_locations__dbt_backup' is a view. Use DROP VIEW. (3705) (SQLMoreResults)")
[0m02:02:20.504755 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_locations: ROLLBACK
[0m02:02:20.505792 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_locations: Close
[0m02:02:20.507295 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_locations (execute): 02:02:01.440610 => 02:02:20.506278
[0m02:02:20.531034 [debug] [Thread-1 (]: Database Error in model dim_locations (models\source\dim_locations.sql)
  ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Cannot use DROP TABLE with 'dwh.dim_locations__dbt_backup' because 'dwh.dim_locations__dbt_backup' is a view. Use DROP VIEW. (3705) (SQLMoreResults)")
  compiled Code at target\run\AmazonSalesAnalytics\models\source\dim_locations.sql
[0m02:02:20.532950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bca8c2ca-459b-4b3e-b1a2-a923a7886f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DF1BE4B90>]}
[0m02:02:20.534827 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dwh.dim_locations ........................ [[31mERROR[0m in 19.11s]
[0m02:02:20.536343 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.dim_locations
[0m02:02:20.539336 [debug] [MainThread]: On master: COMMIT
[0m02:02:20.541245 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:02:20.542264 [debug] [MainThread]: Connection 'list_amazonsalesanalytics' was properly closed.
[0m02:02:20.543260 [debug] [MainThread]: Connection 'list_amazonsalesanalytics_dwh' was properly closed.
[0m02:02:20.544930 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.dim_locations' was properly closed.
[0m02:02:20.545930 [info ] [MainThread]: 
[0m02:02:20.547174 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 21.91 seconds (21.91s).
[0m02:02:20.549175 [debug] [MainThread]: Command end result
[0m02:02:20.565892 [info ] [MainThread]: 
[0m02:02:20.567581 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:02:20.570015 [info ] [MainThread]: 
[0m02:02:20.571032 [error] [MainThread]:   Database Error in model dim_locations (models\source\dim_locations.sql)
  ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Cannot use DROP TABLE with 'dwh.dim_locations__dbt_backup' because 'dwh.dim_locations__dbt_backup' is a view. Use DROP VIEW. (3705) (SQLMoreResults)")
  compiled Code at target\run\AmazonSalesAnalytics\models\source\dim_locations.sql
[0m02:02:20.576191 [info ] [MainThread]: 
[0m02:02:20.577846 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:02:20.603945 [debug] [MainThread]: Command `dbt run` failed at 02:02:20.603446 after 23.75 seconds
[0m02:02:20.604915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DEFDD4750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DF032F910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DEEF0AD50>]}
[0m02:02:20.606840 [debug] [MainThread]: Flushing usage events
[0m02:02:20.690895 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m02:03:19.516561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252C8E8FF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252C8E8EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252C8E8EE90>]}


============================== 02:03:19.527162 | 733454d7-c9ae-43c0-80ba-72fab324c507 ==============================
[0m02:03:19.527162 [info ] [MainThread]: Running with dbt=1.7.16
[0m02:03:19.530013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --target target --models dim_locations', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:03:20.219209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '733454d7-c9ae-43c0-80ba-72fab324c507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252C93998D0>]}
[0m02:03:20.268024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '733454d7-c9ae-43c0-80ba-72fab324c507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252C9415550>]}
[0m02:03:20.269641 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m02:03:20.289830 [debug] [MainThread]: checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, vars: {}, profile: , target: target, version: 1.7.16
[0m02:03:20.680238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:03:20.681571 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:03:20.686726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '733454d7-c9ae-43c0-80ba-72fab324c507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252C958AD10>]}
[0m02:03:20.716605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '733454d7-c9ae-43c0-80ba-72fab324c507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252C950ACD0>]}
[0m02:03:20.718601 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 448 macros, 0 groups, 0 semantic models
[0m02:03:20.720777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '733454d7-c9ae-43c0-80ba-72fab324c507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252C93CD210>]}
[0m02:03:20.722791 [info ] [MainThread]: 
[0m02:03:20.724790 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m02:03:20.726900 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics'
[0m02:03:20.737520 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics"
[0m02:03:20.739560 [debug] [ThreadPool]: On list_amazonsalesanalytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics"} */
select  name as [schema]
    from sys.schemas 
  
[0m02:03:20.740689 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:03:20.743251 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m02:03:23.061693 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m02:03:23.288092 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m02:03:23.291588 [debug] [ThreadPool]: On list_amazonsalesanalytics: Close
[0m02:03:23.293936 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics_dwh'
[0m02:03:23.299942 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics_dwh"
[0m02:03:23.300942 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics_dwh"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
  
[0m02:03:23.301945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:03:23.302605 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m02:03:23.303620 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m02:03:23.531613 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:03:23.533605 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: ROLLBACK
[0m02:03:23.534603 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: Close
[0m02:03:23.539204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '733454d7-c9ae-43c0-80ba-72fab324c507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252C940B150>]}
[0m02:03:23.539704 [debug] [MainThread]: On master: COMMIT
[0m02:03:23.541561 [info ] [MainThread]: Concurrency: 1 threads (target='target')
[0m02:03:23.544041 [info ] [MainThread]: 
[0m02:03:23.556628 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.dim_locations
[0m02:03:23.558877 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh.dim_locations ................................. [RUN]
[0m02:03:23.561766 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.dim_locations'
[0m02:03:23.562767 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.dim_locations
[0m02:03:23.572271 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.dim_locations"
[0m02:03:23.583287 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_locations (compile): 02:03:23.564315 => 02:03:23.582284
[0m02:03:23.584277 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.dim_locations
[0m02:03:23.614352 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_locations"
[0m02:03:23.615358 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_locations: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_locations"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."dim_locations__dbt_backup";');

[0m02:03:23.616956 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:03:23.617976 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m02:03:24.898112 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m02:03:25.135192 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m02:03:25.139192 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_locations"
[0m02:03:25.140197 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_locations: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_locations"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
    and table_name like 'dim_locations'
  
[0m02:03:25.388697 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:03:25.402459 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_locations"
[0m02:03:25.404549 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_locations: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_locations"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_locations_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m02:03:25.665193 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:03:25.668192 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_locations"
[0m02:03:25.670192 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_locations: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_locations"} */

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_locations_temp_view";');

  
[0m02:03:25.908606 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:03:25.915103 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_locations"
[0m02:03:25.916532 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_locations: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_locations"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_locations_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m02:03:26.154917 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:03:26.184346 [debug] [Thread-1 (]: Writing runtime sql for node "model.AmazonSalesAnalytics.dim_locations"
[0m02:03:26.193274 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_locations"
[0m02:03:26.195250 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_locations: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_locations"} */

  
    

   

    USE [amazonsalesanalytics];
    
    

    EXEC('create view "dwh"."dim_locations_temp_view" as 

with dim_locations as (
    SELECT
        DISTINCT
        [ship-city] as ShipCity,
        [ship-state] as ShipState ,
        [ship-country] as ShipCountry ,
        [ship-postal-code] as ShipPostalCode
    from 
        raw.raw_data
    )

select row_number() over(order by ShipCity, ShipState, ShipCountry, ShipPostalCode) as LocationID,
        *
    from dim_locations;');



    
      EXEC('SELECT * INTO [amazonsalesanalytics].[dwh].[dim_locations] FROM [amazonsalesanalytics].[dwh].[dim_locations_temp_view];');
    

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_locations_temp_view";');



  
[0m02:03:42.787929 [debug] [Thread-1 (]: SQL status: OK in 17.0 seconds
[0m02:03:42.802067 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_locations: COMMIT
[0m02:03:42.808085 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_locations"
[0m02:03:42.810067 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_locations: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_locations"} */

      USE [amazonsalesanalytics];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dwh' and tab2.name = 'dim_locations__dbt_backup'
  
[0m02:03:43.048620 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:03:43.056660 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_locations"
[0m02:03:43.058657 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_locations: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_locations"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."dim_locations__dbt_backup";');

[0m02:03:43.296859 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:03:43.304684 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_locations (execute): 02:03:23.585416 => 02:03:43.304684
[0m02:03:43.306282 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_locations: ROLLBACK
[0m02:03:43.306805 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_locations: Close
[0m02:03:43.309547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '733454d7-c9ae-43c0-80ba-72fab324c507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252C95A5A50>]}
[0m02:03:43.310565 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dwh.dim_locations ............................ [[32mOK[0m in 19.75s]
[0m02:03:43.312564 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.dim_locations
[0m02:03:43.314391 [debug] [MainThread]: On master: COMMIT
[0m02:03:43.317489 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:03:43.318418 [debug] [MainThread]: Connection 'list_amazonsalesanalytics' was properly closed.
[0m02:03:43.319499 [debug] [MainThread]: Connection 'list_amazonsalesanalytics_dwh' was properly closed.
[0m02:03:43.320509 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.dim_locations' was properly closed.
[0m02:03:43.321627 [info ] [MainThread]: 
[0m02:03:43.324188 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 22.60 seconds (22.60s).
[0m02:03:43.326199 [debug] [MainThread]: Command end result
[0m02:03:43.344997 [info ] [MainThread]: 
[0m02:03:43.346722 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:03:43.349480 [info ] [MainThread]: 
[0m02:03:43.351562 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:03:43.379900 [debug] [MainThread]: Command `dbt run` succeeded at 02:03:43.378821 after 24.62 seconds
[0m02:03:43.380825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252C240AA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252C240AD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252C827B590>]}
[0m02:03:43.381831 [debug] [MainThread]: Flushing usage events
[0m02:03:43.598824 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m02:07:51.881326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002546A4AD350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002546A4FF010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002546A4FEA50>]}


============================== 02:07:51.892413 | d1a9fd84-18ec-4d22-984f-f202e9d1c69b ==============================
[0m02:07:51.892413 [info ] [MainThread]: Running with dbt=1.7.16
[0m02:07:51.893937 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --target target --models dim_fulfillment', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:07:52.503417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1a9fd84-18ec-4d22-984f-f202e9d1c69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002546A4C4450>]}
[0m02:07:52.545709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1a9fd84-18ec-4d22-984f-f202e9d1c69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002546A515510>]}
[0m02:07:52.548118 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m02:07:52.564447 [debug] [MainThread]: checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, vars: {}, profile: , target: target, version: 1.7.16
[0m02:07:52.912691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m02:07:52.913691 [debug] [MainThread]: Partial parsing: added file: AmazonSalesAnalytics://models\source\dim_fulfillment.sql
[0m02:07:53.018908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1a9fd84-18ec-4d22-984f-f202e9d1c69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002546AB86C90>]}
[0m02:07:53.043209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1a9fd84-18ec-4d22-984f-f202e9d1c69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002546AB529D0>]}
[0m02:07:53.046914 [info ] [MainThread]: Found 3 models, 1 source, 0 exposures, 0 metrics, 448 macros, 0 groups, 0 semantic models
[0m02:07:53.048206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1a9fd84-18ec-4d22-984f-f202e9d1c69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002546BD3DB90>]}
[0m02:07:53.050220 [info ] [MainThread]: 
[0m02:07:53.052225 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m02:07:53.054219 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics'
[0m02:07:53.065593 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics"
[0m02:07:53.066598 [debug] [ThreadPool]: On list_amazonsalesanalytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics"} */
select  name as [schema]
    from sys.schemas 
  
[0m02:07:53.068597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:07:53.069681 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m02:07:55.417457 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m02:07:55.646941 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m02:07:55.648822 [debug] [ThreadPool]: On list_amazonsalesanalytics: Close
[0m02:07:55.651943 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics_dwh'
[0m02:07:55.655943 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics_dwh"
[0m02:07:55.656943 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics_dwh"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
  
[0m02:07:55.657954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:07:55.658943 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m02:07:55.659949 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m02:07:55.890799 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:07:55.892799 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: ROLLBACK
[0m02:07:55.893799 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: Close
[0m02:07:55.896879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1a9fd84-18ec-4d22-984f-f202e9d1c69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002546AA3CD50>]}
[0m02:07:55.898801 [debug] [MainThread]: On master: COMMIT
[0m02:07:55.899800 [info ] [MainThread]: Concurrency: 1 threads (target='target')
[0m02:07:55.901892 [info ] [MainThread]: 
[0m02:07:55.913800 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.dim_fulfillment
[0m02:07:55.916016 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh.dim_fulfillment ............................... [RUN]
[0m02:07:55.918014 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.dim_fulfillment'
[0m02:07:55.919014 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.dim_fulfillment
[0m02:07:55.926020 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.dim_fulfillment"
[0m02:07:55.936488 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_fulfillment (compile): 02:07:55.919014 => 02:07:55.935462
[0m02:07:55.937487 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.dim_fulfillment
[0m02:07:55.967953 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m02:07:55.970029 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."dim_fulfillment__dbt_backup";');

[0m02:07:55.972675 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:07:55.973913 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m02:07:55.974955 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m02:07:56.204282 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:07:56.207279 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m02:07:56.208284 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
    and table_name like 'dim_fulfillment'
  
[0m02:07:56.449497 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:07:56.455544 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m02:07:56.456459 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */
USE [amazonsalesanalytics];
      EXEC sp_rename 'dwh.dim_fulfillment', 'dim_fulfillment__dbt_backup'
[0m02:07:56.694356 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:07:56.707359 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m02:07:56.708359 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_fulfillment_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m02:07:56.954304 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:07:56.957570 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m02:07:56.959569 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_fulfillment_temp_view";');

  
[0m02:07:57.191404 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:07:57.198497 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m02:07:57.199498 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_fulfillment_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m02:07:57.440489 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:07:57.442725 [debug] [Thread-1 (]: Writing runtime sql for node "model.AmazonSalesAnalytics.dim_fulfillment"
[0m02:07:57.450723 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m02:07:57.451723 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */

  
    

   

    USE [amazonsalesanalytics];
    
    

    EXEC('create view "dwh"."dim_fulfillment_temp_view" as 

with dim_fulfillment as (
    select 
        DISTINCT
        Fulfilment as Fulfillment ,
        [ship-service-level] as ShipServiceLevel 
    from 
        raw.raw_data
)

select row_number() over(order by Fulfillment, ShipServiceLevel),
        *
    from dim_fulfillment;');



    
      EXEC('SELECT * INTO [amazonsalesanalytics].[dwh].[dim_fulfillment] FROM [amazonsalesanalytics].[dwh].[dim_fulfillment_temp_view];');
    

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_fulfillment_temp_view";');



  
[0m02:07:57.684379 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:07:57.685378 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_fulfillment (execute): 02:07:55.938494 => 02:07:57.685378
[0m02:07:57.686378 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: ROLLBACK
[0m02:07:57.687384 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: Close
[0m02:07:57.689011 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\AmazonSalesAnalytics\models\source\dim_fulfillment.sql[0m
('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Create View or Function failed because no column name was specified for column 1. (4511) (SQLMoreResults)')
[0m02:07:57.707103 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\base.py", line 380, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\base.py", line 326, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\base.py", line 427, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 83, in macro
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
          ^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Create View or Function failed because no column name was specified for column 1. (4511) (SQLMoreResults)')

[0m02:07:57.708024 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1a9fd84-18ec-4d22-984f-f202e9d1c69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002546BD9B1D0>]}
[0m02:07:57.709060 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dwh.dim_fulfillment ...................... [[31mERROR[0m in 1.79s]
[0m02:07:57.711600 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.dim_fulfillment
[0m02:07:57.715882 [debug] [MainThread]: On master: COMMIT
[0m02:07:57.716807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:07:57.717851 [debug] [MainThread]: Connection 'list_amazonsalesanalytics' was properly closed.
[0m02:07:57.718806 [debug] [MainThread]: Connection 'list_amazonsalesanalytics_dwh' was properly closed.
[0m02:07:57.720002 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.dim_fulfillment' was properly closed.
[0m02:07:57.721563 [info ] [MainThread]: 
[0m02:07:57.722605 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.67 seconds (4.67s).
[0m02:07:57.723607 [debug] [MainThread]: Command end result
[0m02:07:57.737238 [info ] [MainThread]: 
[0m02:07:57.739232 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:07:57.741229 [info ] [MainThread]: 
[0m02:07:57.742231 [error] [MainThread]:   ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Create View or Function failed because no column name was specified for column 1. (4511) (SQLMoreResults)')
[0m02:07:57.744103 [info ] [MainThread]: 
[0m02:07:57.746188 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:07:57.769040 [debug] [MainThread]: Command `dbt run` failed at 02:07:57.769040 after 6.52 seconds
[0m02:07:57.770051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002546A500810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002546A500690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002546A502A10>]}
[0m02:07:57.771041 [debug] [MainThread]: Flushing usage events
[0m02:07:58.655472 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m02:08:30.056340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002047399ECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020473401210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204733410D0>]}


============================== 02:08:30.067216 | 722588ca-30a3-480a-b369-0e993c1cd2af ==============================
[0m02:08:30.067216 [info ] [MainThread]: Running with dbt=1.7.16
[0m02:08:30.069135 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --target target --models dim_fulfillment', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:08:30.700920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '722588ca-30a3-480a-b369-0e993c1cd2af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020473EC6E90>]}
[0m02:08:30.745673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '722588ca-30a3-480a-b369-0e993c1cd2af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020473F75610>]}
[0m02:08:30.747336 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m02:08:30.764607 [debug] [MainThread]: checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, vars: {}, profile: , target: target, version: 1.7.16
[0m02:08:31.094454 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:08:31.095610 [debug] [MainThread]: Partial parsing: updated file: AmazonSalesAnalytics://models\source\dim_fulfillment.sql
[0m02:08:31.205452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '722588ca-30a3-480a-b369-0e993c1cd2af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002047515DE90>]}
[0m02:08:31.232207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '722588ca-30a3-480a-b369-0e993c1cd2af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204740861D0>]}
[0m02:08:31.234197 [info ] [MainThread]: Found 3 models, 1 source, 0 exposures, 0 metrics, 448 macros, 0 groups, 0 semantic models
[0m02:08:31.236806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '722588ca-30a3-480a-b369-0e993c1cd2af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020475239ED0>]}
[0m02:08:31.238818 [info ] [MainThread]: 
[0m02:08:31.240818 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m02:08:31.242819 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics'
[0m02:08:31.253544 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics"
[0m02:08:31.255545 [debug] [ThreadPool]: On list_amazonsalesanalytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics"} */
select  name as [schema]
    from sys.schemas 
  
[0m02:08:31.256543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:08:31.257623 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m02:08:33.570639 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m02:08:33.801736 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m02:08:33.804958 [debug] [ThreadPool]: On list_amazonsalesanalytics: Close
[0m02:08:33.808008 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics_dwh'
[0m02:08:33.815272 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics_dwh"
[0m02:08:33.816294 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics_dwh"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
  
[0m02:08:33.817329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:08:33.818393 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m02:08:33.819401 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m02:08:34.056652 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:08:34.058648 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: ROLLBACK
[0m02:08:34.059650 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: Close
[0m02:08:34.062641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '722588ca-30a3-480a-b369-0e993c1cd2af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020473A15610>]}
[0m02:08:34.064744 [debug] [MainThread]: On master: COMMIT
[0m02:08:34.065951 [info ] [MainThread]: Concurrency: 1 threads (target='target')
[0m02:08:34.067951 [info ] [MainThread]: 
[0m02:08:34.077950 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.dim_fulfillment
[0m02:08:34.079916 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh.dim_fulfillment ............................... [RUN]
[0m02:08:34.082123 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.dim_fulfillment'
[0m02:08:34.083569 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.dim_fulfillment
[0m02:08:34.092057 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.dim_fulfillment"
[0m02:08:34.103385 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_fulfillment (compile): 02:08:34.084587 => 02:08:34.102388
[0m02:08:34.104603 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.dim_fulfillment
[0m02:08:34.127777 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m02:08:34.128784 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."dim_fulfillment__dbt_backup";');

[0m02:08:34.130147 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:08:34.132042 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m02:08:34.133531 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m02:08:34.372792 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:08:34.373793 [debug] [Thread-1 (]: fabric adapter: Database error: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Could not drop object 'dwh.dim_fulfillment__dbt_backup' because it is referenced by a FOREIGN KEY constraint. (3726) (SQLMoreResults)")
[0m02:08:34.374793 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: Close
[0m02:08:34.375794 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_fulfillment (execute): 02:08:34.105616 => 02:08:34.375794
[0m02:08:34.398660 [debug] [Thread-1 (]: Database Error in model dim_fulfillment (models\source\dim_fulfillment.sql)
  ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Could not drop object 'dwh.dim_fulfillment__dbt_backup' because it is referenced by a FOREIGN KEY constraint. (3726) (SQLMoreResults)")
[0m02:08:34.400667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '722588ca-30a3-480a-b369-0e993c1cd2af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020474121190>]}
[0m02:08:34.401660 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dwh.dim_fulfillment ...................... [[31mERROR[0m in 0.32s]
[0m02:08:34.403676 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.dim_fulfillment
[0m02:08:34.405658 [debug] [MainThread]: On master: COMMIT
[0m02:08:34.406659 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:08:34.409184 [debug] [MainThread]: Connection 'list_amazonsalesanalytics' was properly closed.
[0m02:08:34.410046 [debug] [MainThread]: Connection 'list_amazonsalesanalytics_dwh' was properly closed.
[0m02:08:34.411065 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.dim_fulfillment' was properly closed.
[0m02:08:34.412560 [info ] [MainThread]: 
[0m02:08:34.413574 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.17 seconds (3.17s).
[0m02:08:34.415575 [debug] [MainThread]: Command end result
[0m02:08:34.432010 [info ] [MainThread]: 
[0m02:08:34.434023 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:08:34.436086 [info ] [MainThread]: 
[0m02:08:34.437397 [error] [MainThread]:   Database Error in model dim_fulfillment (models\source\dim_fulfillment.sql)
  ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Could not drop object 'dwh.dim_fulfillment__dbt_backup' because it is referenced by a FOREIGN KEY constraint. (3726) (SQLMoreResults)")
[0m02:08:34.439708 [info ] [MainThread]: 
[0m02:08:34.441725 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:08:34.465429 [debug] [MainThread]: Command `dbt run` failed at 02:08:34.464428 after 5.01 seconds
[0m02:08:34.466426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204739F11D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020472DD3590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002046CEAAA90>]}
[0m02:08:34.468465 [debug] [MainThread]: Flushing usage events
[0m02:08:34.546152 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m02:09:13.429557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B91790C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B9178FE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B91244AD0>]}


============================== 02:09:13.439756 | deb412a7-d3f2-4569-8d8c-9963a6f6dcd5 ==============================
[0m02:09:13.439756 [info ] [MainThread]: Running with dbt=1.7.16
[0m02:09:13.441373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --target target --models dim_fulfillment', 'send_anonymous_usage_stats': 'True'}
[0m02:09:14.089429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'deb412a7-d3f2-4569-8d8c-9963a6f6dcd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B9178EF10>]}
[0m02:09:14.132610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'deb412a7-d3f2-4569-8d8c-9963a6f6dcd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B91D27210>]}
[0m02:09:14.134634 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m02:09:14.151614 [debug] [MainThread]: checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, vars: {}, profile: , target: target, version: 1.7.16
[0m02:09:14.476961 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:09:14.477965 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:09:14.483162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'deb412a7-d3f2-4569-8d8c-9963a6f6dcd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B91EFCE50>]}
[0m02:09:14.510452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'deb412a7-d3f2-4569-8d8c-9963a6f6dcd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B91E34710>]}
[0m02:09:14.512462 [info ] [MainThread]: Found 3 models, 1 source, 0 exposures, 0 metrics, 448 macros, 0 groups, 0 semantic models
[0m02:09:14.514172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'deb412a7-d3f2-4569-8d8c-9963a6f6dcd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B91E1A310>]}
[0m02:09:14.516299 [info ] [MainThread]: 
[0m02:09:14.518300 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m02:09:14.519559 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics'
[0m02:09:14.532323 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics"
[0m02:09:14.534322 [debug] [ThreadPool]: On list_amazonsalesanalytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics"} */
select  name as [schema]
    from sys.schemas 
  
[0m02:09:14.534322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:09:14.535427 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m02:09:16.835913 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m02:09:17.105769 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m02:09:17.107738 [debug] [ThreadPool]: On list_amazonsalesanalytics: Close
[0m02:09:17.110947 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics_dwh'
[0m02:09:17.116421 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics_dwh"
[0m02:09:17.117420 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics_dwh"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
  
[0m02:09:17.118420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:09:17.119420 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m02:09:17.119420 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m02:09:17.392201 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:09:17.394135 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: ROLLBACK
[0m02:09:17.395135 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: Close
[0m02:09:17.398235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'deb412a7-d3f2-4569-8d8c-9963a6f6dcd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B91EE1890>]}
[0m02:09:17.399141 [debug] [MainThread]: On master: COMMIT
[0m02:09:17.399694 [info ] [MainThread]: Concurrency: 1 threads (target='target')
[0m02:09:17.401714 [info ] [MainThread]: 
[0m02:09:17.413088 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.dim_fulfillment
[0m02:09:17.414375 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh.dim_fulfillment ............................... [RUN]
[0m02:09:17.416372 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.dim_fulfillment'
[0m02:09:17.417372 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.dim_fulfillment
[0m02:09:17.423371 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.dim_fulfillment"
[0m02:09:17.432749 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_fulfillment (compile): 02:09:17.418371 => 02:09:17.432749
[0m02:09:17.433748 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.dim_fulfillment
[0m02:09:17.457732 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m02:09:17.458740 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."dim_fulfillment__dbt_backup";');

[0m02:09:17.459644 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:09:17.461100 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m02:09:18.731107 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m02:09:19.016302 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m02:09:19.020524 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m02:09:19.020524 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
    and table_name like 'dim_fulfillment'
  
[0m02:09:19.261008 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:09:19.275729 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m02:09:19.276900 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_fulfillment_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m02:09:19.507394 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:09:19.511232 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m02:09:19.513202 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_fulfillment_temp_view";');

  
[0m02:09:19.743554 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:09:19.748553 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m02:09:19.749540 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_fulfillment_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m02:09:20.010371 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:09:20.012378 [debug] [Thread-1 (]: Writing runtime sql for node "model.AmazonSalesAnalytics.dim_fulfillment"
[0m02:09:20.019374 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m02:09:20.020393 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */

  
    

   

    USE [amazonsalesanalytics];
    
    

    EXEC('create view "dwh"."dim_fulfillment_temp_view" as 

with dim_fulfillment as (
    select 
        DISTINCT
        Fulfilment as Fulfillment ,
        [ship-service-level] as ShipServiceLevel 
    from 
        raw.raw_data
)

select row_number() over(order by Fulfillment, ShipServiceLevel) as FulfillmentID ,
        *
    from dim_fulfillment;');



    
      EXEC('SELECT * INTO [amazonsalesanalytics].[dwh].[dim_fulfillment] FROM [amazonsalesanalytics].[dwh].[dim_fulfillment_temp_view];');
    

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_fulfillment_temp_view";');



  
[0m02:09:23.610856 [debug] [Thread-1 (]: SQL status: OK in 4.0 seconds
[0m02:09:23.625035 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: COMMIT
[0m02:09:23.629449 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m02:09:23.631379 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */

      USE [amazonsalesanalytics];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dwh' and tab2.name = 'dim_fulfillment__dbt_backup'
  
[0m02:09:24.827738 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m02:09:24.833833 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m02:09:24.834816 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."dim_fulfillment__dbt_backup";');

[0m02:09:25.067739 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:09:25.075944 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_fulfillment (execute): 02:09:17.434749 => 02:09:25.075944
[0m02:09:25.077022 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: ROLLBACK
[0m02:09:25.077961 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: Close
[0m02:09:25.079990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deb412a7-d3f2-4569-8d8c-9963a6f6dcd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B92FA6750>]}
[0m02:09:25.079990 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dwh.dim_fulfillment .......................... [[32mOK[0m in 7.66s]
[0m02:09:25.082409 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.dim_fulfillment
[0m02:09:25.084323 [debug] [MainThread]: On master: COMMIT
[0m02:09:25.085421 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:09:25.086355 [debug] [MainThread]: Connection 'list_amazonsalesanalytics' was properly closed.
[0m02:09:25.087322 [debug] [MainThread]: Connection 'list_amazonsalesanalytics_dwh' was properly closed.
[0m02:09:25.087322 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.dim_fulfillment' was properly closed.
[0m02:09:25.088399 [info ] [MainThread]: 
[0m02:09:25.089323 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.57 seconds (10.57s).
[0m02:09:25.092463 [debug] [MainThread]: Command end result
[0m02:09:25.104553 [info ] [MainThread]: 
[0m02:09:25.106529 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:09:25.108126 [info ] [MainThread]: 
[0m02:09:25.109167 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:09:25.130128 [debug] [MainThread]: Command `dbt run` succeeded at 02:09:25.130128 after 12.37 seconds
[0m02:09:25.131162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B91791110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B8AD0B990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B8AD1AA90>]}
[0m02:09:25.132196 [debug] [MainThread]: Flushing usage events
[0m02:09:25.253664 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m03:42:33.140739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF5162310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF517FF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF4C14750>]}


============================== 03:42:33.150832 | eb04fc0b-7c3c-4388-905e-80975d6240af ==============================
[0m03:42:33.150832 [info ] [MainThread]: Running with dbt=1.7.16
[0m03:42:33.151784 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --target target --models dim_fulfillment', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:42:33.746084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb04fc0b-7c3c-4388-905e-80975d6240af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF5705550>]}
[0m03:42:33.788501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb04fc0b-7c3c-4388-905e-80975d6240af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF56E4310>]}
[0m03:42:33.790506 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m03:42:33.805006 [debug] [MainThread]: checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, vars: {}, profile: , target: target, version: 1.7.16
[0m03:42:34.147169 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:42:34.148262 [debug] [MainThread]: Partial parsing: updated file: AmazonSalesAnalytics://models\source\dim_fulfillment.sql
[0m03:42:34.256680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb04fc0b-7c3c-4388-905e-80975d6240af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF69F3250>]}
[0m03:42:34.283044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb04fc0b-7c3c-4388-905e-80975d6240af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF69D3A10>]}
[0m03:42:34.286019 [info ] [MainThread]: Found 3 models, 1 source, 0 exposures, 0 metrics, 448 macros, 0 groups, 0 semantic models
[0m03:42:34.288350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb04fc0b-7c3c-4388-905e-80975d6240af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF6950250>]}
[0m03:42:34.290337 [info ] [MainThread]: 
[0m03:42:34.292326 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m03:42:34.295369 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics'
[0m03:42:34.305367 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics"
[0m03:42:34.307381 [debug] [ThreadPool]: On list_amazonsalesanalytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics"} */
select  name as [schema]
    from sys.schemas 
  
[0m03:42:34.308368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:42:34.309374 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m03:42:36.688135 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m03:42:36.921103 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m03:42:36.924216 [debug] [ThreadPool]: On list_amazonsalesanalytics: Close
[0m03:42:36.926223 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics_dwh'
[0m03:42:36.932520 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics_dwh"
[0m03:42:36.933520 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics_dwh"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
  
[0m03:42:36.933520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:42:36.934520 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m03:42:36.935523 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m03:42:37.173409 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:42:37.174408 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: ROLLBACK
[0m03:42:37.176411 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: Close
[0m03:42:37.179409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb04fc0b-7c3c-4388-905e-80975d6240af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF58319D0>]}
[0m03:42:37.181414 [debug] [MainThread]: On master: COMMIT
[0m03:42:37.182424 [info ] [MainThread]: Concurrency: 1 threads (target='target')
[0m03:42:37.183410 [info ] [MainThread]: 
[0m03:42:37.196758 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.dim_fulfillment
[0m03:42:37.197768 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh.dim_fulfillment ............................... [RUN]
[0m03:42:37.199769 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.dim_fulfillment'
[0m03:42:37.201765 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.dim_fulfillment
[0m03:42:37.209290 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.dim_fulfillment"
[0m03:42:37.218628 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_fulfillment (compile): 03:42:37.202852 => 03:42:37.218286
[0m03:42:37.220069 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.dim_fulfillment
[0m03:42:37.247019 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m03:42:37.248498 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."dim_fulfillment__dbt_backup";');

[0m03:42:37.250556 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:42:37.251911 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m03:42:37.252867 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m03:42:37.485114 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:42:37.488115 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m03:42:37.489114 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
    and table_name like 'dim_fulfillment'
  
[0m03:42:37.719200 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:42:37.724309 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m03:42:37.725309 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */
USE [amazonsalesanalytics];
      EXEC sp_rename 'dwh.dim_fulfillment', 'dim_fulfillment__dbt_backup'
[0m03:42:37.991325 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:42:38.005461 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m03:42:38.006458 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_fulfillment_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m03:42:38.236691 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:42:38.239777 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m03:42:38.241692 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_fulfillment_temp_view";');

  
[0m03:42:38.470547 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:42:38.475545 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m03:42:38.477545 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_fulfillment_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m03:42:38.707205 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:42:38.709274 [debug] [Thread-1 (]: Writing runtime sql for node "model.AmazonSalesAnalytics.dim_fulfillment"
[0m03:42:38.717527 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m03:42:38.719521 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */

  
    

   

    USE [amazonsalesanalytics];
    
    

    EXEC('create view "dwh"."dim_fulfillment_temp_view" as 

with dim_fulfillment as (
    select 
        DISTINCT
        Fulfilment as FulfillmentType,
        [ship-service-level] as ShipServiceLevel,
        [fulfilled-by] as FulfilledBy
    from 
        raw.raw_data
)

select row_number() over(order by Fulfillment, ShipServiceLevel, FulfilledBy) as FulfillmentID ,
        *
    from dim_fulfillment;');



    
      EXEC('SELECT * INTO [amazonsalesanalytics].[dwh].[dim_fulfillment] FROM [amazonsalesanalytics].[dwh].[dim_fulfillment_temp_view];');
    

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_fulfillment_temp_view";');



  
[0m03:42:38.951348 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:42:38.953431 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_fulfillment (execute): 03:42:37.221690 => 03:42:38.952435
[0m03:42:38.954360 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: ROLLBACK
[0m03:42:38.955386 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: Close
[0m03:42:38.956350 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\AmazonSalesAnalytics\models\source\dim_fulfillment.sql[0m
('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'Fulfillment'. (207) (SQLMoreResults)")
[0m03:42:38.975856 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\base.py", line 380, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\base.py", line 326, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\base.py", line 427, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 83, in macro
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Drive\dbt_venv\Lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
          ^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'Fulfillment'. (207) (SQLMoreResults)")

[0m03:42:38.976854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb04fc0b-7c3c-4388-905e-80975d6240af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF69E4B90>]}
[0m03:42:38.978824 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dwh.dim_fulfillment ...................... [[31mERROR[0m in 1.78s]
[0m03:42:38.980456 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.dim_fulfillment
[0m03:42:38.984511 [debug] [MainThread]: On master: COMMIT
[0m03:42:38.985518 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:42:38.986511 [debug] [MainThread]: Connection 'list_amazonsalesanalytics' was properly closed.
[0m03:42:38.987518 [debug] [MainThread]: Connection 'list_amazonsalesanalytics_dwh' was properly closed.
[0m03:42:38.988510 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.dim_fulfillment' was properly closed.
[0m03:42:38.989511 [info ] [MainThread]: 
[0m03:42:38.990512 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.70 seconds (4.70s).
[0m03:42:38.992525 [debug] [MainThread]: Command end result
[0m03:42:39.008161 [info ] [MainThread]: 
[0m03:42:39.010161 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:42:39.012481 [info ] [MainThread]: 
[0m03:42:39.013562 [error] [MainThread]:   ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'Fulfillment'. (207) (SQLMoreResults)")
[0m03:42:39.014828 [info ] [MainThread]: 
[0m03:42:39.017221 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:42:39.046573 [debug] [MainThread]: Command `dbt run` failed at 03:42:39.045543 after 6.58 seconds
[0m03:42:39.048089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF51A5F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFEE70AA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF512A890>]}
[0m03:42:39.050247 [debug] [MainThread]: Flushing usage events
[0m03:42:39.934821 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m03:43:02.149042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2987DCCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2982C4350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D298240B10>]}


============================== 03:43:02.159416 | e82d2dec-250c-43ff-8e3e-63f0a5421f38 ==============================
[0m03:43:02.159416 [info ] [MainThread]: Running with dbt=1.7.16
[0m03:43:02.160307 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --target target --models dim_fulfillment', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:43:02.748217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e82d2dec-250c-43ff-8e3e-63f0a5421f38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D298DDB250>]}
[0m03:43:02.790679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e82d2dec-250c-43ff-8e3e-63f0a5421f38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D298DCEB50>]}
[0m03:43:02.792592 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m03:43:02.806971 [debug] [MainThread]: checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, vars: {}, profile: , target: target, version: 1.7.16
[0m03:43:03.140855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:43:03.141885 [debug] [MainThread]: Partial parsing: updated file: AmazonSalesAnalytics://models\source\dim_fulfillment.sql
[0m03:43:03.257863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e82d2dec-250c-43ff-8e3e-63f0a5421f38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D29A014090>]}
[0m03:43:03.284835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e82d2dec-250c-43ff-8e3e-63f0a5421f38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D29A096490>]}
[0m03:43:03.287831 [info ] [MainThread]: Found 3 models, 1 source, 0 exposures, 0 metrics, 448 macros, 0 groups, 0 semantic models
[0m03:43:03.288892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e82d2dec-250c-43ff-8e3e-63f0a5421f38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D298854AD0>]}
[0m03:43:03.290798 [info ] [MainThread]: 
[0m03:43:03.293056 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m03:43:03.295056 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics'
[0m03:43:03.305536 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics"
[0m03:43:03.308010 [debug] [ThreadPool]: On list_amazonsalesanalytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics"} */
select  name as [schema]
    from sys.schemas 
  
[0m03:43:03.309006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:43:03.310021 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m03:43:05.579384 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m03:43:05.809890 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m03:43:05.812891 [debug] [ThreadPool]: On list_amazonsalesanalytics: Close
[0m03:43:05.815926 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics_dwh'
[0m03:43:05.820652 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics_dwh"
[0m03:43:05.821674 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics_dwh"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
  
[0m03:43:05.822664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:43:05.822664 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m03:43:05.823673 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m03:43:06.052712 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:43:06.057791 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: ROLLBACK
[0m03:43:06.059727 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: Close
[0m03:43:06.064220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e82d2dec-250c-43ff-8e3e-63f0a5421f38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D299E7F290>]}
[0m03:43:06.065237 [debug] [MainThread]: On master: COMMIT
[0m03:43:06.066317 [info ] [MainThread]: Concurrency: 1 threads (target='target')
[0m03:43:06.068230 [info ] [MainThread]: 
[0m03:43:06.078722 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.dim_fulfillment
[0m03:43:06.080713 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh.dim_fulfillment ............................... [RUN]
[0m03:43:06.082713 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.dim_fulfillment'
[0m03:43:06.083729 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.dim_fulfillment
[0m03:43:06.094947 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.dim_fulfillment"
[0m03:43:06.103513 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_fulfillment (compile): 03:43:06.083729 => 03:43:06.102508
[0m03:43:06.105666 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.dim_fulfillment
[0m03:43:06.152912 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m03:43:06.154934 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."dim_fulfillment__dbt_backup";');

[0m03:43:06.155924 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:43:06.156922 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m03:43:06.157923 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m03:43:06.387730 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:43:06.391728 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m03:43:06.392729 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
    and table_name like 'dim_fulfillment'
  
[0m03:43:06.613659 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:43:06.632488 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m03:43:06.634394 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_fulfillment_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m03:43:06.857182 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:43:06.862828 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m03:43:06.863826 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_fulfillment_temp_view";');

  
[0m03:43:07.087912 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:43:07.092864 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m03:43:07.094861 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_fulfillment_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m03:43:07.624944 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m03:43:07.625946 [debug] [Thread-1 (]: Writing runtime sql for node "model.AmazonSalesAnalytics.dim_fulfillment"
[0m03:43:07.632968 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m03:43:07.633950 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */

  
    

   

    USE [amazonsalesanalytics];
    
    

    EXEC('create view "dwh"."dim_fulfillment_temp_view" as 

with dim_fulfillment as (
    select 
        DISTINCT
        Fulfilment as FulfillmentType,
        [ship-service-level] as ShipServiceLevel,
        [fulfilled-by] as FulfilledBy
    from 
        raw.raw_data
)

select row_number() over(order by FulfillmentType, ShipServiceLevel, FulfilledBy) as FulfillmentID ,
        *
    from dim_fulfillment;');



    
      EXEC('SELECT * INTO [amazonsalesanalytics].[dwh].[dim_fulfillment] FROM [amazonsalesanalytics].[dwh].[dim_fulfillment_temp_view];');
    

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_fulfillment_temp_view";');



  
[0m03:43:11.955766 [debug] [Thread-1 (]: SQL status: OK in 4.0 seconds
[0m03:43:11.973480 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: COMMIT
[0m03:43:11.977846 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m03:43:11.978884 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */

      USE [amazonsalesanalytics];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dwh' and tab2.name = 'dim_fulfillment__dbt_backup'
  
[0m03:43:12.203693 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:43:12.206694 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m03:43:12.207694 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."dim_fulfillment__dbt_backup";');

[0m03:43:12.436509 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:43:12.440505 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_fulfillment (execute): 03:43:06.106667 => 03:43:12.440505
[0m03:43:12.441420 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: ROLLBACK
[0m03:43:12.442420 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: Close
[0m03:43:12.443419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e82d2dec-250c-43ff-8e3e-63f0a5421f38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D298E1C790>]}
[0m03:43:12.444498 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dwh.dim_fulfillment .......................... [[32mOK[0m in 6.36s]
[0m03:43:12.446436 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.dim_fulfillment
[0m03:43:12.448431 [debug] [MainThread]: On master: COMMIT
[0m03:43:12.449498 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:43:12.450856 [debug] [MainThread]: Connection 'list_amazonsalesanalytics' was properly closed.
[0m03:43:12.451946 [debug] [MainThread]: Connection 'list_amazonsalesanalytics_dwh' was properly closed.
[0m03:43:12.451946 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.dim_fulfillment' was properly closed.
[0m03:43:12.452945 [info ] [MainThread]: 
[0m03:43:12.454984 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.16 seconds (9.16s).
[0m03:43:12.455949 [debug] [MainThread]: Command end result
[0m03:43:12.470628 [info ] [MainThread]: 
[0m03:43:12.472629 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:43:12.474645 [info ] [MainThread]: 
[0m03:43:12.476633 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:43:12.496787 [debug] [MainThread]: Command `dbt run` succeeded at 03:43:12.495839 after 10.96 seconds
[0m03:43:12.497786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D291DCAA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D291DCAD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D291C357D0>]}
[0m03:43:12.498799 [debug] [MainThread]: Flushing usage events
[0m03:43:12.566435 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m04:02:45.886441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874D78FF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874D224AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874D224750>]}


============================== 04:02:45.900372 | b5e30508-8bb2-4872-947f-069ea968feba ==============================
[0m04:02:45.900372 [info ] [MainThread]: Running with dbt=1.7.16
[0m04:02:45.903175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --target target --models dim_fulfillment', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:02:46.642336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5e30508-8bb2-4872-947f-069ea968feba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874DCE3910>]}
[0m04:02:46.688762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5e30508-8bb2-4872-947f-069ea968feba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874DD15AD0>]}
[0m04:02:46.692762 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m04:02:46.713214 [debug] [MainThread]: checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, vars: {}, profile: , target: target, version: 1.7.16
[0m04:02:47.133552 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:02:47.134052 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:02:47.140069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5e30508-8bb2-4872-947f-069ea968feba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874DCF6590>]}
[0m04:02:47.177350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5e30508-8bb2-4872-947f-069ea968feba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874DE0BCD0>]}
[0m04:02:47.180690 [info ] [MainThread]: Found 3 models, 1 source, 0 exposures, 0 metrics, 448 macros, 0 groups, 0 semantic models
[0m04:02:47.182603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5e30508-8bb2-4872-947f-069ea968feba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874DDF9590>]}
[0m04:02:47.184642 [info ] [MainThread]: 
[0m04:02:47.186781 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m04:02:47.188789 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics'
[0m04:02:47.199501 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics"
[0m04:02:47.201717 [debug] [ThreadPool]: On list_amazonsalesanalytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics"} */
select  name as [schema]
    from sys.schemas 
  
[0m04:02:47.202433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:02:47.204552 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m04:02:49.576247 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m04:02:49.810883 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m04:02:49.814504 [debug] [ThreadPool]: On list_amazonsalesanalytics: Close
[0m04:02:49.818298 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics_dwh'
[0m04:02:49.825539 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics_dwh"
[0m04:02:49.827463 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics_dwh"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
  
[0m04:02:49.828113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:02:49.829196 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m04:02:49.830179 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m04:02:50.062035 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m04:02:50.066067 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: ROLLBACK
[0m04:02:50.067101 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: Close
[0m04:02:50.072147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5e30508-8bb2-4872-947f-069ea968feba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874CFA2510>]}
[0m04:02:50.074121 [debug] [MainThread]: On master: COMMIT
[0m04:02:50.075416 [info ] [MainThread]: Concurrency: 1 threads (target='target')
[0m04:02:50.077633 [info ] [MainThread]: 
[0m04:02:50.091279 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.dim_fulfillment
[0m04:02:50.092838 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh.dim_fulfillment ............................... [RUN]
[0m04:02:50.094849 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.dim_fulfillment'
[0m04:02:50.095849 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.dim_fulfillment
[0m04:02:50.104678 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.dim_fulfillment"
[0m04:02:50.115631 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_fulfillment (compile): 04:02:50.096849 => 04:02:50.113939
[0m04:02:50.117166 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.dim_fulfillment
[0m04:02:50.141376 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m04:02:50.143375 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."dim_fulfillment__dbt_backup";');

[0m04:02:50.144391 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:02:50.145459 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m04:02:51.333411 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m04:02:51.559752 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m04:02:51.570820 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m04:02:51.574133 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
    and table_name like 'dim_fulfillment'
  
[0m04:02:51.802612 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:02:51.813704 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m04:02:51.816004 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */
USE [amazonsalesanalytics];
      EXEC sp_rename 'dwh.dim_fulfillment', 'dim_fulfillment__dbt_backup'
[0m04:02:52.085897 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:02:52.121969 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m04:02:52.125968 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_fulfillment_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m04:02:52.355761 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:02:52.364647 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m04:02:52.366674 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_fulfillment_temp_view";');

  
[0m04:02:52.595520 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:02:52.609821 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m04:02:52.612743 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_fulfillment_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m04:02:52.837137 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:02:52.838120 [debug] [Thread-1 (]: Writing runtime sql for node "model.AmazonSalesAnalytics.dim_fulfillment"
[0m04:02:52.851028 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m04:02:52.853105 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */

  
    

   

    USE [amazonsalesanalytics];
    
    

    EXEC('create view "dwh"."dim_fulfillment_temp_view" as 

with dim_fulfillment as (
    select 
        DISTINCT
        Fulfilment as FulfillmentType,
        [ship-service-level] as ShipServiceLevel,
        [fulfilled-by] as FulfilledBy
    from 
        raw.raw_data
)

select row_number() over(order by FulfillmentType, ShipServiceLevel, FulfilledBy) as FulfillmentID ,
        *
    from dim_fulfillment;');



    
      EXEC('SELECT * INTO [amazonsalesanalytics].[dwh].[dim_fulfillment] FROM [amazonsalesanalytics].[dwh].[dim_fulfillment_temp_view];');
    

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_fulfillment_temp_view";');



  
[0m04:02:56.599099 [debug] [Thread-1 (]: SQL status: OK in 4.0 seconds
[0m04:02:56.622166 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: COMMIT
[0m04:02:56.625165 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m04:02:56.626170 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */

      USE [amazonsalesanalytics];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dwh' and tab2.name = 'dim_fulfillment__dbt_backup'
  
[0m04:02:56.851816 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:02:56.858821 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_fulfillment"
[0m04:02:56.859822 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_fulfillment"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."dim_fulfillment__dbt_backup";');

[0m04:02:57.094833 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:02:57.109138 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_fulfillment (execute): 04:02:50.118667 => 04:02:57.109138
[0m04:02:57.112087 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: ROLLBACK
[0m04:02:57.114720 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_fulfillment: Close
[0m04:02:57.118681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5e30508-8bb2-4872-947f-069ea968feba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874DFC6050>]}
[0m04:02:57.121611 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dwh.dim_fulfillment .......................... [[32mOK[0m in 7.02s]
[0m04:02:57.124702 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.dim_fulfillment
[0m04:02:57.127608 [debug] [MainThread]: On master: COMMIT
[0m04:02:57.130761 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:02:57.131941 [debug] [MainThread]: Connection 'list_amazonsalesanalytics' was properly closed.
[0m04:02:57.133001 [debug] [MainThread]: Connection 'list_amazonsalesanalytics_dwh' was properly closed.
[0m04:02:57.134077 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.dim_fulfillment' was properly closed.
[0m04:02:57.135056 [info ] [MainThread]: 
[0m04:02:57.136461 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.95 seconds (9.95s).
[0m04:02:57.139592 [debug] [MainThread]: Command end result
[0m04:02:57.157864 [info ] [MainThread]: 
[0m04:02:57.159488 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:02:57.161953 [info ] [MainThread]: 
[0m04:02:57.163965 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:02:57.184121 [debug] [MainThread]: Command `dbt run` succeeded at 04:02:57.183136 after 12.02 seconds
[0m04:02:57.185045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874D36DCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018746D0B990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018746D1AA90>]}
[0m04:02:57.187144 [debug] [MainThread]: Flushing usage events
[0m04:02:58.062166 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m04:17:24.663003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297EDC8B290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297EDCA1950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297EDCA33D0>]}


============================== 04:17:24.674084 | a73cd498-6d76-45cd-9b1c-79e56a43af94 ==============================
[0m04:17:24.674084 [info ] [MainThread]: Running with dbt=1.7.16
[0m04:17:24.676156 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --target target --models fact_sales', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:17:25.292360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a73cd498-6d76-45cd-9b1c-79e56a43af94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297EDCA7F90>]}
[0m04:17:25.334259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a73cd498-6d76-45cd-9b1c-79e56a43af94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297EDCBF1D0>]}
[0m04:17:25.336258 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m04:17:25.354775 [debug] [MainThread]: checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, vars: {}, profile: , target: target, version: 1.7.16
[0m04:17:25.680567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m04:17:25.681565 [debug] [MainThread]: Partial parsing: added file: AmazonSalesAnalytics://models\source\fact_sales.sql
[0m04:17:25.785208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a73cd498-6d76-45cd-9b1c-79e56a43af94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297EF4F2B90>]}
[0m04:17:25.811077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a73cd498-6d76-45cd-9b1c-79e56a43af94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297EF549C50>]}
[0m04:17:25.814065 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 448 macros, 0 groups, 0 semantic models
[0m04:17:25.816705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a73cd498-6d76-45cd-9b1c-79e56a43af94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297EE3DED50>]}
[0m04:17:25.818940 [info ] [MainThread]: 
[0m04:17:25.820938 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m04:17:25.822941 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics'
[0m04:17:25.834476 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics"
[0m04:17:25.835480 [debug] [ThreadPool]: On list_amazonsalesanalytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics"} */
select  name as [schema]
    from sys.schemas 
  
[0m04:17:25.836473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:17:25.838473 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m04:17:28.193143 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m04:17:28.426614 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m04:17:28.429264 [debug] [ThreadPool]: On list_amazonsalesanalytics: Close
[0m04:17:28.433026 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics_dwh'
[0m04:17:28.438126 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics_dwh"
[0m04:17:28.439041 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics_dwh"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
  
[0m04:17:28.440035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:17:28.441037 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m04:17:28.442134 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m04:17:28.675419 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m04:17:28.677658 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: ROLLBACK
[0m04:17:28.678660 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: Close
[0m04:17:28.683382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a73cd498-6d76-45cd-9b1c-79e56a43af94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297EF4739D0>]}
[0m04:17:28.684382 [debug] [MainThread]: On master: COMMIT
[0m04:17:28.685475 [info ] [MainThread]: Concurrency: 1 threads (target='target')
[0m04:17:28.687421 [info ] [MainThread]: 
[0m04:17:28.731677 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.fact_sales
[0m04:17:28.732856 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh.fact_sales .................................... [RUN]
[0m04:17:28.736039 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.fact_sales'
[0m04:17:28.737343 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.fact_sales
[0m04:17:28.743956 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.fact_sales"
[0m04:17:28.754704 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.fact_sales (compile): 04:17:28.738952 => 04:17:28.753697
[0m04:17:28.755720 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.fact_sales
[0m04:17:28.779224 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.fact_sales"
[0m04:17:28.780228 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.fact_sales"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."fact_sales__dbt_backup";');

[0m04:17:28.781110 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:17:28.783141 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m04:17:28.784189 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m04:17:29.015732 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:17:29.018944 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.fact_sales"
[0m04:17:29.020944 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.fact_sales"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
    and table_name like 'fact_sales'
  
[0m04:17:29.261971 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:17:29.279205 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.fact_sales"
[0m04:17:29.280911 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.fact_sales"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'fact_sales_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m04:17:29.676430 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:17:29.679473 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.fact_sales"
[0m04:17:29.681618 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.fact_sales"} */

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."fact_sales_temp_view";');

  
[0m04:17:29.913945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:17:29.918999 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.fact_sales"
[0m04:17:29.921018 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.fact_sales"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'fact_sales_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m04:17:30.153810 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:17:30.156910 [debug] [Thread-1 (]: Writing runtime sql for node "model.AmazonSalesAnalytics.fact_sales"
[0m04:17:30.164522 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.fact_sales"
[0m04:17:30.165559 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.fact_sales"} */

  
    

   

    USE [amazonsalesanalytics];
    
    

    EXEC('create view "dwh"."fact_sales_temp_view" as 

with fact_sales as (
    SELECT
        [order id] as OrderID ,
        [Sales Channel] as SalesChannel ,
        [Currency] as Currency ,
        [b2b] as B2B ,
        [Status] as [AmazonStatus],
        [Courier Status] as [CourierStatus],
        l.LocationID as [LocationID],
        f.FulfillmentID as [FulfillmentID],
        d.DateID as [DateID]
    FROM
        raw.raw_data r
    left join dwh.dim_locations l ON r.[Ship-City] = l.ShipCity 
        AND r.[Ship-State] = l.ShipState 
        AND r.[Ship-Country] = l.ShipCountry 
        AND r.[Ship-Postal-Code] = l.ShipPostalCode
    left join dwh.dim_fulfillment f on r.Fulfilment = f.FulfillmentType
        AND r.[ship-service-level] = f.ShipServiceLevel
        --AND r.[fulfilled-by] = f.FulfilledBy
    left join dwh.dim_date d on cast(r.[Date]  as Date) = d.[Date]
    --where Qty!=0 and Currency is not null
    group by 
        [order id],
        [Sales Channel],
        [Currency],
        [b2b],
        [Status],
        [Courier Status],
        l.LocationID,
        f.FulfillmentID,
        d.DateID
)   
select row_number() over(order by [OrderID]) as Order_Sk,
        *
    from 
        fact_sales;');



    
      EXEC('SELECT * INTO [amazonsalesanalytics].[dwh].[fact_sales] FROM [amazonsalesanalytics].[dwh].[fact_sales_temp_view];');
    

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."fact_sales_temp_view";');



  
[0m04:18:56.971188 [debug] [Thread-1 (]: SQL status: OK in 87.0 seconds
[0m04:18:56.997274 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_sales: COMMIT
[0m04:18:57.004270 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.fact_sales"
[0m04:18:57.006276 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.fact_sales"} */

      USE [amazonsalesanalytics];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dwh' and tab2.name = 'fact_sales__dbt_backup'
  
[0m04:18:57.606347 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m04:18:57.617332 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.fact_sales"
[0m04:18:57.620321 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.fact_sales"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."fact_sales__dbt_backup";');

[0m04:18:57.865332 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:18:57.875693 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.fact_sales (execute): 04:17:28.756720 => 04:18:57.875693
[0m04:18:57.877714 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_sales: ROLLBACK
[0m04:18:57.879792 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_sales: Close
[0m04:18:57.881520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a73cd498-6d76-45cd-9b1c-79e56a43af94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297EF52EE10>]}
[0m04:18:57.883764 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dwh.fact_sales ............................... [[32mOK[0m in 89.15s]
[0m04:18:57.885663 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.fact_sales
[0m04:18:57.887649 [debug] [MainThread]: On master: COMMIT
[0m04:18:57.889743 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:18:57.890692 [debug] [MainThread]: Connection 'list_amazonsalesanalytics' was properly closed.
[0m04:18:57.891887 [debug] [MainThread]: Connection 'list_amazonsalesanalytics_dwh' was properly closed.
[0m04:18:57.892877 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.fact_sales' was properly closed.
[0m04:18:57.893902 [info ] [MainThread]: 
[0m04:18:57.895933 [info ] [MainThread]: Finished running 1 table model in 0 hours 1 minutes and 32.07 seconds (92.07s).
[0m04:18:57.898585 [debug] [MainThread]: Command end result
[0m04:18:57.932517 [info ] [MainThread]: 
[0m04:18:57.934519 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:18:57.935518 [info ] [MainThread]: 
[0m04:18:57.937519 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:18:57.961139 [debug] [MainThread]: Command `dbt run` succeeded at 04:18:57.960618 after 93.86 seconds
[0m04:18:57.962137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297ED6897D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297E719AD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297EF52AA50>]}
[0m04:18:57.963155 [debug] [MainThread]: Flushing usage events
[0m04:18:58.837955 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m04:21:35.944357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029193A7A110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029192E909D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029193A7A690>]}


============================== 04:21:35.954282 | 7f2b84f3-0846-4dab-92b8-cb6f0f816f62 ==============================
[0m04:21:35.954282 [info ] [MainThread]: Running with dbt=1.7.16
[0m04:21:35.956305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --target target --models fact_sales', 'send_anonymous_usage_stats': 'True'}
[0m04:21:36.552271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f2b84f3-0846-4dab-92b8-cb6f0f816f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029193A92450>]}
[0m04:21:36.597764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f2b84f3-0846-4dab-92b8-cb6f0f816f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291936AD950>]}
[0m04:21:36.598658 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m04:21:36.614158 [debug] [MainThread]: checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, vars: {}, profile: , target: target, version: 1.7.16
[0m04:21:36.948634 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:21:36.949635 [debug] [MainThread]: Partial parsing: updated file: AmazonSalesAnalytics://models\source\fact_sales.sql
[0m04:21:37.055009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f2b84f3-0846-4dab-92b8-cb6f0f816f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002919417DB50>]}
[0m04:21:37.082864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f2b84f3-0846-4dab-92b8-cb6f0f816f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291953346D0>]}
[0m04:21:37.085766 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 448 macros, 0 groups, 0 semantic models
[0m04:21:37.086768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f2b84f3-0846-4dab-92b8-cb6f0f816f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291941B3C50>]}
[0m04:21:37.089986 [info ] [MainThread]: 
[0m04:21:37.092001 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m04:21:37.094586 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics'
[0m04:21:37.109167 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics"
[0m04:21:37.119536 [debug] [ThreadPool]: On list_amazonsalesanalytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics"} */
select  name as [schema]
    from sys.schemas 
  
[0m04:21:37.120757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:21:37.121755 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m04:21:40.019800 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m04:21:40.318515 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m04:21:40.320515 [debug] [ThreadPool]: On list_amazonsalesanalytics: Close
[0m04:21:40.323722 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics_dwh'
[0m04:21:40.329554 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics_dwh"
[0m04:21:40.330553 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics_dwh"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
  
[0m04:21:40.331553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:21:40.332554 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m04:21:40.332554 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m04:21:40.633946 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m04:21:40.636014 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: ROLLBACK
[0m04:21:40.636975 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: Close
[0m04:21:40.639392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f2b84f3-0846-4dab-92b8-cb6f0f816f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002919416D250>]}
[0m04:21:40.640394 [debug] [MainThread]: On master: COMMIT
[0m04:21:40.641393 [info ] [MainThread]: Concurrency: 1 threads (target='target')
[0m04:21:40.643180 [info ] [MainThread]: 
[0m04:21:40.654269 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.fact_sales
[0m04:21:40.656237 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh.fact_sales .................................... [RUN]
[0m04:21:40.657230 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.fact_sales'
[0m04:21:40.658232 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.fact_sales
[0m04:21:40.666819 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.fact_sales"
[0m04:21:40.674824 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.fact_sales (compile): 04:21:40.659864 => 04:21:40.674824
[0m04:21:40.677202 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.fact_sales
[0m04:21:40.703135 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.fact_sales"
[0m04:21:40.705056 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.fact_sales"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."fact_sales__dbt_backup";');

[0m04:21:40.706057 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:21:40.707066 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m04:21:40.708060 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m04:21:41.004568 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:21:41.007754 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.fact_sales"
[0m04:21:41.009409 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.fact_sales"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
    and table_name like 'fact_sales'
  
[0m04:21:41.301193 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:21:41.310221 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.fact_sales"
[0m04:21:41.311263 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.fact_sales"} */
USE [amazonsalesanalytics];
      EXEC sp_rename 'dwh.fact_sales', 'fact_sales__dbt_backup'
[0m04:21:41.628730 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:21:41.643731 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.fact_sales"
[0m04:21:41.644733 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.fact_sales"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'fact_sales_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m04:21:41.941672 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:21:41.945786 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.fact_sales"
[0m04:21:41.946834 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.fact_sales"} */

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."fact_sales_temp_view";');

  
[0m04:21:42.254925 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:21:42.260050 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.fact_sales"
[0m04:21:42.262389 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.fact_sales"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'fact_sales_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m04:21:42.568967 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:21:42.570337 [debug] [Thread-1 (]: Writing runtime sql for node "model.AmazonSalesAnalytics.fact_sales"
[0m04:21:42.580851 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.fact_sales"
[0m04:21:42.582343 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.fact_sales"} */

  
    

   

    USE [amazonsalesanalytics];
    
    

    EXEC('create view "dwh"."fact_sales_temp_view" as 

with fact_sales as (
    SELECT
        [order id] as OrderID ,
        [Sales Channel] as SalesChannel ,
        [Currency] as Currency ,
        [b2b] as B2B ,
        [Status] as [AmazonStatus],
        [Courier Status] as [CourierStatus],
        Sum([Amount]) as [TotalAmount],
        Sum([Qty]) as ItemsQuantity,
        l.LocationID as [LocationID],
        f.FulfillmentID as [FulfillmentID],
        d.DateID as [DateID]
    FROM
        raw.raw_data r
    left join dwh.dim_locations l ON r.[Ship-City] = l.ShipCity 
        AND r.[Ship-State] = l.ShipState 
        AND r.[Ship-Country] = l.ShipCountry 
        AND r.[Ship-Postal-Code] = l.ShipPostalCode
    left join dwh.dim_fulfillment f on r.Fulfilment = f.FulfillmentType
        AND r.[ship-service-level] = f.ShipServiceLevel
        --AND r.[fulfilled-by] = f.FulfilledBy
    left join dwh.dim_date d on cast(r.[Date]  as Date) = d.[Date]
    --where Qty!=0 and Currency is not null
    group by 
        [order id],
        [Sales Channel],
        [Currency],
        [b2b],
        [Status],
        [Courier Status],
        l.LocationID,
        f.FulfillmentID,
        d.DateID
)   
select row_number() over(order by [OrderID]) as Order_Sk,
        *
    from 
        fact_sales;');



    
      EXEC('SELECT * INTO [amazonsalesanalytics].[dwh].[fact_sales] FROM [amazonsalesanalytics].[dwh].[fact_sales_temp_view];');
    

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."fact_sales_temp_view";');



  
[0m04:23:25.770350 [debug] [Thread-1 (]: SQL status: OK in 103.0 seconds
[0m04:23:25.793420 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_sales: COMMIT
[0m04:23:25.801062 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.fact_sales"
[0m04:23:25.802062 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.fact_sales"} */

      USE [amazonsalesanalytics];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dwh' and tab2.name = 'fact_sales__dbt_backup'
  
[0m04:23:26.032699 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:23:26.043187 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.fact_sales"
[0m04:23:26.046141 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.fact_sales"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."fact_sales__dbt_backup";');

[0m04:23:26.291726 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:23:26.296634 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.fact_sales (execute): 04:21:40.677864 => 04:23:26.295634
[0m04:23:26.297720 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_sales: ROLLBACK
[0m04:23:26.297819 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_sales: Close
[0m04:23:26.299898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f2b84f3-0846-4dab-92b8-cb6f0f816f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002919420FBD0>]}
[0m04:23:26.300899 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dwh.fact_sales ............................... [[32mOK[0m in 105.64s]
[0m04:23:26.302896 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.fact_sales
[0m04:23:26.304896 [debug] [MainThread]: On master: COMMIT
[0m04:23:26.305896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:23:26.307209 [debug] [MainThread]: Connection 'list_amazonsalesanalytics' was properly closed.
[0m04:23:26.308294 [debug] [MainThread]: Connection 'list_amazonsalesanalytics_dwh' was properly closed.
[0m04:23:26.310410 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.fact_sales' was properly closed.
[0m04:23:26.312531 [info ] [MainThread]: 
[0m04:23:26.314136 [info ] [MainThread]: Finished running 1 table model in 0 hours 1 minutes and 49.22 seconds (109.22s).
[0m04:23:26.316337 [debug] [MainThread]: Command end result
[0m04:23:26.354463 [info ] [MainThread]: 
[0m04:23:26.356411 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:23:26.358484 [info ] [MainThread]: 
[0m04:23:26.359583 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:23:26.382319 [debug] [MainThread]: Command `dbt run` succeeded at 04:23:26.381319 after 111.06 seconds
[0m04:23:26.383321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002918D05AA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002918D05AD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291936CE3D0>]}
[0m04:23:26.384314 [debug] [MainThread]: Flushing usage events
[0m04:23:27.303916 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m04:33:29.521193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A220D2FF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2207C4AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2207C4850>]}


============================== 04:33:29.531335 | 40622131-f89d-4c32-b6f0-51e3bd107d54 ==============================
[0m04:33:29.531335 [info ] [MainThread]: Running with dbt=1.7.16
[0m04:33:29.533574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --target target --models dim_product', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:33:30.146063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40622131-f89d-4c32-b6f0-51e3bd107d54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2207C4A90>]}
[0m04:33:30.187078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40622131-f89d-4c32-b6f0-51e3bd107d54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A220D56010>]}
[0m04:33:30.189083 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m04:33:30.204225 [debug] [MainThread]: checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, vars: {}, profile: , target: target, version: 1.7.16
[0m04:33:30.525564 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m04:33:30.525564 [debug] [MainThread]: Partial parsing: added file: AmazonSalesAnalytics://models\source\dim_date.sql
[0m04:33:30.629664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40622131-f89d-4c32-b6f0-51e3bd107d54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2224FBF10>]}
[0m04:33:30.655923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40622131-f89d-4c32-b6f0-51e3bd107d54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A222591AD0>]}
[0m04:33:30.659002 [info ] [MainThread]: Found 5 models, 1 source, 0 exposures, 0 metrics, 448 macros, 0 groups, 0 semantic models
[0m04:33:30.660897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40622131-f89d-4c32-b6f0-51e3bd107d54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A221382D90>]}
[0m04:33:30.662973 [info ] [MainThread]: 
[0m04:33:30.665927 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m04:33:30.668024 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics'
[0m04:33:30.681381 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics"
[0m04:33:30.683380 [debug] [ThreadPool]: On list_amazonsalesanalytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics"} */
select  name as [schema]
    from sys.schemas 
  
[0m04:33:30.685385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:33:30.686383 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m04:33:32.935536 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m04:33:33.159125 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m04:33:33.162006 [debug] [ThreadPool]: On list_amazonsalesanalytics: Close
[0m04:33:33.165007 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics_dwh'
[0m04:33:33.171164 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics_dwh"
[0m04:33:33.172164 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics_dwh"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
  
[0m04:33:33.173163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:33:33.174165 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m04:33:33.176266 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m04:33:33.401366 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m04:33:33.403366 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: ROLLBACK
[0m04:33:33.403366 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: Close
[0m04:33:33.406455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40622131-f89d-4c32-b6f0-51e3bd107d54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A22251F950>]}
[0m04:33:33.407407 [debug] [MainThread]: On master: COMMIT
[0m04:33:33.408369 [info ] [MainThread]: Concurrency: 1 threads (target='target')
[0m04:33:33.410842 [info ] [MainThread]: 
[0m04:33:33.421422 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.dim_product
[0m04:33:33.423410 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh.dim_product ................................... [RUN]
[0m04:33:33.425405 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.dim_product'
[0m04:33:33.426404 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.dim_product
[0m04:33:33.434428 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.dim_product"
[0m04:33:33.441345 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (compile): 04:33:33.427320 => 04:33:33.441345
[0m04:33:33.442339 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.dim_product
[0m04:33:33.466887 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m04:33:33.467878 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."dim_product__dbt_backup";');

[0m04:33:33.468894 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:33:33.469805 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m04:33:33.470868 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m04:33:33.693656 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:33:33.697233 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m04:33:33.698242 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
    and table_name like 'dim_product'
  
[0m04:33:33.922153 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:33:33.927056 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m04:33:33.928140 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */
USE [amazonsalesanalytics];
      EXEC sp_rename 'dwh.dim_product', 'dim_product__dbt_backup'
[0m04:33:34.186263 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:33:34.203854 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m04:33:34.204779 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m04:33:34.429496 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:33:34.433587 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m04:33:34.434590 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_product_temp_view";');

  
[0m04:33:34.657834 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:33:34.662554 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m04:33:34.664558 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'dim_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m04:33:34.887414 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:33:34.889409 [debug] [Thread-1 (]: Writing runtime sql for node "model.AmazonSalesAnalytics.dim_product"
[0m04:33:34.897734 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m04:33:34.898806 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

  
    

   

    USE [amazonsalesanalytics];
    
    

    EXEC('create view "dwh"."dim_product_temp_view" as 

with cte_product as 
        (
        SELECT
            distinct 
            SKU,
            Style,
            Category,
            SIZE,
            ASIN
        from RAW.raw_data
    )

--INSERT into dwh.dim_product
select row_number() over(order by SKU, Style, Category, SIZE, ASIN) as ProductID,
        *
     from cte_product;');



    
      EXEC('SELECT * INTO [amazonsalesanalytics].[dwh].[dim_product] FROM [amazonsalesanalytics].[dwh].[dim_product_temp_view];');
    

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."dim_product_temp_view";');



  
[0m04:33:51.728399 [debug] [Thread-1 (]: SQL status: OK in 17.0 seconds
[0m04:33:51.745234 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: COMMIT
[0m04:33:51.750770 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m04:33:51.751777 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      USE [amazonsalesanalytics];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dwh' and tab2.name = 'dim_product__dbt_backup'
  
[0m04:33:51.976046 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:33:51.985959 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.dim_product"
[0m04:33:51.986866 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.dim_product"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."dim_product__dbt_backup";');

[0m04:33:52.217976 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:33:52.225136 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.dim_product (execute): 04:33:33.443338 => 04:33:52.225136
[0m04:33:52.226325 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: ROLLBACK
[0m04:33:52.227828 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.dim_product: Close
[0m04:33:52.228794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40622131-f89d-4c32-b6f0-51e3bd107d54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2225AE750>]}
[0m04:33:52.230841 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dwh.dim_product .............................. [[32mOK[0m in 18.80s]
[0m04:33:52.231794 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.dim_product
[0m04:33:52.234795 [debug] [MainThread]: On master: COMMIT
[0m04:33:52.234795 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:33:52.235797 [debug] [MainThread]: Connection 'list_amazonsalesanalytics' was properly closed.
[0m04:33:52.236806 [debug] [MainThread]: Connection 'list_amazonsalesanalytics_dwh' was properly closed.
[0m04:33:52.237869 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.dim_product' was properly closed.
[0m04:33:52.238801 [info ] [MainThread]: 
[0m04:33:52.240799 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 21.57 seconds (21.57s).
[0m04:33:52.242896 [debug] [MainThread]: Command end result
[0m04:33:52.258446 [info ] [MainThread]: 
[0m04:33:52.260904 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:33:52.262647 [info ] [MainThread]: 
[0m04:33:52.264645 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:33:52.283758 [debug] [MainThread]: Command `dbt run` succeeded at 04:33:52.283758 after 23.40 seconds
[0m04:33:52.284748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A220117710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2208A9FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A21A21B990>]}
[0m04:33:52.285654 [debug] [MainThread]: Flushing usage events
[0m04:33:53.194143 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m04:40:54.992293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F30DBFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F30DA050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F30DA450>]}


============================== 04:40:55.002493 | ab86855e-c1cf-489e-87a0-b8f33242dd77 ==============================
[0m04:40:55.002493 [info ] [MainThread]: Running with dbt=1.7.16
[0m04:40:55.004301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\GB617GQ\\.dbt', 'log_path': 'C:\\Drive\\AmazonSalesAnalytics\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --target target --models fact_orderitems', 'send_anonymous_usage_stats': 'True'}
[0m04:40:55.614160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab86855e-c1cf-489e-87a0-b8f33242dd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F30DDCD0>]}
[0m04:40:55.655849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab86855e-c1cf-489e-87a0-b8f33242dd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F36BFBD0>]}
[0m04:40:55.656823 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m04:40:55.674692 [debug] [MainThread]: checksum: da13ab155fe042796b997405a5343aed931133dd56b225803aec5760fb7d0f11, vars: {}, profile: , target: target, version: 1.7.16
[0m04:40:56.079738 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m04:40:56.080739 [debug] [MainThread]: Partial parsing: added file: AmazonSalesAnalytics://models\source\fact_orderitems.sql
[0m04:40:56.186850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab86855e-c1cf-489e-87a0-b8f33242dd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F3130550>]}
[0m04:40:56.214112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab86855e-c1cf-489e-87a0-b8f33242dd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F37E8050>]}
[0m04:40:56.216201 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 448 macros, 0 groups, 0 semantic models
[0m04:40:56.217214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab86855e-c1cf-489e-87a0-b8f33242dd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205EF536810>]}
[0m04:40:56.219566 [info ] [MainThread]: 
[0m04:40:56.221650 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m04:40:56.222956 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics'
[0m04:40:56.235867 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics"
[0m04:40:56.237029 [debug] [ThreadPool]: On list_amazonsalesanalytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics"} */
select  name as [schema]
    from sys.schemas 
  
[0m04:40:56.238029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:40:56.239026 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m04:40:58.583155 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m04:40:58.812449 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m04:40:58.815448 [debug] [ThreadPool]: On list_amazonsalesanalytics: Close
[0m04:40:58.818487 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_amazonsalesanalytics_dwh'
[0m04:40:58.823827 [debug] [ThreadPool]: Using sqlserver connection "list_amazonsalesanalytics_dwh"
[0m04:40:58.824818 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "connection_name": "list_amazonsalesanalytics_dwh"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
  
[0m04:40:58.825818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:40:58.826754 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m04:40:58.827739 [debug] [ThreadPool]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m04:40:59.065587 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m04:40:59.067588 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: ROLLBACK
[0m04:40:59.069536 [debug] [ThreadPool]: On list_amazonsalesanalytics_dwh: Close
[0m04:40:59.072564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab86855e-c1cf-489e-87a0-b8f33242dd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F36DB550>]}
[0m04:40:59.073570 [debug] [MainThread]: On master: COMMIT
[0m04:40:59.074565 [info ] [MainThread]: Concurrency: 1 threads (target='target')
[0m04:40:59.076609 [info ] [MainThread]: 
[0m04:40:59.086993 [debug] [Thread-1 (]: Began running node model.AmazonSalesAnalytics.fact_orderitems
[0m04:40:59.087990 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh.fact_orderitems ............................... [RUN]
[0m04:40:59.089992 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.AmazonSalesAnalytics.fact_orderitems'
[0m04:40:59.090991 [debug] [Thread-1 (]: Began compiling node model.AmazonSalesAnalytics.fact_orderitems
[0m04:40:59.098076 [debug] [Thread-1 (]: Writing injected SQL for node "model.AmazonSalesAnalytics.fact_orderitems"
[0m04:40:59.108232 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.fact_orderitems (compile): 04:40:59.091991 => 04:40:59.107230
[0m04:40:59.108232 [debug] [Thread-1 (]: Began executing node model.AmazonSalesAnalytics.fact_orderitems
[0m04:40:59.130643 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.fact_orderitems"
[0m04:40:59.131806 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_orderitems: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.fact_orderitems"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."fact_orderitems__dbt_backup";');

[0m04:40:59.132843 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:40:59.133840 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=analytics-warehouse.database.windows.net,1433;Database=amazonsalesanalytics;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m04:40:59.135332 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: amazonsalesanalytics
[0m04:40:59.370404 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:40:59.373401 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.fact_orderitems"
[0m04:40:59.375403 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_orderitems: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.fact_orderitems"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dwh'
    and table_name like 'fact_orderitems'
  
[0m04:40:59.622252 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:40:59.640948 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.fact_orderitems"
[0m04:40:59.642943 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_orderitems: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.fact_orderitems"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'fact_orderitems_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m04:40:59.887564 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:40:59.891563 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.fact_orderitems"
[0m04:40:59.892581 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_orderitems: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.fact_orderitems"} */

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."fact_orderitems_temp_view";');

  
[0m04:41:00.127872 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:41:00.133223 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.fact_orderitems"
[0m04:41:00.135142 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_orderitems: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.fact_orderitems"} */

      USE [amazonsalesanalytics];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'amazonsalesanalytics'
      and refs.referenced_schema_name = 'dwh'
      and refs.referenced_entity_name = 'fact_orderitems_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m04:41:00.371110 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:41:00.373193 [debug] [Thread-1 (]: Writing runtime sql for node "model.AmazonSalesAnalytics.fact_orderitems"
[0m04:41:00.379427 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.fact_orderitems"
[0m04:41:00.381426 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_orderitems: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.fact_orderitems"} */

  
    

   

    USE [amazonsalesanalytics];
    
    

    EXEC('create view "dwh"."fact_orderitems_temp_view" as 

WITH raw_data AS (
    SELECT
        [Order ID],
        SKU,
        Qty,
        Amount
    FROM raw.raw_data
),

product_dim AS (
    SELECT
        ProductID,
        SKU
    FROM dwh.dim_product
)

SELECT
    ROW_NUMBER() OVER (ORDER BY r.[Order ID], p.ProductID) AS OrderItemID,
    r.[Order ID] as OrderID,
    p.ProductID,
    r.Qty,
    r.Amount
FROM raw_data r
LEFT JOIN product_dim p ON r.SKU = p.SKU;;');



    
      EXEC('SELECT * INTO [amazonsalesanalytics].[dwh].[fact_orderitems] FROM [amazonsalesanalytics].[dwh].[fact_orderitems_temp_view];');
    

    
      
      
    
    USE [amazonsalesanalytics];
    EXEC('DROP view IF EXISTS "dwh"."fact_orderitems_temp_view";');



  
[0m04:41:37.527277 [debug] [Thread-1 (]: SQL status: OK in 37.0 seconds
[0m04:41:37.544670 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_orderitems: COMMIT
[0m04:41:37.548656 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.fact_orderitems"
[0m04:41:37.548656 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_orderitems: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.fact_orderitems"} */

      USE [amazonsalesanalytics];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dwh' and tab2.name = 'fact_orderitems__dbt_backup'
  
[0m04:41:38.970706 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m04:41:38.974219 [debug] [Thread-1 (]: Using sqlserver connection "model.AmazonSalesAnalytics.fact_orderitems"
[0m04:41:38.975220 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_orderitems: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "AmazonSalesAnalytics", "target_name": "target", "node_id": "model.AmazonSalesAnalytics.fact_orderitems"} */

      
      
    USE [amazonsalesanalytics];
    EXEC('DROP table IF EXISTS "dwh"."fact_orderitems__dbt_backup";');

[0m04:41:39.209647 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:41:39.213744 [debug] [Thread-1 (]: Timing info for model.AmazonSalesAnalytics.fact_orderitems (execute): 04:40:59.109333 => 04:41:39.213744
[0m04:41:39.214744 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_orderitems: ROLLBACK
[0m04:41:39.215744 [debug] [Thread-1 (]: On model.AmazonSalesAnalytics.fact_orderitems: Close
[0m04:41:39.217998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab86855e-c1cf-489e-87a0-b8f33242dd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F49A8090>]}
[0m04:41:39.220081 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dwh.fact_orderitems .......................... [[32mOK[0m in 40.13s]
[0m04:41:39.221592 [debug] [Thread-1 (]: Finished running node model.AmazonSalesAnalytics.fact_orderitems
[0m04:41:39.223900 [debug] [MainThread]: On master: COMMIT
[0m04:41:39.226110 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:41:39.227111 [debug] [MainThread]: Connection 'list_amazonsalesanalytics' was properly closed.
[0m04:41:39.228191 [debug] [MainThread]: Connection 'list_amazonsalesanalytics_dwh' was properly closed.
[0m04:41:39.229109 [debug] [MainThread]: Connection 'model.AmazonSalesAnalytics.fact_orderitems' was properly closed.
[0m04:41:39.229109 [info ] [MainThread]: 
[0m04:41:39.231132 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 43.01 seconds (43.01s).
[0m04:41:39.233342 [debug] [MainThread]: Command end result
[0m04:41:39.267186 [info ] [MainThread]: 
[0m04:41:39.268186 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:41:39.270968 [info ] [MainThread]: 
[0m04:41:39.273107 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:41:39.296823 [debug] [MainThread]: Command `dbt run` succeeded at 04:41:39.296823 after 44.97 seconds
[0m04:41:39.297826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F2527490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F2E0C3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205EC66AA90>]}
[0m04:41:39.298822 [debug] [MainThread]: Flushing usage events
[0m04:41:40.205966 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
